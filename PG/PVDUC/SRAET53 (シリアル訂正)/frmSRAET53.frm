VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Object = "{0D181820-63E5-11D1-8959-E995CE93D831}#2.3#0"; "Threed5.ocx"
Begin VB.Form FR_SSSMAIN 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "ÉVÉäÉAÉãáÇìoò^"
   ClientHeight    =   5880
   ClientLeft      =   150
   ClientTop       =   840
   ClientWidth     =   5625
   Icon            =   "frmSRAET53.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5880
   ScaleWidth      =   5625
   StartUpPosition =   3  'Windows ÇÃä˘íËíl
   Begin VB.TextBox txtDummy 
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   0  'Ç»Çµ
      Height          =   270
      Left            =   4800
      TabIndex        =   15
      Top             =   4800
      Width           =   15
   End
   Begin VB.Frame Frame1 
      Height          =   735
      Left            =   240
      TabIndex        =   9
      Top             =   6000
      Width           =   4095
      Begin VB.Image IM_Denkyu 
         Height          =   330
         Index           =   2
         Left            =   2400
         Picture         =   "frmSRAET53.frx":030A
         Top             =   240
         Width           =   300
      End
      Begin VB.Image IM_Denkyu 
         Height          =   330
         Index           =   1
         Left            =   1920
         Picture         =   "frmSRAET53.frx":0494
         Top             =   240
         Width           =   300
      End
      Begin VB.Image IM_Execute 
         Height          =   330
         Index           =   2
         Left            =   1440
         Picture         =   "frmSRAET53.frx":061E
         Top             =   240
         Width           =   360
      End
      Begin VB.Image IM_Execute 
         Height          =   330
         Index           =   1
         Left            =   1080
         Picture         =   "frmSRAET53.frx":0C70
         Top             =   240
         Width           =   360
      End
      Begin VB.Image IM_EndCm 
         Height          =   330
         Index           =   2
         Left            =   600
         Picture         =   "frmSRAET53.frx":12C2
         Top             =   240
         Width           =   360
      End
      Begin VB.Image IM_EndCm 
         Height          =   330
         Index           =   1
         Left            =   240
         Picture         =   "frmSRAET53.frx":144C
         Top             =   240
         Width           =   360
      End
   End
   Begin Threed5.SSPanel5 SSPanel52 
      Height          =   330
      Left            =   720
      TabIndex        =   8
      Top             =   1485
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "êî ó "
      OutLine         =   -1  'True
   End
   Begin Threed5.SSPanel5 SSPanel51 
      Height          =   645
      Left            =   720
      TabIndex        =   7
      Top             =   750
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   1138
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "êª ïi"
      OutLine         =   -1  'True
   End
   Begin FPSpread.vaSpread vaData 
      Height          =   3150
      Left            =   720
      TabIndex        =   0
      Top             =   1920
      Width           =   3225
      _Version        =   196608
      _ExtentX        =   5689
      _ExtentY        =   5556
      _StockProps     =   64
      AllowMultiBlocks=   -1  'True
      ArrowsExitEditMode=   -1  'True
      BackColorStyle  =   1
      DisplayRowHeaders=   0   'False
      EditEnterAction =   5
      EditModeReplace =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MaxCols         =   7
      MaxRows         =   10
      Position        =   3
      ProcessTab      =   -1  'True
      Protect         =   0   'False
      ScrollBars      =   2
      SpreadDesigner  =   "frmSRAET53.frx":15D6
      UserResize      =   0
      VisibleCols     =   3
      VisibleRows     =   1
   End
   Begin Threed5.SSPanel5 FM_Panel3D15 
      Height          =   645
      Index           =   0
      Left            =   0
      TabIndex        =   10
      Top             =   5280
      Width           =   5655
      _ExtentX        =   9975
      _ExtentY        =   1138
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
      Begin Threed5.SSPanel5 FM_Panel3D2 
         Height          =   375
         Index           =   2
         Left            =   585
         TabIndex        =   11
         Top             =   135
         Width           =   4950
         _ExtentX        =   8731
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Begin VB.TextBox TX_Message 
            Appearance      =   0  'Ã◊Øƒ
            BackColor       =   &H8000000F&
            BorderStyle     =   0  'Ç»Çµ
            ForeColor       =   &H00000000&
            Height          =   285
            Left            =   120
            MultiLine       =   -1  'True
            TabIndex        =   12
            Text            =   "frmSRAET53.frx":1AD9
            Top             =   70
            Width           =   5955
         End
      End
      Begin VB.Image IM_Denkyu 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         Index           =   0
         Left            =   180
         Picture         =   "frmSRAET53.frx":1B10
         Top             =   135
         Width           =   300
      End
   End
   Begin Threed5.SSPanel5 SSPanel53 
      Height          =   615
      Left            =   0
      TabIndex        =   13
      Top             =   0
      Width           =   5655
      _ExtentX        =   9975
      _ExtentY        =   1085
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
      Begin VB.Image CM_Execute 
         Height          =   330
         Left            =   480
         Picture         =   "frmSRAET53.frx":1C9A
         Top             =   120
         Width           =   360
      End
      Begin VB.Image CM_EndCm 
         Height          =   330
         Left            =   120
         Picture         =   "frmSRAET53.frx":22EC
         Top             =   120
         Width           =   360
      End
      Begin VB.Image Image1 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   555
         Left            =   0
         Top             =   0
         Width           =   3075
      End
   End
   Begin VB.Image Image2 
      Height          =   3375
      Left            =   600
      Top             =   1800
      Width           =   3495
   End
   Begin VB.Label lblDUMMY 
      Height          =   375
      Left            =   0
      TabIndex        =   14
      Top             =   0
      Width           =   135
   End
   Begin VB.Label lblURISU 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      Caption         =   "-999,999"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Left            =   1755
      TabIndex        =   3
      Top             =   1560
      Width           =   765
   End
   Begin VB.Label lblHIN2 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      Caption         =   "XXXXXXXXX1XXXXXXXXX2XXXXXXXXX3"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   240
      Left            =   1695
      TabIndex        =   2
      Top             =   1140
      Width           =   3180
   End
   Begin VB.Label lblHIN1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      Caption         =   "XXXXXXXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Left            =   1680
      TabIndex        =   1
      Top             =   825
      Width           =   930
   End
   Begin VB.Label Label8 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      ForeColor       =   &H80000008&
      Height          =   330
      Left            =   1605
      TabIndex        =   6
      Top             =   1485
      Width           =   1020
   End
   Begin VB.Label Label6 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      ForeColor       =   &H80000008&
      Height          =   330
      Left            =   1605
      TabIndex        =   4
      Top             =   750
      Width           =   1065
   End
   Begin VB.Label Label7 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      ForeColor       =   &H80000008&
      Height          =   330
      Left            =   1605
      TabIndex        =   5
      Top             =   1065
      Width           =   3565
   End
   Begin VB.Menu MN_Ctrl 
      Caption         =   "èàóùÅi&1Åj"
      Begin VB.Menu MN_Execute 
         Caption         =   "ìoò^Åi&RÅj"
         Shortcut        =   ^R
      End
      Begin VB.Menu bar11 
         Caption         =   "-"
      End
      Begin VB.Menu MN_EndCm 
         Caption         =   "èIóπÅi&XÅj"
      End
   End
   Begin VB.Menu MN_EditMn 
      Caption         =   "ï“èWÅi&2Åj"
      Begin VB.Menu MN_APPENDC 
         Caption         =   "âÊñ èâä˙âªÅi&SÅj"
         Shortcut        =   ^S
      End
   End
End
Attribute VB_Name = "FR_SSSMAIN"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'***************************************************************************************
'*  ÅyégópópìrÅzÉVÉäÉAÉãáÇìoò^
'*  ÅyçÏ ê¨ ì˙Åz2006/09/29  SYSTEM CREATE CO.,Ltd.
'*  ÅyçX êV ì˙Åz
'*  Åyîı    çlÅz
'***************************************************************************************
Option Explicit

'-Åy ïœêîêÈåæ Åz-------------------------------------------------------------------------
'AppPathëﬁîóp
Private L_strAppPath                    As String

'ÉfÅ[É^ìoò^óp
Private L_strWRTTM                      As String
Private L_strWRTDT                      As String

'ÉpÉâÉÅÅ[É^éÊìæóp
Private L_strRPTCLTID                   As String
Private L_strPRGID                      As String
Private L_strHINCD                      As String
Private L_strSBNNO                      As String
Private L_strURISU                      As String

' ÉvÉçÉpÉeÉBíläiî[ópïœêî
Dim mstrRPTCLTID                        As String
Dim mstrPRGID                           As String
Dim mstrHINCD                           As String
Dim mstrSBNNO                           As String
Dim mstrURISU                           As String

'ÉXÉvÉåÉbÉhï“èWçsÇÃç≈ëÂíl
Private L_lngMAX_EditRow                As Long

'LeaveCellÉCÉxÉìÉgîªíËÉtÉâÉO
Private L_blnLeaveCell                  As Boolean  'True:ÉCÉxÉìÉgî≠ê∂, False:ÉCÉxÉìÉgñ¢î≠ê∂

'çXêVämîFÉÅÉbÉZÅ[ÉWÉLÉÉÉìÉZÉãéûÇÃActiveCellÉZÉbÉgóp
Private L_LastCol                       As Long     'óÒ
Private L_LastRow                       As Long     'çs
'-------------------------------------------------------------------------Åy ïœêîêÈåæ Åz-

'-Åy íËêîêÈåæ Åz-------------------------------------------------------------------------
'É^ÉCÉgÉã
Private Const LC_strPG_ID               As String = "SRAET53        "
Private Const LC_strTitle               As String = "ÉVÉäÉAÉãáÇìoò^"

' ÉpÉâÉÅÅ[É^ ÉXÉCÉbÉ`íËã`
Private Const mcPARAM_RPTCLTID          As String = "/RPTCLTID:"
Private Const mcPARAM_PRGID             As String = "/PRGID:"
Private Const mcPARAM_HINCD             As String = "/HINCD:"
Private Const mcPARAM_SBNNO             As String = "/SBNNO:"
Private Const mcPARAM_URISU             As String = "/URISU:"

'ÉXÉvÉåÉbÉhîwåiêF
Private Const LC_lng_va_Edit_Color      As Long = &HFFFF&
'Private Const LC_lng_va_UnEdit_Color    As Long = &HFFFFFF
Private Const LC_lng_va_Lock_Color      As Long = &H8000000F

'ÉXÉvÉåÉbÉhÇÃçs
Private Const LC_lngMAX_ROW             As Long = 999999    'ç≈ëÂçsêî
Private Const LC_lngDEFAULT_ROW         As Long = 9999      'ÉfÉtÉHÉãÉgÉZÉbÉgçs

'ÉXÉvÉåÉbÉhÇÃçÄñ⁄
Private Const LC_lngCol_CHECK           As Long = 1         'É`ÉFÉbÉNÉ{ÉbÉNÉX
Private Const LC_lngCol_NO              As Long = 2         'çsáÇ
Private Const LC_lngCol_SERIAL          As Long = 3         'ÉVÉäÉAÉãáÇ
Private Const LC_lngCol_LOCKBN          As Long = 4         'çs€Ø∏ãÊï™
Private Const LC_lngCol_ZAISYOBN        As Long = 5         'ç›å…èàóùãÊï™
Private Const LC_lngCol_SBN             As Long = 6         'êªî‘ÉRÅ[Éh
Private Const LC_lngCol_HID_SERIAL      As Long = 7         'í˘ê≥ëOÉVÉäÉAÉãáÇ

'* ç≈ëÂì¸óÕåÖêî
Private Const C_lngSERIAL_Len           As Long = 13        'ÉVÉäÉAÉãáÇ
Private Const C_lngTNANO_Len            As Long = 9         'íIî‘

' É`ÉFÉbÉNÉ{ÉbÉNÉX
Private Const C_strCHECKBOX_ON          As String = "1"     'ON
Private Const C_strCHECKBOX_OFF         As String = "9"     'OFF

'çsÉçÉbÉNãÊï™
Private Const LC_strLINE_LOCK           As String = "1"     '€Ø∏
Private Const LC_strLINE_NOT_LOCK       As String = "9"     '€Ø∏âèú

'èoâ◊çœÇ›ãÊï™
Private Const LC_strSYUKA               As String = "02"
Private Const LC_strNOT_SYUKA           As String = "  "

'SQLï∂ê∂ê¨éûÇÃÉÇÅ[Éh
Private Enum enumCREATE_MODE
    Insert
    Update
    Delete
End Enum

'ÉÅÉbÉZÅ[ÉWñº
Private Const LC_strAPPEND              As String = "_APPEND        "   'ã§í ÉÅÉbÉZÅ[ÉW
Private Const LC_strCURSOR              As String = "_CURSOR        "   'ã§í ÉÅÉbÉZÅ[ÉW

'ÉÅÉbÉZÅ[ÉWÇhÇc
Private Const CommonMSGSQ               As String = "0"     '* ã§í ÉÅÉbÉZÅ[ÉWÇhÇc
Private Const Entry                     As String = "0"     '* ìoò^ämîFÉÅÉbÉZÅ[ÉW
Private Const EntryFinal                As String = "1"     '* ìoò^å„ÉÅÉbÉZÅ[ÉW
Private Const SerialNoNull              As String = "2"     '* ÉVÉäÉAÉãáÇNULL
Private Const TnaNoNull                 As String = "3"     '* íIî‘NULL
Private Const InfSyuka                  As String = "4"     '* èoâ◊çœÇ›ÇÃÉVÉäÉAÉãáÇÇÕì¸óÕÇ≥ÇÍÇ‹ÇµÇΩÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH
Private Const InfLineLittle             As String = "5"     '* ì¸óÕçsêîÇ™êîó Çâ∫âÒÇ¡ÇƒÇ¢Ç‹Ç∑ÅBìoò^ÇµÇƒÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH
Private Const InfLineOver               As String = "6"     '* ì¸óÕçsêîÇ™êîó Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB
Private Const SerialNoExists            As String = "7"     '* ì¸óÕÇµÇƒÇ¢ÇÈÉVÉäÉAÉãáÇä«óùÉeÅ[ÉuÉãÇ…ë∂ç›ÇµÇ»Ç¢à◊ÅAégópÇ≈Ç´Ç‹ÇπÇÒÅB
Private Const DoubleSerialNo            As String = "8"     '* ÉVÉäÉAÉãáÇÇ™èdï°ÇµÇƒÇ¢Ç‹Ç∑ÅB
Private Const SerialKeta                As String = "9"     '* ÉVÉäÉAÉãáÇÇÕ %N åÖÇ‹Ç≈ì¸óÕâ¬î\Ç≈Ç∑ÅB
Private Const TnaNoKeta                 As String = "A"     '* íIî‘ÇÕ %N åÖÇ‹Ç≈ì¸óÕâ¬î\Ç≈Ç∑ÅB
Private Const NotHINCD                  As String = "B"     '* %CDÇ∆Ç¢Ç§è§ïiÉRÅ[ÉhÇÕë∂ç›ÇµÇ‹ÇπÇÒÅB
'-------------------------------------------------------------------------Åy íËêîêÈåæ Åz-

'=Åy ÉCÉxÉìÉg Åz=========================================================================

'-ÅyÃﬂŸ¿ﬁ≥›“∆≠∞Åz-----------------------------------------------------------------------
'===========================================================================
'ÅyégópópìrÅz ìoò^(R)ëIëéû
'Åyä÷ êî ñºÅz MN_Execute_Click
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub MN_Execute_Click()
    Call CM_Execute_Click
End Sub

'===========================================================================
'ÅyégópópìrÅz èIóπ(X)ëIëéû
'Åyä÷ êî ñºÅz MN_EditMn_Click
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub MN_EndCm_Click()
    Call CM_EndCm_Click
End Sub

'===========================================================================
'ÅyégópópìrÅz âÊñ èâä˙âª(S)ëIëéû
'Åyä÷ êî ñºÅz MN_APPENDC_Click
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub MN_APPENDC_Click()
    'ÉXÉvÉåÉbÉhÇÃÉNÉäÉA
    Call P_vaData_Init
    'âÊñ ÇÃèâä˙ï\é¶
    Call P_Show_Data
End Sub

'===========================================================================
'ÅyégópópìrÅz [èIóπ]É{É^ÉìÉNÉäÉbÉNéû
'Åyä÷ êî ñºÅz CM_EndCm_Click
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_EndCm_Click()
    Unload Me
End Sub

'===========================================================================
'ÅyégópópìrÅz [èIóπ]É{É^ÉìMouseDownéû
'Åyä÷ êî ñºÅz CM_EndCm_MouseDown
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_EndCm_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    CM_EndCm.Picture = IM_EndCm(2).Picture
End Sub

'===========================================================================
'ÅyégópópìrÅz [èIóπ]É{É^ÉìMouseUpéû
'Åyä÷ êî ñºÅz CM_EndCm_MouseUp
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_EndCm_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    CM_EndCm.Picture = IM_EndCm(1).Picture
End Sub

'===========================================================================
'ÅyégópópìrÅz [èIóπ]É{É^ÉìMouseMoveéû
'Åyä÷ êî ñºÅz CM_EndCm_MouseMove
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_EndCm_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single) 'Hand Made
    IM_Denkyu(0).Picture = IM_Denkyu(2).Picture
    TX_Message.Text = "ÉÅÉjÉÖÅ[Ç…ñﬂÇËÇ‹Ç∑ÅB"
End Sub

'===========================================================================
'ÅyégópópìrÅz Image2 MouseMoveéû
'Åyä÷ êî ñºÅz Image2_MouseMove
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub Image2_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Screen.MousePointer = vbDefault
End Sub

'===========================================================================
'ÅyégópópìrÅz [ìoò^]É{É^ÉìÉNÉäÉbÉNéû
'Åyä÷ êî ñºÅz CM_Execute_Click
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_Execute_Click()

    Dim msgMsgBox       As VbMsgBoxResult
    Dim lngRow          As Long
    Dim Mst_Inf         As TYPE_DB_SYSTBH
    Dim intRet          As Integer
    Dim strMSGKBN       As String
    Dim strMSGNM        As String

    strMSGKBN = "1"
        
    'ÉXÉvÉåÉbÉhÇÃì¸óÕÉ`ÉFÉbÉN
    If P_EntryCheck(lngRow) = False Then
        L_blnLeaveCell = False
        CM_Execute.Picture = IM_Execute(1).Picture
        Exit Sub
    End If
        
    'óLå¯çsêîÇ∆êîó Çî‰ärÇµÉÅÉbÉZÅ[ÉWÇêÿÇËë÷Ç¶ÇÈ
    If lngRow > CLng(lblURISU.Caption) Then
        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, InfLineOver, Mst_Inf)
        If intRet <> 0 Then
            L_blnLeaveCell = False
            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
            Exit Sub
        End If
        Call GP_MsgBox(Exclamation, Mst_Inf.MSGCM, LC_strTitle)
        '* ÉZÉãîwåiêFÇâèú
        With vaData
            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, False, LC_lngCol_CHECK, .MaxRows)
            Call P_Va_BackColor_LINE_LOCK
        End With
        If L_LastCol > 0 And L_LastRow > 0 Then
            Call GP_Va_Col_EditColor(vaData, L_LastCol, L_LastRow, True)
            Call GP_SpActiveCell(vaData, L_LastCol, L_LastRow)
        Else
            If L_lngMAX_EditRow + 1 > LC_lngMAX_ROW Then
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, LC_lngMAX_ROW, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, LC_lngMAX_ROW)
            Else
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, L_lngMAX_EditRow + 1, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, L_lngMAX_EditRow + 1)
            End If
        End If
        CM_Execute.Picture = IM_Execute(1).Picture
        Exit Sub
    End If
    
    'óLå¯çsêîÇ∆êîó Çî‰ärÇµÉÅÉbÉZÅ[ÉWÇêÿÇËë÷Ç¶ÇÈ
    If CLng(lblURISU.Caption) > lngRow Then
        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, InfLineLittle, Mst_Inf)
        If intRet <> 0 Then
            L_blnLeaveCell = False
            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
            Exit Sub
        End If
    Else
        strMSGKBN = "0"
        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strAPPEND, CommonMSGSQ, Mst_Inf)
        If intRet <> 0 Then
            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
            L_blnLeaveCell = False
            CM_Execute.Picture = IM_Execute(1).Picture
            Exit Sub
        End If
    End If
    
    msgMsgBox = GP_MsgBox(Execute, Mst_Inf.MSGCM, LC_strTitle)
    If msgMsgBox <> vbYes Then
        CM_Execute.Picture = IM_Execute(1).Picture
        L_blnLeaveCell = False
        Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, False, LC_lngCol_SERIAL, vaData.MaxRows)
        Call P_Va_BackColor_LINE_LOCK
        If L_LastCol > 0 And L_LastRow > 0 Then
            Call GP_Va_Col_EditColor(vaData, L_LastCol, L_LastRow, True)
            Call GP_SpActiveCell(vaData, L_LastCol, L_LastRow)
        Else
            If L_lngMAX_EditRow + 1 > LC_lngMAX_ROW Then
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, LC_lngMAX_ROW, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, LC_lngMAX_ROW)
            Else
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, L_lngMAX_EditRow + 1, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, L_lngMAX_EditRow + 1)
            End If
        End If
        Exit Sub
    End If
    
    Screen.MousePointer = vbHourglass
    
    'ìoò^èàóù
    If P_Main() = True Then
        Call CM_EndCm_Click
        Exit Sub
    End If

EndLabel:
    '* ÉZÉãîwåiêFÇê›íË
    Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, 1, True)
    Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, 1)
    
    Screen.MousePointer = vbDefault
    
    L_blnLeaveCell = False
    
    CM_Execute.Picture = IM_Execute(1).Picture
    
End Sub

'===========================================================================
'ÅyégópópìrÅz [ìoò^]É{É^ÉìMouseDownéû
'Åyä÷ êî ñºÅz CM_Execute_MouseDown
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_Execute_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    L_blnLeaveCell = False
    CM_Execute.Picture = IM_Execute(2).Picture
End Sub

'===========================================================================
'ÅyégópópìrÅz [ìoò^]É{É^ÉìMouseUpéû
'Åyä÷ êî ñºÅz CM_Execute_MouseUp
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_Execute_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    L_blnLeaveCell = False
    CM_Execute.Picture = IM_Execute(1).Picture
End Sub

'===========================================================================
'ÅyégópópìrÅz [ìoò^]É{É^ÉìMouseMoveéû
'Åyä÷ êî ñºÅz CM_Execute_MouseMove
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub CM_Execute_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single) 'Hand Made
    IM_Denkyu(0).Picture = IM_Denkyu(2).Picture
    TX_Message.Text = "ìoò^ÇµÇ‹Ç∑ÅB"
End Sub

'===========================================================================
'ÅyégópópìrÅz [É_É~Å[]ÉCÉÅÅ[ÉWMouseMoveéû
'Åyä÷ êî ñºÅz Image1_MouseMove
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub Image1_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single) 'Hand Made
    Call Init_Prompt
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉtÉHÅ[ÉÄÉçÅ[Éhéû
'Åyä÷ êî ñºÅz Form_Load
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub Form_Load()

    Dim lngIndex    As Long
    Dim strHINNM    As String
    Dim CommandLine As String
    Dim strArry()   As String     ' à¯êîéÊìæîzóÒ
    Dim strRet      As String     ' à¯êîÉèÅ[ÉN
    Dim strRetU     As String       ' à¯êîÉèÅ[ÉN
    Dim intRet      As Integer
    Dim strMSGKBN   As String
    Dim Mst_Inf     As TYPE_DB_SYSTBH

    Me.KeyPreview = True
    
    'ìØàÍÉvÉçÉOÉâÉÄÇ™ãNìÆÇµÇƒÇ¢ÇΩèÍçáÇÕèIóπÇ∑ÇÈ
    If App.PrevInstance Then
        Call GP_MsgBox(Critical, "ä˘Ç…ãNìÆÇµÇƒÇ¢Ç‹Ç∑ÅB", LC_strTitle)
        End
    End If
    
    'ÉtÉHÅ[ÉÄÇÃà íuÇÉZÉbÉg
    Me.Top = (Screen.Height - Me.Height) / 2
    Me.Left = (Screen.Width - Me.Width) / 2
    
    'AppPathÇÃëﬁî
    L_strAppPath = App.Path
    
    'ÉpÉâÉÅÅ[É^éÊìæ
    strArry = Split(Replace(Command(), """", ""), " ")
    L_strRPTCLTID = Replace(strArry(0), mcPARAM_RPTCLTID, "")
    L_strPRGID = Replace(strArry(1), mcPARAM_PRGID, "")
    L_strHINCD = Replace(strArry(2), mcPARAM_HINCD, "")
    L_strSBNNO = Replace(strArry(3), mcPARAM_SBNNO, "")
    L_strURISU = Replace(strArry(4), mcPARAM_URISU, "")
    
    'ÉpÉâÉÅÅ[É^Ç≈ïsîıÇ™Ç†ÇÍÇŒñ{âÊñ ÇÕãNìÆÇ≥ÇπÇ»Ç¢
    If L_strRPTCLTID = "" Then
        Call GP_MsgBox(Critical, "ÉèÅ[ÉNÉXÉeÅ[ÉVÉáÉìÇhÇcÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", LC_strTitle)
        End
    End If
    If L_strPRGID = "" Then
        Call GP_MsgBox(Critical, "ÉvÉçÉOÉâÉÄÇhÇcÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", LC_strTitle)
        End
    End If
    If L_strHINCD = "" Then
        Call GP_MsgBox(Critical, "êªïiÉRÅ[ÉhÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", LC_strTitle)
        End
    End If
    If L_strSBNNO = "" Then
        Call GP_MsgBox(Critical, "êªî‘Ç™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", LC_strTitle)
        End
    End If
    If L_strURISU = "" Then
        Call GP_MsgBox(Critical, "îÑè„êîó Ç™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", LC_strTitle)
        End
    Else
        If IsNumeric(L_strURISU) = False Then
            Call GP_MsgBox(Critical, "îÑè„êîó Ç™êîílÇ≈ÇÕÇ†ÇËÇ‹ÇπÇÒÅB", LC_strTitle)
            End
        End If
    End If

    'ÉtÉHÅ[ÉÄÇÃÉNÉäÉA
    Call P_FromClear
    
    'DBê⁄ë±
    Call CF_Ora_USR1_Open   'USR1
    Call CF_Ora_USR9_Open   'USR9
    
    'éÛÇØéÊÇ¡ÇΩÉpÉâÉÅÅ[É^ÇâÊñ Ç…ÉZÉbÉg
    lblHIN1.Caption = L_strHINCD
    If P_GET_HINNMA(L_strHINCD, strHINNM) = True Then
        lblHIN2.Caption = strHINNM
    Else
        'ë∂ç›ÇµÇ»Ç¢è§ïiÉRÅ[Éh
        strMSGKBN = "1"
        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, NotHINCD, Mst_Inf)
        If intRet <> 0 Then
            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
            End
        End If
        Call GP_MsgBox(Exclamation, Replace(Mst_Inf.MSGCM, "%CD", L_strHINCD), LC_strTitle)
        End
    End If
    lblURISU.Caption = L_strURISU
    
    'âÊñ ÇÃèâä˙ï\é¶
    Call P_Show_Data
    
    L_LastCol = -1
    L_LastRow = -1
    
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉAÉìÉçÅ[Éhéû
'Åyä÷ êî ñºÅz Form_QueryUnload
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
    'DBê⁄ë±âèú
    Call CF_Ora_DisConnect(gv_Oss_USR1, gv_Odb_USR1)
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉLÅ[âüâ∫éû
'Åyä÷ êî ñºÅz Form_KeyPress
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub Form_KeyPress(KeyAscii As Integer)
    If TypeOf Me.ActiveControl Is TextBox Or _
        TypeOf Me.ActiveControl Is ComboBox Or _
        TypeOf Me.ActiveControl Is OptionButton Then
        
        Call GP_CtrlSend(KeyAscii, Me)
    End If
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÉGÉfÉBÉbÉgÉÇÅ[ÉhïœçXéû
'Åyä÷ êî ñºÅz vaData_EditChange
'ÅyçX êV ì˙Åz
'Åyîı    çlÅzÉXÉvÉåÉbÉhÇ™ç≈èIçsÇ…íBÇµÇΩéûÅAêVãKì¸óÕçsÇê∂ê¨
'===========================================================================
Private Sub vaData_EditChange(ByVal Col As Long, ByVal Row As Long)

    With vaData
        If LC_lngMAX_ROW <> .MaxRows Then
            If .MaxRows = Row Then
                .MaxRows = .MaxRows + 1
                .Row = 1
                .Row2 = .MaxRows
                .Col = LC_lngCol_NO
                .Col2 = LC_lngCol_NO
                .BlockMode = True
                .BackColor = Me.BackColor
                .Protect = True
                .Lock = True
                Call .SetText(LC_lngCol_NO, Row + 1, Row + 1)
                Call SetEdit(vaData, LC_lngCol_CHECK, Row + 1)
                Call SetEdit(vaData, LC_lngCol_SERIAL, Row + 1)
                Call SetEdit(vaData, LC_lngCol_LOCKBN, Row + 1)
                Call SetEdit(vaData, LC_lngCol_ZAISYOBN, Row + 1)
                Call SetEdit(vaData, LC_lngCol_SBN, Row + 1)
                Call SetEdit(vaData, LC_lngCol_HID_SERIAL, Row + 1)
            End If
        End If
    End With

End Sub

Private Sub vaData_KeyDown(KeyCode As Integer, Shift As Integer)
    Call F_SendKey(KeyCode)
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉZÉãà⁄ìÆéû
'Åyä÷ êî ñºÅz vaData_LeaveCell
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub vaData_LeaveCell(ByVal Col As Long, ByVal Row As Long, ByVal NewCol As Long, ByVal NewRow As Long, Cancel As Boolean)
    
    Dim lngI            As Long
    Dim lngJ            As Long
    Dim varCHECK        As Variant
    Dim varNO           As Variant
    Dim varSERIAL       As Variant
    Dim varSERIAL_C     As Variant
    Dim varLOCKBN       As Variant
    Dim varNewRowLOCKBN As Variant
    Dim varTNANO        As Variant
    Dim varZAISYOBN     As Variant
    Dim strKBN          As String
    Dim msgMsgBox       As VbMsgBoxResult
    Dim strMSGKBN       As String
    Dim strMSGNM        As String
    Dim Mst_Inf         As TYPE_DB_SYSTBH
    Dim intRet          As Integer
    
    L_blnLeaveCell = True

    '* ÉZÉãîwåiêFÇâèú
    With vaData
        Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, False, LC_lngCol_SERIAL, .MaxRows)
        Call P_Va_BackColor_LINE_LOCK
    End With
    
    'ÉfÅ[É^ì¸óÕç≈ëÂçsÇéÊìæ
    L_lngMAX_EditRow = P_Get_EditMaxRow
    
    'ÉZÉãÇÃílÇéÊìæ
    Call vaData.GetText(LC_lngCol_ZAISYOBN, Row, varZAISYOBN)
    Call vaData.GetText(LC_lngCol_CHECK, Row, varCHECK)
    Call vaData.GetText(LC_lngCol_SERIAL, Row, varSERIAL)
    Call vaData.GetText(LC_lngCol_LOCKBN, Row, varLOCKBN)
    If NewRow > 0 Then
        Call vaData.GetText(LC_lngCol_LOCKBN, NewRow, varNewRowLOCKBN)
    End If
    
    'ì¸óÕï∂éöÇëÂï∂éöÇ…ïœä∑ÇµÇƒÉZÉãÇ…çƒÉZÉbÉg
    Call vaData.SetText(LC_lngCol_SERIAL, Row, StrConv(Nz(varSERIAL), vbUpperCase))
    
    Select Case Col
    'É`ÉFÉbÉNÉ{ÉbÉNÉXÇÃÇ∆Ç´
        Case LC_lngCol_CHECK
            With vaData
                If varLOCKBN = LC_strLINE_LOCK Then
                    If Row > 0 Then
                        If Row = .MaxRows Then
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row)
                        Else
                            If Row = NewRow Then
                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row + 1, True)
                                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row + 1)
                            Else
                                If NewCol > 0 And NewRow > 0 Then
                                    If NewCol = LC_lngCol_NO Then
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                                    ElseIf NewCol > LC_lngCol_SERIAL Then
                                        If NewRow = .MaxRows Then
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, .MaxRows, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, .MaxRows)
                                        Else
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                                        End If
                                    Else
                                        If varNewRowLOCKBN = LC_strLINE_LOCK Then
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                                        Else
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, NewRow, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, NewRow)
                                        End If
                                    End If
                                End If
                            End If
                        End If
                    Else
                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
                        Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, 1)
                    End If
                Else
                    If NewCol > 0 And NewRow > 0 Then
                        If NewCol > LC_lngCol_SERIAL Then
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                        Else
                            If NewCol = LC_lngCol_NO Then
                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, NewRow, True)
                                Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, NewRow)
                            ElseIf NewCol > LC_lngCol_SERIAL Then
                                If NewRow = .MaxRows Then
                                    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, .MaxRows, True)
                                    Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, .MaxRows)
                                Else
                                    Call GP_Va_Col_EditColor(vaData, NewCol, NewRow, True)
                                    Call GP_SpActiveCell(vaData, NewCol, NewRow)
                                End If
                            Else
                                Call GP_Va_Col_EditColor(vaData, NewCol, NewRow, True)
                                Call GP_SpActiveCell(vaData, NewCol, NewRow)
                            End If
                        End If
                    End If
                End If
            End With
    
    'ÉVÉäÉAÉãî‘çÜÇÃÇ∆Ç´
        Case LC_lngCol_SERIAL
            strMSGKBN = "1"
            With vaData
                If Nz(varSERIAL) <> "" Then
                    'ë∂ç›É`ÉFÉbÉNÅiä«óùÉeÅ[ÉuÉãÅj
                    If P_SRANOCheck(CStr(varSERIAL), strKBN) = False Then
                        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, SerialNoExists, Mst_Inf)
                        If intRet <> 0 Then
                            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                            Exit Sub
                        End If
                        Call GP_MsgBox(Exclamation, Mst_Inf.MSGCM, LC_strTitle)
                        If Col > 0 And NewRow > 0 Then
                            If Col > LC_lngCol_SERIAL Then
                                If Row = .MaxRows Then
                                    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row, True)
                                    Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row)
                                Else
                                    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row + 1, True)
                                    Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row + 1)
                                End If
                            Else
                                Call GP_Va_Col_EditColor(vaData, Col, Row, True)
                                Call GP_SpActiveCell(vaData, Col, Row)
                            End If
                        Else
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, 1)
                        End If
                        Exit Sub
                    Else
                        '* ÉVÉäÉAÉãáÇèdï°É`ÉFÉbÉN
                        lngJ = 1
                        For lngJ = 1 To L_lngMAX_EditRow
                            varSERIAL_C = ""
                            If Row <> lngJ Then
                                Call .GetText(LC_lngCol_SERIAL, lngJ, varSERIAL_C)
                                If Nz(varSERIAL_C) <> "" Then
                                    If varSERIAL = varSERIAL_C Then
                                        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, DoubleSerialNo, Mst_Inf)
                                        If intRet <> 0 Then
                                            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                                            Exit Sub
                                        End If
                                        Call GP_MsgBox(Exclamation, Mst_Inf.MSGCM, LC_strTitle)
                                        If Row > 0 Then
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, Row, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, Row)
                                        Else
                                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
                                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, 1)
                                        End If
                                        Exit Sub
                                    End If
                                End If
                            End If
                        Next

                    '* éÊìæÇµÇΩç›å…ãÊï™ÇâBÇµçÄñ⁄Ç…ÉZÉbÉg
                        If Row > 0 Then
                            Call .SetText(LC_lngCol_ZAISYOBN, Row, strKBN)
                        End If

                    '* ç›å…èàóùãÊï™ÇÃèoâ◊çœÇ›îªíËÇçsÇ¢ÅAäYìñÇµÇΩÇ∆Ç´åxçêÉÅÉbÉZÅ[ÉWÇï\é¶
                        If strKBN = LC_strSYUKA Then
                            intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, InfSyuka, Mst_Inf)
                            If intRet <> 0 Then
                                Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                                Exit Sub
                            End If
                            msgMsgBox = GP_MsgBox(Execute, Mst_Inf.MSGCM, LC_strTitle)
                            If msgMsgBox <> vbYes Then
                                If Col > 0 And Row > 0 Then
                                    Call GP_Va_Col_EditColor(vaData, Col, Row, True)
                                    Call GP_SpActiveCell(vaData, Col, Row)
                                Else
                                    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
                                    Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, 1)
                                End If
                                Exit Sub
                            End If
                        End If
                    End If
                    'ÉVÉäÉAÉãáÇÉ`ÉFÉbÉNÇ™OKÇÃÇ∆Ç´ÇÕé©ìÆÇ≈É`ÉFÉbÉNÉ{ÉbÉNÉXÇONÇ…Ç∑ÇÈ
                    Call .SetText(LC_lngCol_CHECK, Row, C_strCHECKBOX_ON)

                    If NewCol > LC_lngCol_SERIAL Then
                        If Row = .MaxRows Then
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row)
                        Else
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row + 1, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row + 1)
                        End If
                    ElseIf NewCol < 0 Then
'''                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_HID_SERIAL, 1, True)
'''                        Call GP_SpActiveCell(vaData, LC_lngCol_HID_SERIAL, 1)
                    Else
                        If NewRow < 0 Then
'''                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_HID_SERIAL, 1, True)
'''                            Call GP_SpActiveCell(vaData, LC_lngCol_HID_SERIAL, 1)
                        Else
                            If NewCol = LC_lngCol_NO Then
                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                            Else
                                Call GP_Va_Col_EditColor(vaData, NewCol, NewRow, True)
                                Call GP_SpActiveCell(vaData, NewCol, NewRow)
                            End If
                        End If
                    End If
                Else
                    If varCHECK = C_strCHECKBOX_ON Then
                        intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, SerialNoNull, Mst_Inf)
                        If intRet <> 0 Then
                            Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                            Exit Sub
                        End If
                        Call GP_MsgBox(Exclamation, Mst_Inf.MSGCM, LC_strTitle)
                        If Row > 0 Then
                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, Row, True)
                            Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, Row)
                        Else
'''                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
'''                            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, 1)
                        End If
                        Exit Sub
                    Else
                        If NewCol > LC_lngCol_SERIAL Then
                            If Row = .MaxRows Then
                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row, True)
                                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row)
                            Else
                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, Row + 1, True)
                                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, Row + 1)
                            End If
                        ElseIf NewCol < 0 Then
'''                            Call GP_Va_Col_EditColor(vaData, LC_lngCol_HID_SERIAL, 1, True)
'''                            Call GP_SpActiveCell(vaData, LC_lngCol_HID_SERIAL, 1)
                        Else
                            If NewRow < 0 Then
'''                                Call GP_Va_Col_EditColor(vaData, LC_lngCol_HID_SERIAL, 1, True)
'''                                Call GP_SpActiveCell(vaData, LC_lngCol_HID_SERIAL, 1)
                            Else
                                If NewCol = LC_lngCol_NO Then
                                    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                    Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                                Else
                                    If varNewRowLOCKBN = LC_strLINE_LOCK Then
                                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                                        Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                                    Else
                                        Call GP_Va_Col_EditColor(vaData, NewCol, NewRow, True)
                                        Call GP_SpActiveCell(vaData, NewCol, NewRow)
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End With
    End Select

    If NewRow - 1 > 0 Then
        'è„Ç©ÇÁèáî‘Ç…ì¸óÕÇ∑ÇÈédólÇ≈Ç†ÇÈà◊ÅAëOçsÇÃílÇNULLÉ`ÉFÉbÉNÇµNULLÇ»ÇÁÉGÉâÅ[
        Call vaData.GetText(LC_lngCol_SERIAL, NewRow - 1, varSERIAL)
        If Nz(varSERIAL) = "" Then
            strMSGKBN = "0"
            intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strCURSOR, CommonMSGSQ, Mst_Inf)
            If intRet <> 0 Then
                Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                Exit Sub
            End If
            Call GP_MsgBox(Critical, Mst_Inf.MSGCM, LC_strTitle)
            '* ÉZÉãîwåiêFÇâèú
            With vaData
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, False, LC_lngCol_SERIAL, .MaxRows)
                Call P_Va_BackColor_LINE_LOCK
            End With
            If Row > 0 Then
                Call GP_Va_Col_EditColor(vaData, Col, Row, True)
                Call GP_SpActiveCell(vaData, Col, Row)
            Else
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, 1, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, 1)
            End If
            Exit Sub
        End If
    End If
    
    'ç≈èIì¸óÕçsÇÃÇ∆Ç´ÇÕ[ìoò^]É{É^Éìâüâ∫éûÇÃèàóùåƒèo
    If NewCol = LC_lngCol_LOCKBN And (NewRow > L_lngMAX_EditRow Or NewRow = vaData.MaxRows) Then
        Call vaData.GetText(LC_lngCol_SERIAL, NewRow, varSERIAL)
        If Nz(varSERIAL) = "" Then
            L_lngMAX_EditRow = P_Get_EditMaxRow
            L_blnLeaveCell = True
            L_LastCol = Col
            L_LastRow = Row
            Call CM_EndCm_Click
            L_LastCol = -1
            L_LastRow = -1
            L_blnLeaveCell = False
        End If
    End If

    If L_blnLeaveCell = True Then
        '* ÉZÉãîwåiêFÇâèú
        With vaData
            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, False, LC_lngCol_SERIAL, .MaxRows)
            Call P_Va_BackColor_LINE_LOCK
        End With
        '* ÉZÉãîwåiêFÇê›íË
        If NewCol <> -1 Or NewRow <> -1 Then
            If NewCol > LC_lngCol_SERIAL Or varNewRowLOCKBN <> LC_strLINE_LOCK Then
                If NewCol = LC_lngCol_NO Then
                    If Col = LC_lngCol_CHECK Then
                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, NewRow, True)
                        Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, NewRow)
                    Else
                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                        Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
                    End If
                Else
                    Call GP_Va_Col_EditColor(vaData, NewCol, NewRow, True)
                    Call GP_SpActiveCell(vaData, NewCol, NewRow)
                End If
            Else
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, NewRow, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, NewRow)
            End If
        Else
            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
        End If
    End If
    
    L_blnLeaveCell = False

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÉtÉHÅ[ÉJÉXéÊìæéû
'Åyä÷ êî ñºÅz vaData_GotFocus
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub vaData_GotFocus()

    Dim varLOCKBN As Variant

    'ÉJÅ[É\Éãêßå‰ÅB
    With vaData
        If .ActiveRow > 0 Then
            Call .GetText(LC_lngCol_LOCKBN, .ActiveRow, varLOCKBN)
            If varLOCKBN = LC_strLINE_LOCK Then
                Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, .ActiveRow, True)
                Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, .ActiveRow)
            End If
        Else
            txtDummy.SetFocus
        End If
    End With
    
End Sub
'=========================================================================Åy ÉCÉxÉìÉg Åz=

'=Åy ÉÅÉ\ÉbÉh Åz=========================================================================
'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhîwåiêFê›íË
'Åyä÷ êî ñºÅz P_Va_BackColor
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_Va_BackColor()

    With vaData
        .Row = 1
        .Row2 = .MaxRows
        .Col = LC_lngCol_NO
        .Col2 = LC_lngCol_NO
        .BlockMode = True
        .BackColor = Me.BackColor
        .BlockMode = False
    End With

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhîwåiêFê›íË(çsÉçÉbÉNãÊï™îªíË)
'Åyä÷ êî ñºÅz P_Va_BackColor_LINE_LOCK
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_Va_BackColor_LINE_LOCK()
    
    Dim lngRow          As Long
    Dim varLOCKBN       As Variant

    If IsNumeric(L_lngMAX_EditRow) = False Then
        Exit Sub
    Else
        If L_lngMAX_EditRow <= 0 Then
            Exit Sub
        End If
    End If

    With vaData
        lngRow = 1
        For lngRow = 1 To L_lngMAX_EditRow
            Call .GetText(LC_lngCol_LOCKBN, lngRow, varLOCKBN)
            If varLOCKBN = LC_strLINE_LOCK Then
                Call GP_Va_Col_LockColor_Row(vaData, lngRow)
            End If
        Next
    End With

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÉçÉbÉNêßå‰
'Åyä÷ êî ñºÅz P_Va_Lock
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_Va_Lock()

    With vaData
        .Row = 1
        .Col = LC_lngCol_NO
        .Row2 = .MaxRows
        .Col2 = LC_lngCol_NO
        .BlockMode = True
        .Protect = True
        .BackColor = LC_lng_va_Lock_Color
        .Lock = True
        .BlockMode = False
    End With

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhçsÉçÉbÉNêßå‰
'Åyä÷ êî ñºÅz P_Va_Lock_Row
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_Va_Lock_Row(ByVal lngRow As Long)

    With vaData
        .Row = lngRow
        .Col = LC_lngCol_NO
        .Row2 = lngRow
        .Col2 = LC_lngCol_SERIAL
        .BlockMode = True
        .Protect = True
        .Lock = True
        .BlockMode = False
    End With
    
    Call GP_Va_Col_LockColor_Row(vaData, lngRow)

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉfÅ[É^ï\é¶
'Åyä÷ êî ñºÅz P_Show_Data
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_Show_Data() As Boolean

    Dim Usr_Ody_LC  As U_Ody
    Dim lngI        As Long
    Dim intLen      As Integer

    'ÉfÅ[É^ÇÃéÊìæÅB
    If P_Get_Data(Usr_Ody_LC) = True Then
        'ÉfÅ[É^ÇâÊñ Ç…ï\é¶Ç∑ÇÈÅB
        Call P_Set_Data(Usr_Ody_LC)
    Else
        Call SetEdit(vaData, LC_lngCol_SERIAL, 1)
        Call SetEdit(vaData, LC_lngCol_LOCKBN, 1)
        Call SetEdit(vaData, LC_lngCol_ZAISYOBN, 1)
        Call SetEdit(vaData, LC_lngCol_SBN, 1)
        Call SetEdit(vaData, LC_lngCol_HID_SERIAL, 1)
        vaData.MaxRows = LC_lngDEFAULT_ROW
        intLen = Len(CStr(LC_lngMAX_ROW))
        For lngI = 1 To vaData.MaxRows
            Call SetEdit(vaData, LC_lngCol_CHECK, lngI)
            Call vaData.SetText(LC_lngCol_NO, lngI, Right(Space(intLen) & CStr(lngI), intLen))
        Next
        Call P_Va_BackColor
    End If
    
    Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, 1, True)
    Call GP_Va_Col_LockColor(vaData, LC_lngCol_NO)
    Call P_Va_Lock
    
    
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody_LC)
    
    L_blnLeaveCell = False
    
End Function

'===========================================================================
'ÅyégópópìrÅz ÉfÅ[É^ÉZÉbÉg
'Åyä÷ êî ñºÅz P_Set_Data
'Åyà¯    êîÅz ByRef Usr_Ody_LC As U_Ody   :É_ÉCÉiÉZÉbÉgèÓïÒç\ë¢ëÃ
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_Set_Data(ByRef Usr_Ody_LC As U_Ody) As Boolean

    Dim lngI        As Long
    Dim lngJ        As Long
    Dim blnFLG      As Boolean
    Dim intLen      As Integer
    Dim lngRecCount As Long
    Dim varLOCKBN   As Variant
    Dim varZAISYOBN As Variant

On Error GoTo ErrLbl:
    
    P_Set_Data = False
    
    lngI = 0
    blnFLG = False
    
    intLen = Len(CStr(LC_lngMAX_ROW))
    
    With vaData
        Call SetEdit(vaData, LC_lngCol_SERIAL, 1)
        Call SetEdit(vaData, LC_lngCol_LOCKBN, 1)
        Call SetEdit(vaData, LC_lngCol_ZAISYOBN, 1)
        Call SetEdit(vaData, LC_lngCol_SBN, 1)
        Call SetEdit(vaData, LC_lngCol_HID_SERIAL, 1)
        .ReDraw = False
        'ÉXÉvÉåÉbÉhÇÃçsêîÇÃê›íË
        .MaxRows = 0
        'ÉXÉvÉåÉbÉhÇ…ÉfÅ[É^Çï\é¶Ç∑ÇÈÅB
        Do Until CF_Ora_EOF(Usr_Ody_LC) = True
            .MaxRows = .MaxRows + 1
            lngI = lngI + 1
            Call SetEdit(vaData, LC_lngCol_CHECK, lngI)
            If CF_Ora_GetDyn(Usr_Ody_LC, "CHKFLG", "") = C_strCHECKBOX_ON Then
                Call .SetText(LC_lngCol_CHECK, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "CHKFLG", ""))
            End If
            Call .SetText(LC_lngCol_NO, lngI, Right(Space(intLen) & CStr(lngI), intLen))
            Call SetEdit(vaData, LC_lngCol_SERIAL, lngI)
            Call .SetText(LC_lngCol_SERIAL, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "SRANO", ""))
            Call .SetText(LC_lngCol_HID_SERIAL, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "SRANO", ""))
            Call .SetText(LC_lngCol_LOCKBN, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "LOCKBN", ""))
            Call .SetText(LC_lngCol_ZAISYOBN, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "ZAISYOBN", ""))
            Call .GetText(LC_lngCol_LOCKBN, lngI, varLOCKBN)
            Call .GetText(LC_lngCol_ZAISYOBN, lngI, varZAISYOBN)
            If varLOCKBN = LC_strLINE_LOCK Then
                Call P_Va_Lock_Row(lngI)
            End If
            Call .SetText(LC_lngCol_SBN, lngI, CF_Ora_GetDyn(Usr_Ody_LC, "SBNNO", ""))
            Call CF_Ora_MoveNext(Usr_Ody_LC)
        Loop
        
        'èâä˙ï\é¶Ç∑ÇÈÉXÉvÉåÉbÉhçsêîÇÕç≈í·LC_lngDEFAULT_ROWçsÇ∆Ç∑ÇÈ
        lngRecCount = Usr_Ody_LC.Obj_Ody.RecordCount
        L_lngMAX_EditRow = lngRecCount
        If lngRecCount > LC_lngDEFAULT_ROW Then
            .MaxRows = lngRecCount
        Else
            .MaxRows = LC_lngDEFAULT_ROW
            blnFLG = True
        End If

        If blnFLG = True Then
            For lngJ = lngI To vaData.MaxRows
                Call .SetText(LC_lngCol_NO, lngJ, Right(Space(intLen) & CStr(lngJ), intLen))
                Call SetEdit(vaData, LC_lngCol_CHECK, lngJ)
                Call SetEdit(vaData, LC_lngCol_SERIAL, lngJ)
            Next
        End If
        
        .ReDraw = True
    End With
    
    P_Set_Data = True
    

Exit Function
ErrLbl:
    Call GP_MsgBox(Critical, Err.Description)
End Function

'===========================================================================
'ÅyégópópìrÅz ÉfÅ[É^éÊìæ
'Åyä÷ êî ñºÅz P_Get_Data
'Åyà¯    êîÅz ByRef Usr_Ody_LC As U_Ody   :É_ÉCÉiÉZÉbÉgèÓïÒç\ë¢ëÃ
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_Get_Data(ByRef Usr_Ody_LC As U_Ody) As Boolean

Dim strSQL          As String
Dim strWKRPTCLTID   As String
Dim strWKPRGID      As String
Dim strWKHINCD      As String
Dim strWKSBNNO      As String

On Error GoTo Errlabel:
    
    P_Get_Data = False
    
    strWKRPTCLTID = Left(L_strRPTCLTID & Space(5), 5)
    strWKPRGID = Left(L_strPRGID & Space(7), 7)
    strWKHINCD = Left(L_strHINCD & Space(10), 10)
    strWKSBNNO = Left(L_strSBNNO & Space(20), 20)
    
    'SQLï∂çÏê¨
    strSQL = ""
    strSQL = strSQL & vbCrLf & "Select"
    strSQL = strSQL & vbCrLf & " RPTCLTID"
    strSQL = strSQL & vbCrLf & " PRGID"
    strSQL = strSQL & vbCrLf & ",HINCD"
    strSQL = strSQL & vbCrLf & ",SBNNO"
    strSQL = strSQL & vbCrLf & ",SRALINNO"
    strSQL = strSQL & vbCrLf & ",SRANO"
    strSQL = strSQL & vbCrLf & ",LOCKBN"
    strSQL = strSQL & vbCrLf & ",ZAISYOBN"
    strSQL = strSQL & vbCrLf & ",CHKFLG"
    strSQL = strSQL & vbCrLf & ",WRTTM"
    strSQL = strSQL & vbCrLf & ",WRTDT"
    strSQL = strSQL & vbCrLf & " From   SRAET53"
    strSQL = strSQL & vbCrLf & " Where  RPTCLTID = " & "'" & StChk(strWKRPTCLTID) & "'"
    strSQL = strSQL & vbCrLf & "   And  PRGID    = " & "'" & StChk(strWKPRGID) & "'"
    strSQL = strSQL & vbCrLf & "   And  HINCD    = " & "'" & StChk(strWKHINCD) & "'"
    strSQL = strSQL & vbCrLf & "   And  SBNNO    = " & "'" & StChk(strWKSBNNO) & "'"    '2008/01/17 ADD
    strSQL = strSQL & vbCrLf & " Order By   SRALINNO"

    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR9, Usr_Ody_LC, strSQL)

    If CF_Ora_EOF(Usr_Ody_LC) = False Then
        'éÊìæÉfÅ[É^óL
        P_Get_Data = True
    End If
            
Exit Function
Errlabel:
    Call GP_MsgBox(Critical, "ÉfÅ[É^éÊìæéûÇ…ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB(P_Get_Data)" & vbCrLf & _
                Err.Number & ":" & Err.Description _
                , vbCritical + vbOKOnly)
End Function

'===========================================================================
'ÅyégópópìrÅz âÊñ ÉNÉäÉA
'Åyä÷ êî ñºÅz P_FromClear
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_FromClear()
    lblHIN1.Caption = ""
    lblHIN2.Caption = ""
    lblURISU.Caption = ""
    CM_EndCm.Picture = IM_EndCm(1).Picture
    CM_Execute.Picture = IM_Execute(1).Picture
    TX_Message = ""
End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhèâä˙âª
'Åyä÷ êî ñºÅz P_vaData_Init
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Sub P_vaData_Init()

    Dim lngI    As Long
    Dim lngLine As Long
    Dim intLen  As Integer

    lngI = 0
    lngLine = 0
    intLen = Len(CStr(LC_lngMAX_ROW))

    With vaData
        'ÉXÉvÉåÉbÉhÇÃÉNÉäÉA
        .ReDraw = False
        .Action = ActionClearText
        .MaxRows = LC_lngDEFAULT_ROW
        .Col = LC_lngCol_CHECK
        .Col2 = LC_lngCol_CHECK
        .Row = 1
        .Row2 = .MaxRows
        .CellType = CellTypeCheckBox
        .GridColor = &H0&
        .GridSolid = True
        .TypeCheckType = TypeCheckTypeNormal
        .TypeCheckCenter = True
        .TypeCheckText = ""
        Call SetEdit(vaData, LC_lngCol_SERIAL, 1)
        Call SetEdit(vaData, LC_lngCol_LOCKBN, 1)
        Call SetEdit(vaData, LC_lngCol_ZAISYOBN, 1)
        Call SetEdit(vaData, LC_lngCol_SBN, 1)
        Call SetEdit(vaData, LC_lngCol_HID_SERIAL, 1)
        'çsî‘çÜÇÉZÉbÉg
        For lngI = 0 To vaData.MaxRows
            lngLine = lngLine + 1
            Call .SetText(LC_lngCol_NO, lngLine, Right(Space(intLen) & CStr(lngLine), intLen))
            Call SetEdit(vaData, LC_lngCol_SERIAL, lngLine)
            Call SetEdit(vaData, LC_lngCol_LOCKBN, lngLine)
            Call SetEdit(vaData, LC_lngCol_ZAISYOBN, lngLine)
            Call SetEdit(vaData, LC_lngCol_SBN, lngLine)
            Call SetEdit(vaData, LC_lngCol_HID_SERIAL, lngLine)
        Next
        .ColsFrozen = LC_lngCol_SERIAL
        .ReDraw = True
    End With

    Call P_Va_BackColor
    Call P_Va_Lock
    
End Sub

'===========================================================================
'ÅyégópópìrÅz êªïiñºéÊìæ
'Åyä÷ êî ñºÅz P_GET_HINNMA
'Åyà¯    êîÅz ByVal strHINCD As String   :êªïiÉRÅ[Éh
'Åyà¯    êîÅz ByRef strHINNMA As String  :êªïiñº
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_GET_HINNMA(ByVal strHINCD As String, _
                              ByRef strHINNMA As String) As Boolean
    Dim strSQL      As String
    Dim Usr_Ody_LC  As U_Ody
    Dim strWKHINCD  As String

    P_GET_HINNMA = False
    
    'è§ïiÉRÅ[ÉhÇ10åÖÇ…Ç∑ÇÈ
    strWKHINCD = Left(strHINCD & Space(10), 10)

    'SQLï∂çÏê¨
    strSQL = vbNullString
    strSQL = strSQL & " SELECT  HINNMA "
    strSQL = strSQL & " FROM    HINMTA"
    strSQL = strSQL & " WHERE   HINCD = '" & strWKHINCD & "'"

    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody_LC, strSQL)

    If CF_Ora_EOF(Usr_Ody_LC) = False Then
        'éÊìæÉfÅ[É^óL
            strHINNMA = CF_Ora_GetDyn(Usr_Ody_LC, "HINNMA", "")
        P_GET_HINNMA = True
    End If

    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody_LC)

Exit Function
Errlabel:
    Call GP_MsgBox(Critical, "ÉfÅ[É^éÊìæéûÇ…ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB(P_SRANOCheck)" & vbCrLf & _
                Err.Number & ":" & Err.Description _
                , vbCritical + vbOKOnly)
End Function

'===========================================================================
'ÅyégópópìrÅz ÉVÉäÉAÉãáÇë∂ç›É`ÉFÉbÉNÅiä«óùÉeÅ[ÉuÉãÅj
'Åyä÷ êî ñºÅz P_SRANOCheck
'Åyà¯    êîÅz ByVal strSRANO As String  :ÉVÉäÉAÉãáÇ
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_SRANOCheck(ByVal strSRANO As String, _
                              ByRef strZAISYOBN As String) As Boolean

    Dim strSQL      As String
    Dim Usr_Ody_LC  As U_Ody
    Dim strWKSRANO   As String
    Dim strWKHINCD   As String

    P_SRANOCheck = False
    strZAISYOBN = ""
    
    strWKSRANO = Left(strSRANO & Space(13), 13)
    strWKHINCD = Left(L_strHINCD & Space(10), 10)

    'SQLï∂çÏê¨
    strSQL = vbNullString
    strSQL = strSQL & " SELECT  * " & vbCrLf
    strSQL = strSQL & " FROM    SRACNTTB" & vbCrLf
    strSQL = strSQL & " WHERE   SRANO    = '" & strWKSRANO & "'" & vbCrLf
    strSQL = strSQL & "   AND   HINCD    = '" & strWKHINCD & "'" & vbCrLf
    
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody_LC, strSQL)
    
    If CF_Ora_EOF(Usr_Ody_LC) = False Then
        'éÊìæÉfÅ[É^óL
        strZAISYOBN = CF_Ora_GetDyn(Usr_Ody_LC, "ZAISYOBN", "")
        
        P_SRANOCheck = True
    End If

    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody_LC)
    
Exit Function
Errlabel:
    Call GP_MsgBox(Critical, "ÉfÅ[É^éÊìæéûÇ…ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB(P_SRANOCheck)" & vbCrLf & _
                Err.Number & ":" & Err.Description _
                , vbCritical + vbOKOnly)
End Function

'===========================================================================
'ÅyégópópìrÅz ÉVÉäÉAÉãáÇë∂ç›É`ÉFÉbÉNÅiÉèÅ[ÉNÉtÉ@ÉCÉãÅj
'Åyä÷ êî ñºÅz P_SRANOCheckWK
'Åyà¯    êîÅz ByVal strSRANO As String  :ÉVÉäÉAÉãáÇ
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_SRANOCheckWK(ByVal strSRANO As String) As Boolean

    Dim strSQL      As String
    Dim Usr_Ody_LC  As U_Ody
    Dim strWKRPTCLTID   As String
    Dim strWKPRGID   As String
    Dim strWKHINCD   As String
    Dim strWKSRANO   As String
    Dim strWKSBNNO   As String

    P_SRANOCheckWK = False
    
    strWKRPTCLTID = Left(L_strRPTCLTID & Space(5), 5)
    strWKPRGID = Left(L_strPRGID & Space(7), 7)
    strWKHINCD = Left(L_strHINCD & Space(10), 10)
    strWKSRANO = Left(strSRANO & Space(13), 13)
    strWKSBNNO = Left(L_strSBNNO & Space(20), 20)   '2008/01/17 ADD

    'SQLï∂çÏê¨
    strSQL = vbNullString
    strSQL = strSQL & " SELECT  * "
    strSQL = strSQL & " FROM    SRAET53"
    strSQL = strSQL & " WHERE   RPTCLTID = '" & strWKRPTCLTID & "'"
    strSQL = strSQL & "   AND   PRGID    = '" & strWKPRGID & "'"
    strSQL = strSQL & "   AND   HINCD    = '" & strWKHINCD & "'"
    strSQL = strSQL & "   AND   SRANO    = '" & strWKSRANO & "'"
    strSQL = strSQL & "   AND   SBNNO    = '" & strWKSBNNO & "'"
    
    Call CF_Ora_CreateDyn(gv_Odb_USR9, Usr_Ody_LC, strSQL)

    If CF_Ora_EOF(Usr_Ody_LC) = True Then
        'éÊìæÉfÅ[É^óL
        P_SRANOCheckWK = True
    End If

    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody_LC)

Exit Function
Errlabel:
    Call GP_MsgBox(Critical, "ÉfÅ[É^éÊìæéûÇ…ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB(P_SRANOCheck)" & vbCrLf & _
                Err.Number & ":" & Err.Description _
                , vbCritical + vbOKOnly)
End Function

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhì¸óÕÉ`ÉFÉbÉNÅiÉÅÉCÉìÅj
'Åyä÷ êî ñºÅz P_EntryCheck
'Åyà¯    êîÅz ByRef lngEntryLine As Long  :óLå¯çsêî
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_EntryCheck(ByRef lngEntryLine As Long) As Boolean
    
    P_EntryCheck = False
    
    'NULLÉ`ÉFÉbÉNÅAÉVÉäÉAÉãáÇë∂ç›É`ÉFÉbÉNÅAÉVÉäÉAÉãáÇèdï°É`ÉFÉbÉN
    If P_NULLCheck(lngEntryLine) = False Then Exit Function
    
    P_EntryCheck = True

End Function

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhì¸óÕÉ`ÉFÉbÉNÅAÉVÉäÉAÉãáÇë∂ç›É`ÉFÉbÉN
'Åyä÷ êî ñºÅz P_NULLCheck
'Åyà¯    êîÅz ByRef lngEntryLine As Long  :óLå¯çsêî
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_NULLCheck(ByRef lngEntryLine As Long) As Boolean

    Dim lngI            As Long
    Dim lngJ            As Long
    Dim varCHECK        As Variant
    Dim varNO           As Variant
    Dim varSERIAL       As Variant
    Dim varSERIAL_C     As Variant
    Dim varTNANO        As Variant
    Dim strKBN          As String
    Dim msgMsgBox       As VbMsgBoxResult
    Dim strMSGKBN       As String
    Dim strMSGNM        As String
    Dim Mst_Inf         As TYPE_DB_SYSTBH
    Dim intRet          As Integer
    
    strMSGKBN = "1"
    lngEntryLine = 0
    
    P_NULLCheck = False

    'ÉfÅ[É^ì¸óÕç≈ëÂçsÇéÊìæ
    L_lngMAX_EditRow = P_Get_EditMaxRow

    For lngI = 1 To L_lngMAX_EditRow
        With vaData
            'ÉXÉvÉåÉbÉhÉfÅ[É^ÇéÊìæ
            Call .GetText(LC_lngCol_CHECK, lngI, varCHECK)
            Call .GetText(LC_lngCol_NO, lngI, varNO)
            Call .GetText(LC_lngCol_SERIAL, lngI, varSERIAL)
            If varCHECK = C_strCHECKBOX_ON Then
                If varSERIAL <> vbNullString Then
                    '* ÉVÉäÉAÉãáÇèdï°É`ÉFÉbÉN
                    lngJ = 1
                    For lngJ = 1 To L_lngMAX_EditRow
                        varSERIAL_C = ""
                        If lngI <> lngJ Then
                            Call .GetText(LC_lngCol_SERIAL, lngJ, varSERIAL_C)
                            If Nz(varSERIAL_C) <> "" Then
                                If varSERIAL = varSERIAL_C Then
                                    intRet = DSPMSGCM_SEARCH(strMSGKBN, LC_strPG_ID, DoubleSerialNo, Mst_Inf)
                                    If intRet <> 0 Then
                                        Call MsgBox("ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅBÉVÉXÉeÉÄÉÅÉbÉZÅ[ÉWÉeÅ[ÉuÉãÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbExclamation, LC_strTitle)
                                        Exit Function
                                    End If
                                    Call GP_MsgBox(Exclamation, Mst_Inf.MSGCM, LC_strTitle)
                                    If lngJ > 0 Then
                                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, lngJ, True)
                                        Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, lngJ)
                                    Else
                                        Call GP_Va_Col_EditColor(vaData, LC_lngCol_SERIAL, lngI, True)
                                        Call GP_SpActiveCell(vaData, LC_lngCol_SERIAL, lngI)
                                    End If
                                    Exit Function
                                End If
                            End If
                        End If
                    Next
                    lngEntryLine = lngEntryLine + 1
                End If
            End If
        End With
    Next lngI

    P_NULLCheck = True

End Function

'===========================================================================
'ÅyégópópìrÅz óLå¯çsÇÃç≈ëÂçsêîÇéÊìæ
'Åyä÷ êî ñºÅz P_Get_EditMaxRow
'Åyï‘    ílÅz Long
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_Get_EditMaxRow() As Long

    Dim lngI            As Long
    Dim lngLine         As Long
    Dim varCHECK        As Variant
    Dim varSERIAL       As Variant
    Dim varHIDSERIAL    As Variant

    P_Get_EditMaxRow = 0
    
    lngI = 1
    With vaData
        For lngI = 1 To .MaxRows
            lngLine = .MaxRows - lngI
            Call .GetText(LC_lngCol_CHECK, lngLine, varCHECK)
            Call .GetText(LC_lngCol_SERIAL, lngLine, varSERIAL)
            Call .GetText(LC_lngCol_HID_SERIAL, lngLine, varHIDSERIAL)
            If Nz(varSERIAL) <> "" Or Nz(varHIDSERIAL) <> "" Then
                P_Get_EditMaxRow = lngLine
                Exit For
            End If
        Next
    End With

End Function

'===========================================================================
'ÅyégópópìrÅz SQLï∂ê∂ê¨Åïî≠çs
'Åyä÷ êî ñºÅz P_EXECUTE_SQL
'Åyà¯    êîÅz ByVal strMode     As enumCREATE_MODE  :SQLê∂ê¨ÉÇÅ[Éh
'Åyà¯    êîÅz ByVal strSRALINNO As String           :âÊñ çsî‘çÜ
'Åyà¯    êîÅz ByVal strCHECK    As String           :É`ÉFÉbÉNÉ{ÉbÉNÉX
'Åyà¯    êîÅz ByVal strSRANO    As String           :ÉVÉäÉAÉãáÇ
'Åyà¯    êîÅz ByVal strLOCATION As String           :íIî‘
'Åyà¯    êîÅz ByVal strZAISYOBN As String           :ç›å…èàóùãÊï™
'Åyà¯    êîÅz ByVal strSBN      As String           :êªî‘ÉRÅ[Éh
'Åyà¯    êîÅz ByVal strWRTTM    As String           :ÉfÅ[É^çÏê¨éûä‘
'Åyà¯    êîÅz ByVal strWRTDT    As String           :ÉfÅ[É^çÏê¨ì˙ït
'Åyï‘    ílÅz Boolean
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Private Function P_EXECUTE_SQL(ByVal strMode As enumCREATE_MODE, _
                               ByVal strSRALINNO As String, _
                               ByVal strCHECK As String, _
                               ByVal strSRANO As String, _
                               ByVal strZAISYOBN As String, _
                               ByVal strSBN As String, _
                               ByVal strWRTTM As String, _
                               ByVal strWRTDT As String) As Boolean
    Dim strSQL As String
    Dim strCHK As String
    Dim strKBN As String
    
    P_EXECUTE_SQL = False
    
    strSQL = vbNullString
    
    'É`ÉFÉbÉNÉtÉâÉOîªíË
    If strCHECK = C_strCHECKBOX_ON Then
        strCHECK = C_strCHECKBOX_ON
    Else
        strCHECK = C_strCHECKBOX_OFF
    End If
    
    'ç›å…èàóùãÊï™îªíË
    If Trim(strZAISYOBN) <> "" Then
        strKBN = strZAISYOBN
    Else
        strKBN = LC_strNOT_SYUKA
    End If

    Select Case strMode
        Case Insert
            strSQL = strSQL & " INSERT INTO SRAET53 (" & vbCrLf
            strSQL = strSQL & "                      RPTCLTID," & vbCrLf
            strSQL = strSQL & "                      PRGID," & vbCrLf
            strSQL = strSQL & "                      HINCD," & vbCrLf
            strSQL = strSQL & "                      SBNNO," & vbCrLf
            strSQL = strSQL & "                      SRALINNO," & vbCrLf
            strSQL = strSQL & "                      SRANO," & vbCrLf
            strSQL = strSQL & "                      LOCKBN," & vbCrLf
            strSQL = strSQL & "                      CHKFLG, " & vbCrLf
            strSQL = strSQL & "                      ZAISYOBN, " & vbCrLf
            strSQL = strSQL & "                      WRTTM," & vbCrLf
            strSQL = strSQL & "                      WRTDT" & vbCrLf
            strSQL = strSQL & "                     )" & vbCrLf
            strSQL = strSQL & " VALUES  (" & vbCrLf
            strSQL = strSQL & "          '" & StChk(L_strRPTCLTID) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(L_strPRGID) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(L_strHINCD) & "'," & vbCrLf
''            strSQL = strSQL & "          '" & Space(20) & "'," & vbCrLf
''            strSQL = strSQL & "          '" & StChk(strSBN) & "'," & vbCrLf       '2008/01/17 UPD-DEL
            strSQL = strSQL & "          '" & StChk(L_strSBNNO) & "'," & vbCrLf     '2008/01/17 UPD-ADD
            strSQL = strSQL & "          '" & StChk(strSRALINNO) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(strSRANO) & "'," & vbCrLf
            strSQL = strSQL & "          '" & LC_strLINE_NOT_LOCK & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(strCHECK) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(strKBN) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(strWRTTM) & "'," & vbCrLf
            strSQL = strSQL & "          '" & StChk(strWRTDT) & "'" & vbCrLf
            strSQL = strSQL & "         )" & vbCrLf

        Case Update
            strSQL = strSQL & " UPDATE SRAET53" & vbCrLf
            strSQL = strSQL & "   SET  SRANO    = '" & StChk(strSRANO) & "'" & vbCrLf
            strSQL = strSQL & "       ,CHKFLG   = '" & StChk(strCHECK) & "'" & vbCrLf
            strSQL = strSQL & "       ,WRTTM    = '" & StChk(strWRTTM) & "'" & vbCrLf
            strSQL = strSQL & "       ,WRTDT    = '" & StChk(strWRTDT) & "'" & vbCrLf
            strSQL = strSQL & " WHERE  RPTCLTID = '" & StChk(L_strRPTCLTID) & "'" & vbCrLf
            strSQL = strSQL & "   AND  PRGID    = '" & StChk(L_strPRGID) & "'" & vbCrLf
            strSQL = strSQL & "   AND  HINCD    = '" & StChk(L_strHINCD) & "'" & vbCrLf
            strSQL = strSQL & "   AND  SBNNO    = '" & StChk(L_strSBNNO) & "'" & vbCrLf     '2008/01/17 ïúäà
            strSQL = strSQL & "   AND  SRALINNO = '" & Format(strSRALINNO, "000000") & "'" & vbCrLf

        Case Delete
            strSQL = strSQL & " DELETE FROM SRAET53" & vbCrLf
            strSQL = strSQL & " WHERE  RPTCLTID = '" & StChk(L_strRPTCLTID) & "'" & vbCrLf
            strSQL = strSQL & "   AND  PRGID    = '" & StChk(L_strPRGID) & "'" & vbCrLf
            strSQL = strSQL & "   AND  HINCD    = '" & StChk(L_strHINCD) & "'" & vbCrLf
            strSQL = strSQL & "   AND  SBNNO    = '" & StChk(L_strSBNNO) & "'" & vbCrLf     '2008/01/17 ïúäà
            strSQL = strSQL & "   AND  SRALINNO = '" & Format(strSRALINNO, "000000") & "'" & vbCrLf

    End Select
    
    'SQLÇî≠çsÇ∑ÇÈ
    If CF_Ora_Execute(gv_Odb_USR9, strSQL) = False Then
        Exit Function
    End If
        
    P_EXECUTE_SQL = True

End Function

'=======================================================================================
'ÅyégópópìrÅz ÉfÅ[É^ìoò^èàóùÅiÉÅÉCÉìÅj
'Åyä÷ êî ñºÅz P_Main
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'=======================================================================================
Private Function P_Main() As Boolean

    Dim lngI            As Long
    Dim lngLineNo       As Long
    Dim strSQL          As String
    Dim varCHECK        As Variant
    Dim varNO           As Variant
    Dim varSERIAL       As Variant
    Dim varLOCKBN       As Variant
    Dim varZAISYOBN     As Variant
    Dim varSBN          As Variant
    Dim varHIDSERIAL    As Variant
    Dim datNOW          As Date
    Dim intCnt          As Integer
    Dim intMaxKeta      As Integer
    Dim strZero         As String
    Dim strCREATE_MODE  As enumCREATE_MODE

    P_Main = False
    
    'BEGIN TRAN
    If CF_Ora_BeginTrans(gv_Oss_USR9) = False Then
        GoTo EndLbl:
    End If
    
    'ìoò^ì˙éûÇê∂ê¨
    datNOW = Now
    L_strWRTTM = Format(datNOW, "HHMMSS")
    L_strWRTDT = Format(datNOW, "YYYYMMDD")
    
    'çsî‘çÜópZEROï∂éöÇê›íË
    intCnt = 0
    intMaxKeta = Len(CStr(LC_lngMAX_ROW))
    For intCnt = 0 To intMaxKeta - 1
        strZero = strZero & "0"
    Next

    'ÉfÅ[É^ìoò^
    lngI = 0
    lngLineNo = 0
    For lngI = 1 To L_lngMAX_EditRow
        With vaData
            Call .GetText(LC_lngCol_CHECK, lngI, varCHECK)
            Call .GetText(LC_lngCol_NO, lngI, varNO)
            Call .GetText(LC_lngCol_SERIAL, lngI, varSERIAL)
            Call .GetText(LC_lngCol_LOCKBN, lngI, varLOCKBN)
            Call .GetText(LC_lngCol_ZAISYOBN, lngI, varZAISYOBN)
            Call .GetText(LC_lngCol_SBN, lngI, varSBN)
            Call .GetText(LC_lngCol_HID_SERIAL, lngI, varHIDSERIAL)
            If Nz(varSERIAL) <> "" Then
                lngLineNo = lngLineNo + 1
                ' èàóùãÊï™îªíËÇ∑ÇÈ
                If varLOCKBN = LC_strLINE_LOCK Then
                    strCREATE_MODE = Update
                Else
                    'éËì¸óÕçs
                    If P_SRANOCheckWK(CStr(varSERIAL)) = False Then
                        strCREATE_MODE = Update
                    Else
                        strCREATE_MODE = Insert
                    End If
                End If
                
                If P_EXECUTE_SQL(strCREATE_MODE, _
                                 Format(lngLineNo, strZero), _
                                 CStr(varCHECK), _
                                 CStr(varSERIAL), _
                                 CStr(varZAISYOBN), _
                                 CStr(varSBN), _
                                 L_strWRTTM, _
                                 L_strWRTDT) = False Then
                    GoTo EndLbl:
                End If
            Else
                lngLineNo = lngLineNo + 1
                If Nz(varHIDSERIAL) <> "" Then
                    strCREATE_MODE = Delete
                    If P_EXECUTE_SQL(strCREATE_MODE, _
                                     Format(lngLineNo, strZero), _
                                     CStr(varCHECK), _
                                     CStr(varSERIAL), _
                                     CStr(varZAISYOBN), _
                                     CStr(varSBN), _
                                     L_strWRTTM, _
                                     L_strWRTDT) = False Then
                        GoTo EndLbl:
                    End If
                End If
            End If
        End With
    Next lngI

    'COMMIT
    Call CF_Ora_CommitTrans(gv_Oss_USR9)
    
    P_Main = True
    
    Exit Function
    
    GoTo EndLbl:
ErrLbl:
    'ÉçÅ[ÉãÉoÉbÉN
    Call CF_Ora_RollbackTrans(gv_Oss_USR9)
EndLbl:

End Function

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÇÃóÒÇÃÉçÉbÉNêFê›íËÅB
'Åyä÷ êî ñºÅz GP_Va_Col_LockColor
'Åyà¯    êîÅz ByRef objSpread As ObjectÅFÉXÉvÉåÉbÉh
'Åyà¯    êîÅz ByVal lngCol As longÅFóÒî‘çÜ
'Åyï‘    ílÅz
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Public Sub GP_Va_Col_LockColor(ByRef objSpread As Object, ByVal lngCol As Long)

    'ÉXÉvÉåÉbÉhÇÃîwåiêFÇÃê›íËÅB
    With objSpread
        .ReDraw = False
        .Row = 1
        .Col = lngCol
        .Row2 = .MaxRows
        .Col2 = lngCol
        .BlockMode = True
        .BackColor = LC_lng_va_Lock_Color
        .BlockMode = False
        .ReDraw = True
    End With

End Sub

'===========================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÇÃóÒÇÃÉçÉbÉNêFê›íËÅB
'Åyä÷ êî ñºÅz GP_Va_Col_LockColor_Row
'Åyà¯    êîÅz ByRef objSpread As ObjectÅFÉXÉvÉåÉbÉh
'Åyà¯    êîÅz ByVal lngRow As LongÅFçsî‘çÜ
'Åyï‘    ílÅz
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'===========================================================================
Public Sub GP_Va_Col_LockColor_Row(ByRef objSpread As Object, ByVal lngRow As Long)

    'ÉXÉvÉåÉbÉhÇÃîwåiêFÇÃê›íËÅB
    With objSpread
        .ReDraw = False
        .Row = lngRow
        .Col = LC_lngCol_NO
        .Row2 = lngRow
        .Col2 = LC_lngCol_SERIAL
        .BlockMode = True
        .BackColor = Me.BackColor
        .BlockMode = False
        .ReDraw = True
    End With

End Sub

'=======================================================================================
'ÅyégópópìrÅz ÉXÉvÉåÉbÉhÇÃóÒÇÃï“èWíÜêFê›íËãyÇ—âèúÅB
'Åyä÷ êî ñºÅz GP_Va_Col_EditColor
'Åyà¯    êîÅz ByRef objSpread As ObjectÅFÉXÉvÉåÉbÉh
'Åyà¯    êîÅz ByVal lngCol As longÅFóÒî‘çÜ
'Åyà¯    êîÅz ByVal lngRow As longÅFçsî‘çÜ
'Åyà¯    êîÅz ByVal bolEdit As BooleanÅFï“èWíÜÇÃèÍçáTRUEÅFï“èWíÜÇ©ÇÁî≤ÇØÇÈÇ∆Ç´Ç…ÇÕFalse
'Åyï‘    ílÅz
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'=======================================================================================
Public Sub GP_Va_Col_EditColor(ByRef objSpread As Object, _
                               ByVal lngCol As Long, _
                               ByVal lngRow As Long, _
                               ByVal bolEdit As Boolean, _
                               Optional ByVal lngCol2 As Long = 0, _
                               Optional ByVal lngRow2 As Long = 0)

    Dim varZAISYOBN As Variant
    Dim lngI        As Long

    'ÉXÉvÉåÉbÉhÇÃîwåiêFÇÃê›íËÅB
    With objSpread
        .ReDraw = False
        .Row = lngRow
        .Col = lngCol
        .BlockMode = True
        If bolEdit Then
            .Row2 = lngRow
            .Col2 = lngCol
            .BackColor = LC_lng_va_Edit_Color
        Else
            If lngRow2 <> 0 Then
                .Row2 = lngRow2
            Else
                .Row2 = lngRow
            End If
            If lngCol2 <> 0 Then
                .Col2 = lngCol2
            Else
                .Col2 = lngCol
            End If
            .BackColor = vbWhite
        End If
        .BlockMode = False
        .ReDraw = True
    End With

    With objSpread
        .ReDraw = False
        .Row = lngRow
        .Col = LC_lngCol_NO
        If lngRow2 <> 0 Then
            .Row2 = lngRow2
        Else
            .Row2 = lngRow
        End If
        .Col2 = LC_lngCol_NO
        .BlockMode = True
        .BackColor = Me.BackColor
        .BlockMode = False
        .ReDraw = True
    End With

End Sub

'=======================================================================================
'ÅyégópópìrÅz ÉeÉLÉXÉgçÄñ⁄Çê›íË
'Åyä÷ êî ñºÅz SetEdit
'Åyà¯    êîÅz ByRef objSpread   As ObjectÅFÉXÉvÉåÉbÉh
'Åyà¯    êîÅz ByVal lngCol      As long  ÅFóÒî‘çÜ
'Åyà¯    êîÅz ByVal lngRow      As long  ÅFçsî‘çÜ
'Åyï‘    ílÅz
'ÅyçX êV ì˙Åz
'Åyîı    çlÅz
'=======================================================================================
Private Sub SetEdit(ByRef objSpread As Object, _
                    ByVal lngCol As Long, _
                    ByVal lngRow As Long)
    With vaData
        .ReDraw = False
        .Col = lngCol
        .Col2 = lngCol
        .Row = lngRow
        .Row2 = lngRow
        .GridSolid = True
        .GridColor = &H0&
        .FontSize = 12
        If lngCol = LC_lngCol_CHECK Then
            .Col = LC_lngCol_CHECK
            .Col2 = LC_lngCol_CHECK
            .Row = lngRow
            .Row2 = lngRow
            .CellType = CellTypeCheckBox
            .TypeCheckType = TypeCheckTypeNormal
            .TypeCheckCenter = True
            .TypeCheckText = ""
        Else
            .CellType = CellTypeEdit                        'ï∂éöì¸óÕ
            .TypeEditCharSet = TypeEditCharSetAlphanumeric  'îºäpâpêîéö
            .Position = PositionCenterLeft
        End If
        'ì¸óÕåÖêîÇÉZÉbÉg
        Select Case lngCol
            Case LC_lngCol_SERIAL: .TypeMaxEditLen = C_lngSERIAL_Len
        End Select
        .ReDraw = True
    End With
End Sub

Private Sub vaData_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)

    Dim varLOCKBN As Variant

    With vaData
        Call .GetText(LC_lngCol_LOCKBN, .ActiveRow, varLOCKBN)
        
        If varLOCKBN = LC_strLINE_NOT_LOCK Then
            Call GP_Va_Col_EditColor(vaData, LC_lngCol_CHECK, .ActiveRow, True)
            Call GP_SpActiveCell(vaData, LC_lngCol_CHECK, .ActiveRow)
        End If
    End With

End Sub

Private Sub vaData_Validate(Cancel As Boolean)
    L_lngMAX_EditRow = P_Get_EditMaxRow
End Sub

Private Sub F_SendKey(ByVal KeyCode As Integer)
    Select Case KeyCode
        Case vbKeyF1: SendKeys "%1"
        Case vbKeyF2: SendKeys "%2"
    End Select
End Sub
'=========================================================================Åy ÉÅÉ\ÉbÉh Åz=

