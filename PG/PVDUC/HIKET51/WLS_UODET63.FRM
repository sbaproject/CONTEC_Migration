VERSION 5.00
Object = "{0D181820-63E5-11D1-8959-E995CE93D831}#2.3#0"; "Threed5.ocx"
Begin VB.Form WLS_UODET63 
   Appearance      =   0  'Ã◊Øƒ
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'å≈íË¿ﬁ≤±€∏ﬁ
   Caption         =   "éÛíçì`ï[åüçı"
   ClientHeight    =   5775
   ClientLeft      =   165
   ClientTop       =   2355
   ClientWidth     =   13695
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   5775
   ScaleWidth      =   13695
   Begin Threed5.SSPanel5 WLSLABEL 
      Height          =   330
      Left            =   45
      TabIndex        =   16
      Top             =   1185
      Width           =   13590
      _ExtentX        =   23971
      _ExtentY        =   582
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   1
      BevelOuter      =   1
      Caption         =   "éÛíçî‘çÜ  éÛíçéÊãÊ  éÛíçì˙ït   ìæà”êÊ                                   åèñº"
      OutLine         =   -1  'True
      RoundedCorners  =   0   'False
   End
   Begin VB.ListBox LST 
      Height          =   3660
      ItemData        =   "WLS_UODET63.frx":0000
      Left            =   45
      List            =   "WLS_UODET63.frx":0043
      TabIndex        =   17
      Top             =   1485
      Width           =   13575
   End
   Begin VB.ListBox KEYBAK 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   5070
      Left            =   14700
      TabIndex        =   19
      Top             =   720
      Visible         =   0   'False
      Width           =   300
   End
   Begin VB.CommandButton WLSOK 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      Caption         =   "OK"
      Height          =   330
      Left            =   5820
      TabIndex        =   18
      Top             =   5310
      Width           =   1095
   End
   Begin VB.CommandButton WLSCANCEL 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      Caption         =   "∑¨›æŸ"
      Height          =   330
      Left            =   6900
      TabIndex        =   20
      Top             =   5310
      Width           =   1095
   End
   Begin Threed5.SSPanel5 Panel3D1 
      Height          =   1020
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   13710
      _ExtentX        =   24183
      _ExtentY        =   1799
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
      Begin VB.TextBox HD_JDNTRKBNM 
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   375
         Left            =   9750
         TabIndex        =   8
         Text            =   "MMMMMMMMM1"
         Top             =   60
         Width           =   1335
      End
      Begin VB.TextBox HD_TANNM 
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   375
         Left            =   2415
         TabIndex        =   3
         Text            =   "MMMMMMMMM1MMMMMMMMM2"
         Top             =   60
         Width           =   2490
      End
      Begin VB.TextBox HD_JDNTRKB 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Left            =   9405
         TabIndex        =   7
         Text            =   "99"
         Top             =   60
         Width           =   360
      End
      Begin VB.TextBox HD_JDNDT 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Left            =   1605
         TabIndex        =   10
         Text            =   "9999/99/99"
         Top             =   540
         Width           =   1305
      End
      Begin VB.TextBox HD_KENNMA 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
         Left            =   9405
         TabIndex        =   15
         Text            =   "MMMMMMMMM1MMMMMMMMM2MMMMMMMMM4"
         Top             =   540
         Width           =   4185
      End
      Begin VB.TextBox HD_TOKCD 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   2  'µÃ
         Left            =   6840
         TabIndex        =   13
         Text            =   "XXXX5"
         Top             =   540
         Width           =   705
      End
      Begin VB.TextBox HD_TANCD 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Left            =   1605
         TabIndex        =   2
         Text            =   "XXXXX6"
         Top             =   60
         Width           =   825
      End
      Begin VB.TextBox HD_JDNNO 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Left            =   6840
         TabIndex        =   5
         Text            =   "XXXXXXX8"
         Top             =   60
         Width           =   1050
      End
      Begin Threed5.SSPanel5 FM_Panel3D1 
         Height          =   375
         Index           =   0
         Left            =   5265
         TabIndex        =   4
         Top             =   60
         Width           =   1590
         _ExtentX        =   2805
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "äJénéÛíçî‘çÜ"
         OutLine         =   -1  'True
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSPanel5 FM_Panel3D1 
         Height          =   375
         Index           =   1
         Left            =   8265
         TabIndex        =   14
         Top             =   540
         Width           =   1155
         _ExtentX        =   2037
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "åèñºÅ@Å@"
         OutLine         =   -1  'True
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSCommand5 CS_TANCD 
         Height          =   375
         Left            =   135
         TabIndex        =   1
         TabStop         =   0   'False
         Top             =   60
         Width           =   1485
         _ExtentX        =   2619
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "âcã∆íSìñé“"
         BevelWidth      =   1
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSCommand5 CS_JDNDT 
         Height          =   375
         Left            =   135
         TabIndex        =   9
         TabStop         =   0   'False
         Top             =   540
         Width           =   1485
         _ExtentX        =   2619
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "éÛíçì˙ït   "
         BevelWidth      =   1
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSCommand5 CS_TOKCD 
         Height          =   375
         Left            =   5265
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   540
         Width           =   1590
         _ExtentX        =   2805
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "ìæà”êÊ       "
         BevelWidth      =   1
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSCommand5 CS_JDNTRKB 
         Height          =   375
         Left            =   8250
         TabIndex        =   6
         TabStop         =   0   'False
         Top             =   60
         Width           =   1170
         _ExtentX        =   2064
         _ExtentY        =   661
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "éÛíçéÊãÊ"
         BevelWidth      =   1
         RoundedCorners  =   0   'False
      End
      Begin VB.Label Label2 
         Caption         =   "à»ç~"
         Height          =   300
         Left            =   2970
         TabIndex        =   11
         Top             =   600
         Width           =   645
      End
   End
   Begin VB.Image IM_PrevCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   0
      Left            =   5910
      Picture         =   "WLS_UODET63.frx":011F
      Top             =   7500
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_NextCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   0
      Left            =   6810
      Picture         =   "WLS_UODET63.frx":0771
      Top             =   7500
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_NextCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   1
      Left            =   7215
      Picture         =   "WLS_UODET63.frx":0DC3
      Top             =   7500
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_PrevCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   1
      Left            =   6315
      Picture         =   "WLS_UODET63.frx":1415
      Top             =   7500
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image CM_PrevCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Left            =   5280
      Picture         =   "WLS_UODET63.frx":1A67
      Top             =   5310
      Width           =   360
   End
   Begin VB.Image CM_NextCm 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Left            =   8160
      Picture         =   "WLS_UODET63.frx":20B9
      Top             =   5310
      Width           =   360
   End
End
Attribute VB_Name = "WLS_UODET63"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

'********************************************************************************
'*  ÉVÉXÉeÉÄñºÅ@Å@Å@ÅF  êVëççáèÓïÒÉVÉXÉeÉÄ
'*  ÉTÉuÉVÉXÉeÉÄñºÅ@ÅFÅ@îÃîÑÉVÉXÉeÉÄ
'*  ã@î\Å@Å@Å@Å@Å@Å@ÅFÅ@åüçıÉEÉBÉìÉhÉE
'*  ÉvÉçÉOÉâÉÄñºÅ@Å@ÅFÅ@éÛíçèÓïÒåüçı
'*  ÉvÉçÉOÉâÉÄÇhÇcÅ@ÅF  WLS_UODET63
'*  çÏê¨é“Å@Å@Å@Å@Å@ÅFÅ@ACE)å√êÏ
'*  çÏê¨ì˙Å@Å@Å@Å@Å@ÅF  2006.07.28
'*-------------------------------------------------------------------------------
'*<01> YYYY.MM.DDÅ@ÅFÅ@èCê≥èÓïÒ
'*     èCê≥é“
'********************************************************************************

'************************************************************************************
'   ç\ë¢ëÃ
'************************************************************************************
    Private Type Type_DB_JDNTHA_W
        JDNNO       As String       'éÛíçî‘çÜ
        JDNTRKB     As String       'éÛíçéÊà¯ãÊï™
        JDNTRKBNM   As String       'éÛíçéÊà¯ãÊï™ñº
        JDNDT       As String       'éÛíçì`ï[ì˙ït
        DENDT       As String       'éÛíçì˙ït
        TOKRN       As String       'ìæà”êÊó™èÃ
        KENNMA      As String       'åèñºÇP
        KENNMB      As String       'åèñºÇQ
    End Type
'************************************************************************************
'   PrivateíËêî
'************************************************************************************
    Private Const FM_PANEL3D1_CNT       As Integer = 2      'ÉpÉlÉãÉRÉìÉgÉçÅ[Éãêî
    Private Const pc_intCntListRow      As Integer = 15     'ñæç◊çsêî

'************************************************************************************
'   Privateïœêî
'************************************************************************************
'=== ìñâÊñ ÇÃëSèÓïÒÇäiî[ =================
    Private Main_Inf    As Cls_All
'=== ìñâÊñ ÇÃëSèÓïÒÇäiî[ =================

    Private pv_DB_JDNTHA_W          As Type_DB_JDNTHA_W
    
    Private Usr_Ody                 As U_Ody        '√ﬁ∞¿Õﬁ∞ΩèÓïÒ√∞ÃﬁŸ
    Private Dyn_Open                As Boolean      'É_ÉCÉiÉZÉbÉgèÛë‘ÅiTrue:Open False:Close)
    Private pv_strInit_JDNTRKB      As String       'éÛíçéÊà¯ãÊï™
    Private WM_WLS_MAX              As Integer      'ÉäÉXÉgçsêî
    Private WM_WLS_Pagecnt          As Integer      'ÉEÉBÉìÉhï\é¶ÉyÅ[ÉWÉJÉEÉìÉ^
    Private WM_WLS_LastPage         As Integer      'ÉEÉBÉìÉhç≈èIÉyÅ[ÉW
    Private WM_WLS_LastFL           As Boolean      'ÉEÉBÉìÉhç≈èIÉfÅ[É^ìûíBÉtÉâÉO
    Private WM_WLS_DSPArray()       As String       'ÉEÉBÉìÉhï\é¶ÉfÅ[É^
    Private WM_WLS_Dspflg           As Integer      'ÉEÉBÉìÉhï\é¶Ã◊∏ﬁ(True or False)

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Init_Def_Dsp
    '   äTóvÅF  äeâÊñ ÇÃçÄñ⁄èÓïÒÇê›íË
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Init_Def_Dsp() As Integer

    Dim Index_Wk        As Integer
    Dim BD_Cnt          As Integer
    Dim Wk_Cnt          As Integer

    'âÊñ äÓëbã§í èÓïÒê›íË
    Call CF_Init_Def_Dsp(Me, Main_Inf)

    '/////////////////////
    '// ÉÅÉbÉZÅ[ÉWã§í ê›íË
    '/////////////////////

'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    'âÊñ äÓëbèÓïÒê›íË
    With Main_Inf.Dsp_Base
        .Dsp_Ctg = DSP_CTG_REFERENCE                'âÊñ ï™óﬁ
' === 20060921 === UPDATE S - ACE)Sejima
'D        .Item_Cnt = 18                              'âÊñ çÄñ⁄êî
' === 20060921 === UPDATE Å´
        .Item_Cnt = 20                              'âÊñ çÄñ⁄êî
' === 20060921 === UPDATE E
        .Dsp_Body_Cnt = 0                           'âÊñ ï\é¶ñæç◊êîÅiÇOÅFñæç◊Ç»ÇµÅAÇPÅ`ÅFï\é¶éûñæç◊êîÅj
        .Max_Body_Cnt = 0                           'ç≈ëÂï\é¶ñæç◊êîÅiÇOÅFñæç◊Ç»ÇµÅAÇPÅ`ÅFç≈ëÂñæç◊êîÅj
        .Body_Col_Cnt = 0                           'ñæç◊ÇÃóÒçÄñ⁄êî
        .Dsp_Body_Move_Qty = 0                      'âÊñ à⁄ìÆó 
' === 20060920 === INSERT S - ACE)Hashiri  MsgBoxÇÃDoEventsëŒâû
        Set .FormCtl = WLS_UODET63
' === 20060920 === INSERT E
    End With
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd
    
    'âÊñ çÄñ⁄èÓïÒ
    ReDim Main_Inf.Dsp_Sub_Inf(Main_Inf.Dsp_Base.Item_Cnt)

'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    '/////////////////////
    '// ëSâÊñ ópêßå‰óp∫›ƒ€∞Ÿ
    '/////////////////////

    Index_Wk = 0

    '///////////////////
    '// ÉwÉbÉ_ïîï“èW
    '///////////////////
    'íSìñé“É{É^Éì
    CS_TANCD.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CS_TANCD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'íSìñé“(∫∞ƒﬁ)
    HD_TANCD.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_TANCD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_CODE
' === 20070206 === UPDATE S - ACE)Nagasawa CapsLockì¸óÕëŒâû
'    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_X
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_XA
' === 20070206 === UPDATE E -
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 6
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 6
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

    Index_Wk = Index_Wk + 1
    'íSìñé“(ñºèÃ)
    HD_TANNM.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_TANNM
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_STR
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_NX
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 40
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 40
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'éÛíçî‘çÜ
    HD_JDNNO.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_JDNNO
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_CODE
' === 20061127 === UPDATE S - ACE)Nagasawa ÉRÅ[ÉhÇÃëÂï∂éöïœä∑èàóùí«â¡
'    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_X
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_XA
' === 20061127 === UPDATE E -
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 6
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 6
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_PLUS
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(6)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

    Index_Wk = Index_Wk + 1
    'éÛíçéÊà¯ãÊï™É{É^Éì
    CS_JDNTRKB.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CS_JDNTRKB
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'éÛíçéÊà¯ãÊï™
    HD_JDNTRKB.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_JDNTRKB
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_CODE
' === 20070206 === UPDATE S - ACE)Nagasawa CapsLockì¸óÕëŒâû
'    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_X
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_XA
' === 20070206 === UPDATE E -
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 2
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 2
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

    Index_Wk = Index_Wk + 1
    'éÛíçéÊà¯ãÊï™(ñºèÃ)
    HD_JDNTRKBNM.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_JDNTRKBNM
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_STR
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_NX
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 10
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 10
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'éÛíçì˙É{É^Éì
    CS_JDNDT.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CS_JDNDT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'éÛíçì˙
    HD_JDNDT.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_JDNDT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_DATE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_NUM
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 10
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 10
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = DSP_FMT_DATE_SLASH
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

    Index_Wk = Index_Wk + 1
    'ìæà”êÊ(∫∞ƒﬁ)É{É^Éì
    CS_TOKCD.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CS_TOKCD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True

    Index_Wk = Index_Wk + 1
    'ìæà”êÊ(∫∞ƒﬁ)
    HD_TOKCD.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_TOKCD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_CODE
' === 20070206 === UPDATE S - ACE)Nagasawa CapsLockì¸óÕëŒâû
'    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_X
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_XA
' === 20070206 === UPDATE E -
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 5
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 5
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

    Index_Wk = Index_Wk + 1
    'åèñºÇP
    HD_KENNMA.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = HD_KENNMA
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_STR
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_NX
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 40
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 40
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False

' === 20060921 === INSERT S - ACE)Sejima
    Index_Wk = Index_Wk + 1
    'ÉäÉXÉgå©èoÇµ
    WLSLABEL.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = WLSLABEL
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
' === 20060921 === INSERT E
    
    Index_Wk = Index_Wk + 1
    'ÉäÉXÉg
    LST.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = LST
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = Space(1)
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_RIGHT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = True
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = False
    
    Index_Wk = Index_Wk + 1
    'ëOÉyÅ[ÉWÉCÉÅÅ[ÉW
    CM_PrevCm.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CM_PrevCm
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_MN
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
    '=== ≤“∞ºﬁê›íË ======================
    Set Main_Inf.IM_PrevCm_Inf.Click_Off_Img = IM_PrevCm(0)
    Set Main_Inf.IM_PrevCm_Inf.Click_On_Img = IM_PrevCm(1)
    '=== ≤“∞ºﬁê›íË ======================
    
    Index_Wk = Index_Wk + 1
    'OKÉ{É^Éì
    WLSOK.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = WLSOK
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
    
    Index_Wk = Index_Wk + 1
    'ÉLÉÉÉìÉZÉãÉ{É^Éì
    WLSCANCEL.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = WLSCANCEL
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
    
    Index_Wk = Index_Wk + 1
    'éüÉyÅ[ÉWÉCÉÅÅ[ÉW
    CM_NextCm.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = CM_NextCm
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_MN
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
    '=== ≤“∞ºﬁê›íË ======================
    Set Main_Inf.IM_NextCm_Inf.Click_Off_Img = IM_NextCm(0)
    Set Main_Inf.IM_NextCm_Inf.Click_On_Img = IM_NextCm(1)
    '=== ≤“∞ºﬁê›íË ======================
    
    'âÊñ äÓëbèÓïÒê›íË
    Main_Inf.Dsp_Base.Head_Lst_Idx = Index_Wk      'ÉwÉbÉ_ïîÇÃç≈èIÇÃçÄñ⁄ÇÃ≤›√ﬁØ∏Ω
    Main_Inf.Dsp_Base.Foot_Fst_Idx = Index_Wk      'ÉtÉbÉ^ïîÇÃç≈èâÇÃçÄñ⁄ÇÃ≤›√ﬁØ∏Ω

    '///////////////////
    '// ÇªÇÃëºï“èW
    '///////////////////
    For Wk_Cnt = 0 To FM_PANEL3D1_CNT - 1
        Index_Wk = Index_Wk + 1
        'FM_Panel3D1
        FM_Panel3D1(Wk_Cnt).Tag = Index_Wk
        Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = FM_Panel3D1(Wk_Cnt)
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_ELSE
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
        Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
    Next

' === 20060922 === INSERT S - ACE)Sejima
    Index_Wk = Index_Wk + 1
    'ÉwÉbÉ_ÉpÉlÉã
    Panel3D1.Tag = Index_Wk
    Set Main_Inf.Dsp_Sub_Inf(Index_Wk).Ctl = Panel3D1
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Area = IN_AREA_DSP_HD
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Typ = IN_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.In_Str_Typ = IN_STR_TYP_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_MaxLengthB = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Int_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Fra_Fig = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Num_Sign_Fig = IN_NUM_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Chr = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Fil_Point = FIL_POINT_ELSE
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Dsp_Fmt = ""
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Body_Index = 0
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Focus_Ctl = False
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Err_Status = ERR_NOT
    Main_Inf.Dsp_Sub_Inf(Index_Wk).Detail.Locked = True
' === 20060922 === INSERT E
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd

    'è„ãLê›íËì‡óeÇé¿ç€ÇÃ∫›ƒ€∞ŸÇ…ê›íËÇ∑ÇÈ
    Call CF_Init_Item_Property(Main_Inf)
    'âÊñ çÄñ⁄èÓïÒÇçƒê›íË
    Call CF_ReSet_Dsp_Sub_Inf(Main_Inf)

    '///////////////////
    '// ì¡ï çÄñ⁄ÇÃçƒê›íË
    '///////////////////

'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    'ÉäÉXÉgçsêîÇÃê›íË
    WM_WLS_MAX = pc_intCntListRow
    
    'ï‘ÇËílÇÃê›íË
    WLSJDN_RTNJDNNO = ""
    
    'éÛíçéÊà¯ãÊï™ÇÃèâä˙ílê›íË
    pv_strInit_JDNTRKB = Trim(WLSJDN_JDNTRKB)

'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd

End Function
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_VbKeyRight
    '   äTóvÅF  äeçÄñ⁄ÇÃVBKEYRIGHTêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_VbKeyRight(pm_Dsp_Sub_Inf As Cls_Dsp_Sub_Inf) As Integer

    Dim Move_Flg        As Boolean
    Dim Rtn_Chk         As Integer
    Dim Chk_Move_Flg    As Boolean
    Dim Dsp_Mode        As Integer

    Move_Flg = False
    Chk_Move_Flg = True

' === 20061116 === INSERT S - ACE)Yano VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061116 === INSERT E -
    
    'KEYRIGHTêßå‰
    Call WLSJDN0001.F_Set_Right_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf, False)

    If Move_Flg = True Then
    'éüÇÃçÄñ⁄Ç÷à⁄ìÆÇµÇΩèÍçá
        'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
        Rtn_Chk = WLSJDN0001.F_Ctl_Item_Chk(pm_Dsp_Sub_Inf, CHK_FROM_KEYRIGHT, Chk_Move_Flg, Main_Inf)

        If Rtn_Chk = CHK_OK Then
        'É`ÉFÉbÉNÇnÇjéû
            'éÊìæì‡óeï\é¶
            Dsp_Mode = DSP_SET
        Else
        'É`ÉFÉbÉNÇmÇféû
            'éÊìæì‡óeÉNÉäÉA
            Dsp_Mode = DSP_CLR
        End If
        'éÊìæì‡óeï\é¶/ÉNÉäÉA
        Call WLSJDN0001.F_Dsp_Item_Detail(pm_Dsp_Sub_Inf, Dsp_Mode, Main_Inf)
        
        If Chk_Move_Flg = True Then
            Select Case Me.ActiveControl.NAME
                Case HD_KENNMA.NAME
                    'ïœêîÉNÉäÉA
                    Call WLS_Clear
                    'ÉäÉXÉgï“èW
                    Call F_Get_JDNTHA
                    Call WLS_DspNew
                Case Else
            End Select
            'KEYRIGHTêßå‰(Ã´∞∂Ωà⁄ìÆÇ»Çµ)
            Call WLSJDN0001.F_Set_Right_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf, True)
'            '¡™Ø∏å„à⁄ìÆÇ†ÇË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
        Else
            '¡™Ø∏å„à⁄ìÆÇ»Çµ
            Call CF_Set_Item_SetFocus(pm_Dsp_Sub_Inf, Main_Inf)
            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
            Call CF_Set_Sel_Ini(pm_Dsp_Sub_Inf, SEL_INI_MODE_2)
'            'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
        End If
    End If

End Function


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_VbKeyDown
    '   äTóvÅF  äeçÄñ⁄ÇÃVBKEYDOWNêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_VbKeyDown(pm_Dsp_Sub_Inf As Cls_Dsp_Sub_Inf) As Integer
'
'    Dim Move_Flg        As Boolean
'    Dim Rtn_Chk         As Integer
'    Dim Chk_Move_Flg    As Boolean
'    Dim Dsp_Mode        As Integer
'
'    Move_Flg = False
'    Chk_Move_Flg = False
'
'    'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
'    Rtn_Chk = F_Ctl_Item_Chk(pm_Dsp_Sub_Inf, CHK_FROM_KEYDOWN, Chk_Move_Flg, Main_Inf)
'
'    If Rtn_Chk = CHK_OK Then
'    'É`ÉFÉbÉNÇnÇjéû
'        'éÊìæì‡óeï\é¶
'        Dsp_Mode = DSP_SET
'    Else
'    'É`ÉFÉbÉNÇmÇféû
'        'éÊìæì‡óeÉNÉäÉA
'        Dsp_Mode = DSP_CLR
'    End If
'    'éÊìæì‡óeï\é¶/ÉNÉäÉA
'    Call F_Dsp_Item_Detail(pm_Dsp_Sub_Inf, Dsp_Mode, Main_Inf)
'
'    If Chk_Move_Flg = True Then
'    '¡™Ø∏å„à⁄ìÆÇ†ÇË
'        'KEYDOWNêßå‰
'        Call F_Set_Down_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf)
'        If Move_Flg = True Then
'        'éüÇÃçÄñ⁄Ç÷à⁄ìÆÇµÇΩèÍçá
'            '¡™Ø∏å„à⁄ìÆÇ†ÇË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
'        Else
'            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
'            Call CF_Set_Sel_Ini(pm_Dsp_Sub_Inf, SEL_INI_MODE_2)
'
'            'çÄñ⁄êFê›íË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_SELECT_STATUS, Main_Inf)
'        End If
'    Else
'        '¡™Ø∏å„à⁄ìÆÇ»Çµ
'        Call CF_Set_Item_SetFocus(pm_Dsp_Sub_Inf, Main_Inf)
'        'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'        Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
'    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_VbKeyLeft
    '   äTóvÅF  äeçÄñ⁄ÇÃVBKEYLEFTêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_VbKeyLeft(pm_Dsp_Sub_Inf As Cls_Dsp_Sub_Inf) As Integer

    Dim Move_Flg        As Boolean
    Dim Rtn_Chk         As Integer
    Dim Chk_Move_Flg    As Boolean
    Dim Dsp_Mode        As Integer

    Move_Flg = False
    Chk_Move_Flg = True

    'KEYLEFTêßå‰
    Call WLSJDN0001.F_Set_Left_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf, False)

    If Move_Flg = True Then
    'éüÇÃçÄñ⁄Ç÷à⁄ìÆÇµÇΩèÍçá
        'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
        Rtn_Chk = WLSJDN0001.F_Ctl_Item_Chk(pm_Dsp_Sub_Inf, CHK_FROM_KEYLEFT, Chk_Move_Flg, Main_Inf)

        If Rtn_Chk = CHK_OK Then
        'É`ÉFÉbÉNÇnÇjéû
            'éÊìæì‡óeï\é¶
            Dsp_Mode = DSP_SET
        Else
        'É`ÉFÉbÉNÇmÇféû
            'éÊìæì‡óeÉNÉäÉA
            Dsp_Mode = DSP_CLR
        End If
        'éÊìæì‡óeï\é¶/ÉNÉäÉA
        Call WLSJDN0001.F_Dsp_Item_Detail(pm_Dsp_Sub_Inf, Dsp_Mode, Main_Inf)
        
        If Chk_Move_Flg = True Then
            'KEYLEFTêßå‰(Ã´∞∂Ωà⁄ìÆÇ†ÇË)
            Call WLSJDN0001.F_Set_Left_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf, True)
'            '¡™Ø∏å„à⁄ìÆÇ†ÇË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
        Else
            '¡™Ø∏å„à⁄ìÆÇ»Çµ
            Call CF_Set_Item_SetFocus(pm_Dsp_Sub_Inf, Main_Inf)
            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
            Call CF_Set_Sel_Ini(pm_Dsp_Sub_Inf, SEL_INI_MODE_2)
'            'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
        End If
    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_VbKeyUp
    '   äTóvÅF  äeçÄñ⁄ÇÃVBKEYUPêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_VbKeyUp(pm_Dsp_Sub_Inf As Cls_Dsp_Sub_Inf) As Integer

'    Dim Move_Flg        As Boolean
'    Dim Rtn_Chk         As Integer
'    Dim Chk_Move_Flg    As Boolean
'    Dim Dsp_Mode        As Integer
'
'    Move_Flg = False
'    Chk_Move_Flg = True
'
'    'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
'    Rtn_Chk = F_Ctl_Item_Chk(pm_Dsp_Sub_Inf, CHK_FROM_KEYUP, Chk_Move_Flg, Main_Inf)
'
'    If Rtn_Chk = CHK_OK Then
'    'É`ÉFÉbÉNÇnÇjéû
'        'éÊìæì‡óeï\é¶
'        Dsp_Mode = DSP_SET
'    Else
'    'É`ÉFÉbÉNÇmÇféû
'        'éÊìæì‡óeÉNÉäÉA
'        Dsp_Mode = DSP_CLR
'    End If
'    'éÊìæì‡óeï\é¶/ÉNÉäÉA
'    Call F_Dsp_Item_Detail(pm_Dsp_Sub_Inf, Dsp_Mode, Main_Inf)
'
'    If Chk_Move_Flg = True Then
'    '¡™Ø∏å„à⁄ìÆÇ†ÇË
'        'KEYUPêßå‰
'        Call F_Set_Up_Next_Focus(pm_Dsp_Sub_Inf, Move_Flg, Main_Inf)
'
'        If Move_Flg = True Then
'        'éüÇÃçÄñ⁄Ç÷à⁄ìÆÇµÇΩèÍçá
'            '¡™Ø∏å„à⁄ìÆÇ†ÇË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
'        Else
'            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
'            Call CF_Set_Sel_Ini(pm_Dsp_Sub_Inf, SEL_INI_MODE_2)
'
'            'çÄñ⁄êFê›íË
'            Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_SELECT_STATUS, Main_Inf)
'        End If
'
'    Else
'    '¡™Ø∏å„à⁄ìÆÇ»Çµ
'        Call CF_Set_Item_SetFocus(pm_Dsp_Sub_Inf, Main_Inf)
'        'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'        Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
'    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_KeyDown
    '   äTóvÅF  äeçÄñ⁄ÇÃKEYDOWNêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_KeyDown(pm_Ctl As Control, ByRef pm_KeyCode As Integer, pm_Shift As Integer) As Integer

    Dim Trg_Index    As Integer
    Dim Move_Flg     As Boolean

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    Select Case True
        '¥›¿∞∑∞âü
        Case pm_KeyCode = vbKeyReturn And pm_Shift = 0
            pm_KeyCode = 0
            '¥›¿∞∑∞êßå‰
            Call Ctl_Item_VbKeyReturn(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'Å®âü
        Case pm_KeyCode = vbKeyRight And pm_Shift = 0
            pm_KeyCode = 0
            'Å®êßå‰
            Call Ctl_Item_VbKeyRight(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'Å´âü
        Case pm_KeyCode = vbKeyDown And pm_Shift = 0
            pm_KeyCode = 0
            'Å´êßå‰
            Call Ctl_Item_VbKeyDown(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'Å©âü
        Case pm_KeyCode = vbKeyLeft And pm_Shift = 0
            pm_KeyCode = 0
            'Å©êßå‰
            Call Ctl_Item_VbKeyLeft(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'Å™âü
        Case pm_KeyCode = vbKeyUp And pm_Shift = 0
            'Å™êßå‰
            pm_KeyCode = 0
            Call Ctl_Item_VbKeyUp(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'DELETEâü
        Case pm_KeyCode = vbKeyDelete And pm_Shift = 0
            pm_KeyCode = 0
            Call CF_Ctl_Item_KeyDelete(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

        'INSERTâü
        Case pm_KeyCode = vbKeyInsert And pm_Shift = 0
            pm_KeyCode = 0
            Call CF_Ctl_Item_KeyInsert(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

        'TABâü
        Case pm_KeyCode = vbKeyF16
            pm_KeyCode = 0
            '¥›¿∞∑∞êßå‰
            Call Ctl_Item_VbKeyReturn(Main_Inf.Dsp_Sub_Inf(Trg_Index))

        'Shift+TABâü
        Case pm_KeyCode = vbKeyF15
            pm_KeyCode = 0
            'ëOÃ´∞∂Ωà íuÇ÷à⁄ìÆ
            Call WLSJDN0001.F_Set_Befe_Focus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Move_Flg, Main_Inf)

    End Select

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_LostFocus
    '   äTóvÅF  äeçÄñ⁄ÇÃLOSTFOCUSêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_LostFocus(pm_Ctl As Control) As Integer

    Dim Trg_Index       As Integer
    Dim Act_Index       As Integer
    Dim Move_Flg        As Boolean
    Dim Rtn_Chk         As Integer
    Dim Chk_Move_Flg    As Boolean
    Dim Dsp_Mode        As Integer

' === 20060902 === INSERT S - ACE)Nagasawa
    If gv_bolWLSJDN_LF_Enable = False Then
        Exit Function
    End If
' === 20060902 === INSERT E -

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

' === 20061116 === INSERT S - ACE)Yano VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061116 === INSERT E -
    
    'åªç›Ã´∞∂Ω∫›ƒ€∞ŸéÊìæ
    Act_Index = CInt(Me.ActiveControl.Tag)

    Move_Flg = False
    Chk_Move_Flg = True

    'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
    Rtn_Chk = WLSJDN0001.F_Ctl_Item_Chk(Main_Inf.Dsp_Sub_Inf(Trg_Index), CHK_FROM_LOSTFOCUS, Chk_Move_Flg, Main_Inf)

    If Rtn_Chk = CHK_OK Then
    'É`ÉFÉbÉNÇnÇjéû
        'éÊìæì‡óeï\é¶
        Dsp_Mode = DSP_SET
    Else
    'É`ÉFÉbÉNÇmÇféû
        'éÊìæì‡óeÉNÉäÉA
        Dsp_Mode = DSP_CLR
    End If
    'éÊìæì‡óeï\é¶/ÉNÉäÉA
    Call WLSJDN0001.F_Dsp_Item_Detail(Main_Inf.Dsp_Sub_Inf(Trg_Index), Dsp_Mode, Main_Inf)
    
    If Chk_Move_Flg = True Then
'        '¡™Ø∏å„à⁄ìÆÇ†ÇË
'        Call CF_Set_Item_Color(Main_Inf.Dsp_Sub_Inf(Trg_Index), ITEM_NORMAL_STATUS, Main_Inf)

'@'        'åªç›Ã´∞∂Ω∫›ƒ€∞ŸÇÃëIëèÓïÒÇçƒê›íË
'@'        'ëIëèÛë‘ÇÃê›íË
'@'        Call CF_Set_Sel_Ini(Dsp_Sub_Inf(Act_Index), SEL_INI_DATE_SEL_KBN_DAY)
'@'        'çÄñ⁄êFê›íË
'@'        Call CF_Set_Item_Color(Dsp_Sub_Inf(Act_Index), ITEM_SELECT_STATUS)

    Else
        '¡™Ø∏å„à⁄ìÆÇ»Çµ
        Call CF_Set_Item_SetFocus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)
    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_GotFocus
    '   äTóvÅF  äeçÄñ⁄ÇÃGOTFOCUSêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_GotFocus(pm_Ctl As Control) As Integer

    Dim Trg_Index   As Integer
    Dim Rtn_Chk     As Integer
    Dim Move_Flg    As Boolean
    Dim Wk_Index    As Integer

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    'âÊñ íPà ÇÃèàóù(¡™Ø∏Ç»Ç«)
    'ñæç◊ïîÇ≈Ç©Ç¬à⁄ìÆëOÇ™ñæç◊ïîÇ≈Ç»Ç¢èÍçá
    If Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.In_Area = IN_AREA_DSP_BD _
    And Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.In_Area <> Main_Inf.Dsp_Sub_Inf(Main_Inf.Dsp_Base.Cursor_Idx).Detail.In_Area Then
'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
        'ÕØ¿ﬁïî¡™Ø∏
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd
        If Rtn_Chk <> CHK_OK Then
            Exit Function
        End If
    End If
    
' === 20060801 === INSERT S - ACE)Nagasawa åüçıâÊñ ï\é¶É{É^ÉìÇâüÇµÇΩÇ±Ç∆Ç™å©Ç¶ÇÈÇÊÇ§Ç…Ç∑ÇÈëŒâû
    If TypeOf pm_Ctl Is SSCommand5 Then
        'åüçıâÊñ åƒèoÇÃèÍçáÇÕèIóπ
        Exit Function
    End If
    
    If Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.In_Area = IN_AREA_DSP_BD Then
        'ñæç◊çsÉRÉìÉgÉçÅ[ÉãÇ©îªíË
        If Trg_Index >= Main_Inf.Dsp_Base.Body_Fst_Idx Then
            'ñæç◊åüçıÉ{É^ÉìÇÃñæç◊çsêîïœêîÇ…ìØÇ∂çsêîÇê›íË
            For Wk_Index = Main_Inf.Dsp_Base.Head2_Lst_Idx + 1 To Main_Inf.Dsp_Base.Body_Fst_Idx - 1
                If Main_Inf.Dsp_Sub_Inf(Wk_Index).Detail.Body_Index = Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.Body_Index Then
                    'ê›íËçœÇ›ÇÃèÍçáÇÕèIóπ
                    Exit For
                End If
                Main_Inf.Dsp_Sub_Inf(Wk_Index).Detail.Body_Index = Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.Body_Index
            Next
        End If
    Else
        'ñæç◊åüçıÉ{É^ÉìÇÃñæç◊çsêîïœêîÇèâä˙âª
        For Wk_Index = Main_Inf.Dsp_Base.Head2_Lst_Idx + 1 To Main_Inf.Dsp_Base.Body_Fst_Idx - 1
            If Main_Inf.Dsp_Sub_Inf(Wk_Index).Detail.Body_Index = 0 Then
                'ê›íËçœÇ›ÇÃèÍçáÇÕèIóπ
                Exit For
            End If
            Main_Inf.Dsp_Sub_Inf(Wk_Index).Detail.Body_Index = 0
        Next
    End If
' === 20060801 === INSERT E
    
'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    Select Case Trg_Index
        Case Else
            'ã§í Ã´∞∂ΩéÊìæèàóù
            Call WLSJDN0001.CF_Ctl_Item_GotFocus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)
    End Select
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd
    
End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_KEYUP
    '   äTóvÅF  äeçÄñ⁄ÇÃKEYUPêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_KeyUp(pm_Ctl As Control) As Integer

    Dim Trg_Index   As Integer

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    'äeåüçıâÊñ åƒèo
'    Select Case Trg_Index
'        Case CInt(HD_AKNID.Tag)
'            'àƒåèIDÇÃ√∑ΩƒÇ÷Ã´∞∂Ωà⁄ìÆ

'    End Select
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_KeyPress
    '   äTóvÅF  äeçÄñ⁄ÇÃKEYPRESSêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_KeyPress(pm_Ctl As Control, ByRef pm_KeyAscii As Integer) As Integer

    Dim Trg_Index    As Integer
    Dim Move_Flg        As Boolean
    Dim Rtn_Chk         As Integer
    Dim Chk_Move_Flg    As Boolean
    Dim Dsp_Mode        As Integer
    
' === 20061116 === INSERT S - ACE)Yano VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061116 === INSERT E -
    
    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    Move_Flg = False
    Chk_Move_Flg = True

    'ã§í KEYPRESSêßå‰
    Call WLSJDN0001.CF_Ctl_Item_KeyPress(Main_Inf.Dsp_Sub_Inf(Trg_Index), pm_KeyAscii, Move_Flg, Main_Inf, False)

    If Move_Flg = True Then
    'éüÇÃçÄñ⁄Ç÷à⁄ìÆÇµÇΩèÍçá
        'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
        Rtn_Chk = WLSJDN0001.F_Ctl_Item_Chk(Main_Inf.Dsp_Sub_Inf(Trg_Index), CHK_FROM_KEYPRESS, Chk_Move_Flg, Main_Inf)
        
        If Rtn_Chk = CHK_OK Then
        'É`ÉFÉbÉNÇnÇjéû
            'éÊìæì‡óeï\é¶
            Dsp_Mode = DSP_SET
        Else
        'É`ÉFÉbÉNÇmÇféû
            'éÊìæì‡óeÉNÉäÉA
            Dsp_Mode = DSP_CLR
        End If
        'éÊìæì‡óeï\é¶/ÉNÉäÉA
        Call WLSJDN0001.F_Dsp_Item_Detail(Main_Inf.Dsp_Sub_Inf(Trg_Index), Dsp_Mode, Main_Inf)
        
        If Chk_Move_Flg = True Then
            Select Case Me.ActiveControl.NAME
                Case HD_KENNMA.NAME
                    'ïœêîÉNÉäÉA
                    Call WLS_Clear
                    'ÉäÉXÉgï“èW
                    Call F_Get_JDNTHA
                    Call WLS_DspNew
                Case Else
            End Select
            
            'åªç›Ã´∞∂Ωà íuÇ©ÇÁâEÇ÷à⁄ìÆ
            Call WLSJDN0001.F_Set_Right_Next_Focus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Move_Flg, Main_Inf, True)
'            '¡™Ø∏å„à⁄ìÆÇ†ÇË
'            Call CF_Set_Item_Color(Main_Inf.Dsp_Sub_Inf(Trg_Index), ITEM_NORMAL_STATUS, Main_Inf)
        Else
            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
            Call CF_Set_Sel_Ini(Main_Inf.Dsp_Sub_Inf(Trg_Index), SEL_INI_MODE_2)

'            'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'            Call CF_Set_Item_Color(Main_Inf.Dsp_Sub_Inf(Trg_Index), ITEM_NORMAL_STATUS, Main_Inf)
        End If

    Else
'        'çÄñ⁄êFê›íË(ì¸óÕäJénÇ≈êFÇÃ´∞∂ΩÇ†ÇËÇÃëOåiêFÅÅçïÇ…ê›íËÅIÅI)
'        Call CF_Set_Item_Color(Main_Inf.Dsp_Sub_Inf(Trg_Index), ITEM_SELECT_STATUS, Main_Inf, ITEM_COLOR_KEYPRESS)
    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_Change
    '   äTóvÅF  äeçÄñ⁄ÇÃCHANGEêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_Change(pm_Ctl As Control) As Integer

    Dim Trg_Index    As Integer

    If Main_Inf.Dsp_Base.Change_Flg = True Then
        Main_Inf.Dsp_Base.Change_Flg = False
        Exit Function
    End If

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    'ã§í KEYCHANGêßå‰
    Call WLSJDN0001.CF_Ctl_Item_Change(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

    'âÊñ íPà ÇÃèàóù(¡™Ø∏Ç»Ç«)

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_MouseUp
    '   äTóvÅF  äeçÄñ⁄ÇÃMOUSEUPêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_MouseUp(pm_Ctl As Control, Button As Integer, Shift As Integer, X As Single, Y As Single) As Integer

    Dim Trg_Index    As Integer

' === 20061205 === INSERT S - ACE)Nagasawa VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061205 === INSERT E -

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)
            
    Select Case True
        Case TypeOf pm_Ctl Is TextBox
' === 20061024 === INSERT S - ACE)Nagasawa ï∂éöóÒì¸óÕçÄñ⁄ÇÃìríÜÇ‹Ç≈ÇÃëIëÇâ¬î\Ç∆Ç∑ÇÈ
            If Main_Inf.Dsp_Sub_Inf(Trg_Index).Detail.In_Typ <> IN_TYP_STR Then
' === 20061024 === INSERT E -
            'ëIëèÛë‘ÇÃê›íËÅièâä˙ëIëÅj
            Call CF_Set_Sel_Ini(Main_Inf.Dsp_Sub_Inf(Trg_Index), SEL_INI_MODE_1)
'            'çÄñ⁄êFê›íË
'            Call CF_Set_Item_Color(Main_Inf.Dsp_Sub_Inf(Trg_Index), ITEM_SELECT_STATUS, Main_Inf)
' === 20061024 === INSERT S - ACE)Nagasawa ï∂éöóÒì¸óÕçÄñ⁄ÇÃìríÜÇ‹Ç≈ÇÃëIëÇâ¬î\Ç∆Ç∑ÇÈ
            End If
' === 20061024 === INSERT E -

        Case TypeOf pm_Ctl Is SSPanel5
            'ÉpÉlÉãÇÃèÍçá
            Call WLSJDN0001.CF_Ctl_Item_GotFocus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

' === 20060801 === INSERT S - ACE)NagasawaÅ@åüçıWÉ{É^ÉìëŒâû
        Case TypeOf pm_Ctl Is SSCommand5
            'É{É^ÉìÇÃèÍçá
            If TypeOf Main_Inf.Dsp_Sub_Inf(CInt(WLS_UODET63.ActiveControl.Tag)).Ctl Is SSCommand5 Then
                Call WLSJDN0001.CF_Ctl_Item_GotFocus(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)
            End If
' === 20060801 === INSERT E

        Case TypeOf pm_Ctl Is Image
            'ÉCÉÅÅ[ÉWÇÃèÍçá
            Select Case Trg_Index
                Case CInt(CM_PrevCm.Tag)
                'ëOï≈≤“∞ºﬁ
                    Call CF_Set_Img(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf.IM_PrevCm_Inf, False, Main_Inf)
                Case CInt(CM_NextCm.Tag)
                'éüï≈≤“∞ºﬁ
                    Call CF_Set_Img(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf.IM_NextCm_Inf, False, Main_Inf)
            End Select

    End Select
    
End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_MouseMove
    '   äTóvÅF  äeçÄñ⁄ÇÃMOUSEMOVEêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_MouseMove(pm_Ctl As Control, Button As Integer, Shift As Integer, X As Single, Y As Single) As Integer

    Dim Trg_Index    As Integer

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    Select Case Trg_Index

    End Select

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_MouseDown
    '   äTóvÅF  äeçÄñ⁄ÇÃMOUSEDOWNêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_MouseDown(pm_Ctl As Control, Button As Integer, Shift As Integer, X As Single, Y As Single) As Integer

    Dim Trg_Index    As Integer

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)

    Select Case Trg_Index
        Case CInt(CM_PrevCm.Tag)
        'ëOï≈≤“∞ºﬁ
            Call CF_Set_Img(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf.IM_PrevCm_Inf, True, Main_Inf)
        Case CInt(CM_NextCm.Tag)
        'éüï≈≤“∞ºﬁ
            Call CF_Set_Img(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf.IM_NextCm_Inf, True, Main_Inf)
    End Select

    'ã§í MOUSEDOWNêßå‰
    Call WLSJDN0001.CF_Ctl_Item_MouseDown(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_Click
    '   äTóvÅF  äeçÄñ⁄ÇÃCLICKêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_Click(pm_Ctl As Control) As Integer

    Dim Trg_Index   As Integer
    Dim Act_Index   As Integer

    'äÑìñ≤›√ﬁØ∏ΩéÊìæ
    Trg_Index = CInt(pm_Ctl.Tag)
    
' === 20061116 === INSERT S - ACE)Yano VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061116 === INSERT E -
    
    '±∏√®Ãﬁ∫›ƒ€∞ŸäÑìñ≤›√ﬁØ∏ΩéÊìæ
    Act_Index = CInt(Me.ActiveControl.Tag)

    'äeåüçıâÊñ åƒèo
    Select Case Trg_Index
        Case CInt(CS_TANCD.Tag)
            'íSìñé“åüçıâÊñ åƒèo
            Call WLSJDN0001.F_Ctl_CS_TANCD(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)
            
        Case CInt(CS_JDNTRKB.Tag)
            'éÛíçéÊà¯ãÊï™åüçıâÊñ åƒèo
            Call WLSJDN0001.F_Ctl_CS_JDNTRKB(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

        Case CInt(CS_JDNDT.Tag)
            'ì˙ïtåüçıâÊñ åƒèo
            Call WLSJDN0001.F_Ctl_CS_JDNDT(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)

        Case CInt(CS_TOKCD.Tag)
            'ìæà”êÊåüçıâÊñ åƒèo
            Call WLSJDN0001.F_Ctl_CS_TOKCD(Main_Inf.Dsp_Sub_Inf(Trg_Index), Main_Inf)
            
        Case CInt(CM_PrevCm.Tag)
            'ëOï≈
            Call Ctl_CM_PrevCm_Click
            
        Case CInt(CM_NextCm.Tag)
            'éüï≈
            Call Ctl_CM_NextCm_Click
            
        Case CInt(WLSOK.Tag)
            'OK
            Call Ctl_WLSOK_Click
            
        Case CInt(WLSCANCEL.Tag)
            'ÉLÉÉÉìÉZÉã
            Call Ctl_WLSCANCEL_Click
            
    End Select

End Function

Private Sub Form_Load()
    
    'âÊñ èÓïÒê›íË
    Call Init_Def_Dsp
    
    'âÊñ ì‡óeèâä˙âª
    Call WLSJDN0001.F_Init_Clr_Dsp(-1, Main_Inf)

    'èâä˙ï\é¶ï“èW
    Call Edi_Dsp_Def
    
    'âÊñ ï\é¶à íuê›íË
    Call CF_Set_Frm_Location(WLS_UODET63)
    
End Sub

Private Sub HD_TANCD_Change()
    Debug.Print Me.NAME & ".HD_TANCD_Change"
    Call Ctl_Item_Change(HD_TANCD)
End Sub

Private Sub HD_TANCD_GotFocus()
    Debug.Print Me.NAME & ".HD_TANCD_GotFocus"
    Call Ctl_Item_GotFocus(HD_TANCD)
End Sub

Private Sub HD_TANCD_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_TANCD_KeyDown"
    Call Ctl_Item_KeyDown(HD_TANCD, KeyCode, Shift)
End Sub

Private Sub HD_TANCD_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_TANCD_KeyPress"
    Call Ctl_Item_KeyPress(HD_TANCD, KeyAscii)
End Sub

Private Sub HD_TANCD_LostFocus()
    Debug.Print Me.NAME & ".HD_TANCD_LostFocus"
    Call Ctl_Item_LostFocus(HD_TANCD)
End Sub

Private Sub HD_TANCD_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TANCD_MouseDown"
    Call Ctl_Item_MouseDown(HD_TANCD, Button, Shift, X, Y)
End Sub

Private Sub HD_TANCD_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TANCD_MouseUp"
    Call Ctl_Item_MouseUp(HD_TANCD, Button, Shift, X, Y)
End Sub

Private Sub HD_TANNM_Change()
    Debug.Print Me.NAME & ".HD_TANNM_Change"
    Call Ctl_Item_Change(HD_TANNM)
End Sub

Private Sub HD_TANNM_GotFocus()
    Debug.Print Me.NAME & ".HD_TANNM_GotFocus"
    Call Ctl_Item_GotFocus(HD_TANNM)
End Sub

Private Sub HD_TANNM_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_TANNM_KeyDown"
    Call Ctl_Item_KeyDown(HD_TANNM, KeyCode, Shift)
End Sub

Private Sub HD_TANNM_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_TANNM_KeyPress"
    Call Ctl_Item_KeyPress(HD_TANNM, KeyAscii)
End Sub

Private Sub HD_TANNM_LostFocus()
    Debug.Print Me.NAME & ".HD_TANNM_LostFocus"
    Call Ctl_Item_LostFocus(HD_TANNM)
End Sub

Private Sub HD_TANNM_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TANNM_MouseDown"
    Call Ctl_Item_MouseDown(HD_TANNM, Button, Shift, X, Y)
End Sub

Private Sub HD_TANNM_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TANNM_MouseUp"
    Call Ctl_Item_MouseUp(HD_TANNM, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNNO_Change()
    Debug.Print Me.NAME & ".HD_JDNNO_Change"
    Call Ctl_Item_Change(HD_JDNNO)
End Sub

Private Sub HD_JDNNO_GotFocus()
    Debug.Print Me.NAME & ".HD_JDNNO_GotFocus"
    Call Ctl_Item_GotFocus(HD_JDNNO)
End Sub

Private Sub HD_JDNNO_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_JDNNO_KeyDown"
    Call Ctl_Item_KeyDown(HD_JDNNO, KeyCode, Shift)
End Sub

Private Sub HD_JDNNO_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_JDNNO_KeyPress"
    Call Ctl_Item_KeyPress(HD_JDNNO, KeyAscii)
End Sub

Private Sub HD_JDNNO_LostFocus()
    Debug.Print Me.NAME & ".HD_JDNNO_LostFocus"
    Call Ctl_Item_LostFocus(HD_JDNNO)
End Sub

Private Sub HD_JDNNO_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNNO_MouseDown"
    Call Ctl_Item_MouseDown(HD_JDNNO, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNNO_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNNO_MouseUp"
    Call Ctl_Item_MouseUp(HD_JDNNO, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNTRKB_Change()
    Debug.Print Me.NAME & ".HD_JDNTRKB_Change"
    Call Ctl_Item_Change(HD_JDNTRKB)
End Sub

Private Sub HD_JDNTRKB_GotFocus()
    Debug.Print Me.NAME & ".HD_JDNTRKB_GotFocus"
    Call Ctl_Item_GotFocus(HD_JDNTRKB)
End Sub

Private Sub HD_JDNTRKB_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_JDNTRKB_KeyDown"
    Call Ctl_Item_KeyDown(HD_JDNTRKB, KeyCode, Shift)
End Sub

Private Sub HD_JDNTRKB_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_JDNTRKB_KeyPress"
    Call Ctl_Item_KeyPress(HD_JDNTRKB, KeyAscii)
End Sub

Private Sub HD_JDNTRKB_LostFocus()
    Debug.Print Me.NAME & ".HD_JDNTRKB_LostFocus"
    Call Ctl_Item_LostFocus(HD_JDNTRKB)
End Sub

Private Sub HD_JDNTRKB_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNTRKB_MouseDown"
    Call Ctl_Item_MouseDown(HD_JDNTRKB, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNTRKB_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNTRKB_MouseUp"
    Call Ctl_Item_MouseUp(HD_JDNTRKB, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNTRKBNM_Change()
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_Change"
    Call Ctl_Item_Change(HD_JDNTRKBNM)
End Sub

Private Sub HD_JDNTRKBNM_GotFocus()
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_GotFocus"
    Call Ctl_Item_GotFocus(HD_JDNTRKBNM)
End Sub

Private Sub HD_JDNTRKBNM_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_KeyDown"
    Call Ctl_Item_KeyDown(HD_JDNTRKBNM, KeyCode, Shift)
End Sub

Private Sub HD_JDNTRKBNM_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_KeyPress"
    Call Ctl_Item_KeyPress(HD_JDNTRKBNM, KeyAscii)
End Sub

Private Sub HD_JDNTRKBNM_LostFocus()
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_LostFocus"
    Call Ctl_Item_LostFocus(HD_JDNTRKBNM)
End Sub

Private Sub HD_JDNTRKBNM_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_MouseDown"
    Call Ctl_Item_MouseDown(HD_JDNTRKBNM, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNTRKBNM_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNTRKBNM_MouseUp"
    Call Ctl_Item_MouseUp(HD_JDNTRKBNM, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNDT_Change()
    Debug.Print Me.NAME & ".HD_JDNDT_Change"
    Call Ctl_Item_Change(HD_JDNDT)
End Sub

Private Sub HD_JDNDT_GotFocus()
    Debug.Print Me.NAME & ".HD_JDNDT_GotFocus"
    Call Ctl_Item_GotFocus(HD_JDNDT)
End Sub

Private Sub HD_JDNDT_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_JDNDT_KeyDown"
    Call Ctl_Item_KeyDown(HD_JDNDT, KeyCode, Shift)
End Sub

Private Sub HD_JDNDT_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_JDNDT_KeyPress"
    Call Ctl_Item_KeyPress(HD_JDNDT, KeyAscii)
End Sub

Private Sub HD_JDNDT_LostFocus()
    Debug.Print Me.NAME & ".HD_JDNDT_LostFocus"
    Call Ctl_Item_LostFocus(HD_JDNDT)
End Sub

Private Sub HD_JDNDT_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNDT_MouseDown"
    Call Ctl_Item_MouseDown(HD_JDNDT, Button, Shift, X, Y)
End Sub

Private Sub HD_JDNDT_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_JDNDT_MouseUp"
    Call Ctl_Item_MouseUp(HD_JDNDT, Button, Shift, X, Y)
End Sub

Private Sub HD_TOKCD_Change()
    Debug.Print Me.NAME & ".HD_TOKCD_Change"
    Call Ctl_Item_Change(HD_TOKCD)
End Sub

Private Sub HD_TOKCD_GotFocus()
    Debug.Print Me.NAME & ".HD_TOKCD_GotFocus"
    Call Ctl_Item_GotFocus(HD_TOKCD)
End Sub

Private Sub HD_TOKCD_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_TOKCD_KeyDown"
    Call Ctl_Item_KeyDown(HD_TOKCD, KeyCode, Shift)
End Sub

Private Sub HD_TOKCD_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_TOKCD_KeyPress"
    Call Ctl_Item_KeyPress(HD_TOKCD, KeyAscii)
End Sub

Private Sub HD_TOKCD_LostFocus()
    Debug.Print Me.NAME & ".HD_TOKCD_LostFocus"
    Call Ctl_Item_LostFocus(HD_TOKCD)
End Sub

Private Sub HD_TOKCD_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TOKCD_MouseDown"
    Call Ctl_Item_MouseDown(HD_TOKCD, Button, Shift, X, Y)
End Sub

Private Sub HD_TOKCD_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_TOKCD_MouseUp"
    Call Ctl_Item_MouseUp(HD_TOKCD, Button, Shift, X, Y)
End Sub

Private Sub HD_KENNMA_Change()
    Debug.Print Me.NAME & ".HD_KENNMA_Change"
    Call Ctl_Item_Change(HD_KENNMA)
End Sub

Private Sub HD_KENNMA_GotFocus()
    Debug.Print Me.NAME & ".HD_KENNMA_GotFocus"
    Call Ctl_Item_GotFocus(HD_KENNMA)
End Sub

Private Sub HD_KENNMA_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".HD_KENNMA_KeyDown"
    Call Ctl_Item_KeyDown(HD_KENNMA, KeyCode, Shift)
End Sub

Private Sub HD_KENNMA_KeyPress(KeyAscii As Integer)
    Debug.Print Me.NAME & ".HD_KENNMA_KeyPress"
    Call Ctl_Item_KeyPress(HD_KENNMA, KeyAscii)
End Sub

Private Sub HD_KENNMA_LostFocus()
    Debug.Print Me.NAME & ".HD_KENNMA_LostFocus"
    Call Ctl_Item_LostFocus(HD_KENNMA)
End Sub

Private Sub HD_KENNMA_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_KENNMA_MouseDown"
    Call Ctl_Item_MouseDown(HD_KENNMA, Button, Shift, X, Y)
End Sub

Private Sub HD_KENNMA_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".HD_KENNMA_MouseUp"
    Call Ctl_Item_MouseUp(HD_KENNMA, Button, Shift, X, Y)
End Sub

Private Sub LST_DblClick()
    Debug.Print "LST_KeyDown"
    Call Ctl_Item_KeyDown(HD_TANCD, vbKeyReturn, 0)
End Sub

Private Sub LST_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print "LST_KeyDown"
    Select Case KeyCode
        'EnterÉLÅ[âüâ∫
        Case vbKeyReturn
            Call Ctl_Item_KeyDown(LST, KeyCode, Shift)
            
        'EscapeÉLÅ[âüâ∫
        Case vbKeyEscape
            Call WLSCANCEL_Click
        
        'Å©ÉLÅ[âüâ∫
        Case vbKeyLeft
            Call CM_PrevCm_Click
            
        'Å®ÉLÅ[âüâ∫
        Case vbKeyRight
            Call CM_NextCm_Click
            If LST.ListCount > 0 Then
                LST.ListIndex = -1
            End If
    End Select
    
End Sub

Private Sub CS_TANCD_Click()
    Debug.Print Me.NAME & ".CS_TANCD_Click"
    Call Ctl_Item_Click(CS_TANCD)
End Sub

Private Sub CS_TANCD_GotFocus()
    Debug.Print Me.NAME & ".CS_TANCD_GotFocus"
    Call Ctl_Item_GotFocus(CS_TANCD)
End Sub

Private Sub CS_TANCD_KeyUp(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".CS_TANCD_KeyUp"
    Call Ctl_Item_KeyUp(CS_TANCD)
End Sub

Private Sub CS_TANCD_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".CS_TANCD_MouseUp"
    Call Ctl_Item_MouseUp(CS_TANCD, Button, Shift, X, Y)
End Sub

Private Sub CS_JDNTRKB_Click()
    Debug.Print Me.NAME & ".CS_JDNTRKB_Click"
    Call Ctl_Item_Click(CS_JDNTRKB)
End Sub

Private Sub CS_JDNTRKB_GotFocus()
    Debug.Print Me.NAME & ".CS_JDNTRKB_GotFocus"
    Call Ctl_Item_GotFocus(CS_JDNTRKB)
End Sub

Private Sub CS_JDNTRKB_KeyUp(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".CS_JDNTRKB_KeyUp"
    Call Ctl_Item_KeyUp(CS_JDNTRKB)
End Sub

Private Sub CS_JDNTRKB_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".CS_JDNTRKB_MouseUp"
    Call Ctl_Item_MouseUp(CS_JDNTRKB, Button, Shift, X, Y)
End Sub

Private Sub CS_JDNDT_Click()
    Debug.Print Me.NAME & ".CS_JDNDT_Click"
    Call Ctl_Item_Click(CS_JDNDT)
End Sub

Private Sub CS_JDNDT_GotFocus()
    Debug.Print Me.NAME & ".CS_JDNDT_GotFocus"
    Call Ctl_Item_GotFocus(CS_JDNDT)
End Sub

Private Sub CS_JDNDT_KeyUp(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".CS_JDNDT_KeyUp"
    Call Ctl_Item_KeyUp(CS_JDNDT)
End Sub

Private Sub CS_JDNDT_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".CS_JDNDT_MouseUp"
    Call Ctl_Item_MouseUp(CS_JDNDT, Button, Shift, X, Y)
End Sub

Private Sub CS_TOKCD_Click()
    Debug.Print Me.NAME & ".CS_TOKCD_Click"
    Call Ctl_Item_Click(CS_TOKCD)
End Sub

Private Sub CS_TOKCD_GotFocus()
    Debug.Print Me.NAME & ".CS_TOKCD_GotFocus"
    Call Ctl_Item_GotFocus(CS_TOKCD)
End Sub

Private Sub CS_TOKCD_KeyUp(KeyCode As Integer, Shift As Integer)
    Debug.Print Me.NAME & ".CS_TOKCD_KeyUp"
    Call Ctl_Item_KeyUp(CS_TOKCD)
End Sub

Private Sub CS_TOKCD_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print Me.NAME & ".CS_TOKCD_MouseUp"
    Call Ctl_Item_MouseUp(CS_TOKCD, Button, Shift, X, Y)
End Sub

Private Sub WLSCANCEL_Click()
    Debug.Print "WLSCANCEL_Click"
    Call Ctl_Item_Click(WLSCANCEL)
End Sub

Private Sub WLSOK_Click()
    Debug.Print "WLSOK_Click"
    Call Ctl_Item_Click(WLSOK)
End Sub

Private Sub CM_NextCm_Click()
    Debug.Print "CM_NextCm_Click"
    Call Ctl_Item_Click(CM_NextCm)
End Sub

Private Sub CM_PrevCm_Click()
    Debug.Print "CM_PrevCm_Click"
    Call Ctl_Item_Click(CM_PrevCm)
End Sub

Private Sub CM_NextCm_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "CM_NextCm_MouseDown"
    Call Ctl_Item_MouseDown(CM_NextCm, Button, Shift, X, Y)
End Sub

Private Sub CM_PrevCm_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "CM_PrevCm_MouseDown"
    Call Ctl_Item_MouseDown(CM_PrevCm, Button, Shift, X, Y)
End Sub

Private Sub CM_NextCm_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "CM_NextCm_MouseUp"
    Call Ctl_Item_MouseUp(CM_NextCm, Button, Shift, X, Y)
End Sub

Private Sub CM_PrevCm_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "CM_PrevCm_MouseUp"
    Call Ctl_Item_MouseUp(CM_PrevCm, Button, Shift, X, Y)
End Sub

' === 20060921 === INSERT S - ACE)Sejima
Private Sub WLSLABEL_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "WLSLABEL_MouseUp"
    Call Ctl_Item_MouseUp(WLSLABEL, Button, Shift, X, Y)
End Sub
' === 20060921 === INSERT E
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_CM_PrevCm_Click
    '   äTóvÅF  ëOÉyÅ[ÉW
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_CM_PrevCm_Click() As Integer
    If WM_WLS_Pagecnt > 0 Then
        WM_WLS_Pagecnt = WM_WLS_Pagecnt - 1
        Call WLS_DspPage
    End If
End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_CM_NextCm_Click
    '   äTóvÅF  éüÉyÅ[ÉW
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_CM_NextCm_Click() As Integer

    If LST.ListCount <= 0 Then Exit Function
   
    If WM_WLS_Pagecnt >= WM_WLS_LastPage Then
        'Ç∑Ç◊ÇƒÇÃéÊìæÉfÅ[É^ÇëﬁîÇµÇƒÇ¢Ç»Ç¢èÍçáÇÕëﬁîèàóùé¿çs
        If Not WM_WLS_LastFL Then Call WLS_DspNew
    Else
        'ëﬁîÇµÇƒÇ¢ÇÈèÍçáÇÕÉyÅ[ÉWêîÉAÉbÉv
        WM_WLS_Pagecnt = WM_WLS_Pagecnt + 1
        Call WLS_DspPage
    End If
    
End Function
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Edi_Dsp_Def
    '   äTóvÅF  èâä˙éûÇÃâÊñ ï“èW
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Edi_Dsp_Def() As Integer
    Dim Index_Wk        As Integer
    Dim Mst_Inf         As TYPE_DB_MEIMTA

'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
    'WLSJDN0001.F_Init_Clr_Dsp Ç≈èâä˙âªèàóùÇé¿çsçœÇ›
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_WLSOK_Click
    '   äTóvÅF  OKÉ{É^Éìâüâ∫éû
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_WLSOK_Click() As Integer
        
    'ñﬂÇËílÇê›íË
    WLSJDN_RTNJDNNO = MidWid$(LST.List(LST.ListIndex), 1, 8)
        
        Call Ctl_WLSCANCEL_Click
        
'ÇrÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇr
'ÇdÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÅöÇd
End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_WLSCANCEL_Click
    '   äTóvÅF  ÉLÉÉÉìÉZÉãÉ{É^Éìâüâ∫éû
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_WLSCANCEL_Click() As Integer

    'âÊñ Çï\é¶Ç∑ÇÈÇ∆Ç´Ç…ñﬂÇËílïœêîÇÕèâä˙âªÇ≥ÇÍÇƒÇ¢ÇÈ
    If Dyn_Open = True Then
        'ÉNÉçÅ[ÉY
        Call CF_Ora_CloseDyn(Usr_Ody)
        Dyn_Open = False
    End If
    
    Hide
End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Ctl_Item_VbKeyReturn
    '   äTóvÅF  äeçÄñ⁄ÇÃVBKEYRETURNêßå‰
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF  ëSâÊñ ÉçÅ[ÉJÉãã§í èàóù
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_Item_VbKeyReturn(pm_Dsp_Sub_Inf As Cls_Dsp_Sub_Inf) As Integer
    
    Dim Move_Flg        As Boolean
    Dim Rtn_Chk         As Integer
    Dim Chk_Move_Flg    As Boolean
    Dim Dsp_Mode        As Integer

    Move_Flg = False
    Chk_Move_Flg = True

' === 20061116 === INSERT S - ACE)Yano VBÉGÉâÅ[î≠ê∂ëŒâû
    If Me.ActiveControl Is Nothing Then
        Exit Function
    End If
' === 20061116 === INSERT E -
    
    'äeçÄñ⁄ÇÃ¡™Ø∏Ÿ∞¡›
    Rtn_Chk = WLSJDN0001.F_Ctl_Item_Chk(pm_Dsp_Sub_Inf, CHK_FROM_KEYRETURN, Chk_Move_Flg, Main_Inf)

    If Rtn_Chk = CHK_OK Then
    'É`ÉFÉbÉNÇnÇjéû
        'éÊìæì‡óeï\é¶
        Dsp_Mode = DSP_SET
    Else
    'É`ÉFÉbÉNÇmÇféû
        'éÊìæì‡óeÉNÉäÉA
        Dsp_Mode = DSP_CLR
    End If
    'éÊìæì‡óeï\é¶/ÉNÉäÉA
    Call WLSJDN0001.F_Dsp_Item_Detail(pm_Dsp_Sub_Inf, Dsp_Mode, Main_Inf)

    If Chk_Move_Flg = True Then

        Select Case Me.ActiveControl.NAME
            Case HD_TANCD.NAME, HD_JDNNO.NAME, HD_JDNTRKB.NAME, _
                 HD_JDNDT.NAME, HD_TOKCD.NAME, HD_KENNMA.NAME
                'ïœêîÉNÉäÉA
                Call WLS_Clear
                'ÉäÉXÉgï“èW
                Call F_Get_JDNTHA
                Call WLS_DspNew

                'Ã´∞∂Ωà⁄ìÆ
                Call CF_Set_Item_SetFocus(Main_Inf.Dsp_Sub_Inf(LST.Tag), Main_Inf)

            Case LST.NAME
                Call Ctl_WLSOK_Click

            Case Else
        End Select
    Else
        '¡™Ø∏å„à⁄ìÆÇ»Çµ
        Call CF_Set_Item_SetFocus(pm_Dsp_Sub_Inf, Main_Inf)
'        'çÄñ⁄êFê›íË(ÉGÉâÅ[éûÇÕÃ´∞∂ΩÇ»ÇµÇÃêFê›íËÅIÅI)
'        Call CF_Set_Item_Color(pm_Dsp_Sub_Inf, ITEM_NORMAL_STATUS, Main_Inf)
    End If

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_Clear
    '   äTóvÅF  ïœêîèâä˙âª
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Sub WLS_Clear()
    'âÊñ ï\é¶ÉyÅ[ÉW
    WM_WLS_Pagecnt = -1
    WM_WLS_LastPage = -1
    WM_WLS_LastFL = False

    'åüçıåãâ ï€éùîzóÒ
    ReDim WM_WLS_DSPArray(0)

End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_DspNew
    '   äTóvÅF  ÉäÉXÉgï“èWèàóù(èâä˙èÓïÒ)
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub WLS_DspNew()

    Dim Cnt             As Long
    Dim strWORK         As String
    
    Cnt = 0
    
    Do Until CF_Ora_EOF(Usr_Ody) = True

        'éÊìæì‡óeëﬁî
        With pv_DB_JDNTHA_W
            .JDNNO = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_JDNNO", "")                'éÛíçî‘çÜ
            .JDNTRKB = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_JDNTRKB", "")            'éÛíçéÊà¯ãÊï™
            .JDNTRKBNM = CF_Ora_GetDyn(Usr_Ody, "MEIMTA_JDNTRKBNM", "")        'éÛíçéÊà¯ãÊï™ñº
            
            strWORK = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_JDNDT", "")               'éÛíçì`ï[ì˙ït
            .JDNDT = Format(strWORK, "@@@@/@@/@@")
            
            strWORK = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_DENDT", "")               'éÛíçì˙ït
            .DENDT = Format(strWORK, "@@@@/@@/@@")
            
            .KENNMA = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_KENNMA", "")              'åèñºÇP
            .KENNMB = CF_Ora_GetDyn(Usr_Ody, "JDNTHA_KENNMB", "")              'åèñºÇQ
            .TOKRN = CF_Ora_GetDyn(Usr_Ody, "TOKMTA_TOKRN", "")                'ìæà”êÊó™èÃ
        End With
        
        'ï\é¶â¸ÉyÅ[ÉW
        If Cnt Mod WM_WLS_MAX = 0 Then
            'ÉEÉBÉìÉhï\é¶ÉyÅ[ÉWÉJÉEÉìÉ^ÇÉJÉEÉìÉgÉAÉbÉv
            WM_WLS_Pagecnt = WM_WLS_Pagecnt + 1
            'ÉEÉBÉìÉhï\é¶ÉfÅ[É^óÃàÊÇÉäÉXÉgçsêîï™çÏê¨
            ReDim Preserve WM_WLS_DSPArray((WM_WLS_Pagecnt + 1) * WM_WLS_MAX)
            Cnt = 0
            'ç≈èIÉyÅ[ÉWëﬁî
            WM_WLS_LastPage = WM_WLS_Pagecnt
        End If

        'ï\é¶ÉÅÉÇÉäìWäJ
        Call WLS_SetArray(WM_WLS_Pagecnt * WM_WLS_MAX + Cnt)
        
        Cnt = Cnt + 1
        
        Call CF_Ora_MoveNext(Usr_Ody)
        
        If Cnt >= WM_WLS_MAX Then
            Exit Do
        End If
        
    Loop

    'ç≈èIÉfÅ[É^ìûíB
    If CF_Ora_EOF(Usr_Ody) = True Then
        WM_WLS_LastFL = True
    End If
    
    If Cnt > 0 Then
        'ÉyÅ[ÉWÇï\é¶
        Call WLS_DspPage
    End If

End Sub
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_DspPage
    '   äTóvÅF  ÉäÉXÉgï“èWèàóù
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub WLS_DspPage()
    Dim WL_Mode As Integer
    Dim intCnt     As Integer

    LST.Clear

    'ï\é¶ÉfÅ[É^óLñ≥É`ÉFÉbÉN
    If UBound(WM_WLS_DSPArray) <= 0 Then
        Exit Sub
    End If
    
    intCnt = 0
    'ñæç◊çsêîï™ÉãÅ[Év
    Do While intCnt < WM_WLS_MAX
        'WM_WLS_Pagecnt = ÉyÅ[ÉWêî - 1 Ç™ê›íËÇ≥ÇÍÇƒÇ¢ÇÈ
        If Trim(WM_WLS_DSPArray(WM_WLS_Pagecnt * WM_WLS_MAX + intCnt)) > "" Then
            LST.AddItem WM_WLS_DSPArray(WM_WLS_Pagecnt * WM_WLS_MAX + intCnt)
        End If
        intCnt = intCnt + 1
    Loop
    If LST.ListCount > 0 Then
        LST.ListIndex = 0
' === 20061228 === INSERT S - ACE)Nagasawa
                On Error Resume Next
' === 20061228 === INSERT E -
        LST.SetFocus
    End If
End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_SetArray
    '   äTóvÅF  ÉäÉXÉgï“èW
    '   à¯êîÅFÅ@ArrayCnt : ÉäÉXÉgï“èWëŒè€INDEX
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub WLS_SetArray(ByVal ArrayCnt As Integer)

    With pv_DB_JDNTHA_W
' === 20070223 === UPDATE S - ACE)Nagasawa éÛíçì˙ïtä÷òAèCê≥
'        WM_WLS_DSPArray(ArrayCnt) = LeftWid$(.JDNNO, 8) & Space(1) & _
'                                    LeftWid$(.JDNTRKBNM, 10) & Space(1) & _
'                                    LeftWid$(.JDNDT, 10) & Space(1) & _
'                                    LeftWid$(.TOKRN, 40) & Space(1) & _
'                                    LeftWid$(Trim(.KENNMA) & Trim(.KENNMB), 40)
        WM_WLS_DSPArray(ArrayCnt) = LeftWid$(.JDNNO, 8) & Space(1) & _
                                    LeftWid$(.JDNTRKBNM, 10) & Space(1) & _
                                    LeftWid$(.DENDT, 10) & Space(1) & _
                                    LeftWid$(.TOKRN, 40) & Space(1) & _
                                    LeftWid$(Trim(.KENNMA) & Trim(.KENNMB), 40)
' === 20070223 === UPDATE E -
    End With
                                
End Sub

Private Function F_Get_JDNTHA() As Integer

    Dim intRet          As Integer
    Dim strSQL          As String
    Dim strTANCD        As String
    Dim strJdnNo        As String
    Dim strJDNTRKB      As String
    Dim strJDNDT        As String
    Dim strTOKCD        As String
    Dim strKENNMA       As String

    On Error GoTo F_Get_JDNTHA_Err

    intRet = 99
    
    'âcã∆íSìñé“ÉRÅ[ÉhÇâÊñ Ç©ÇÁéÊìæ
    strTANCD = CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_TANCD.Tag))
    
    'éÛíçî‘çÜÇâÊñ Ç©ÇÁéÊìæ
    strJdnNo = CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_JDNNO.Tag))
    
    'éÛíçéÊà¯ãÊï™ÇâÊñ Ç©ÇÁéÊìæ
    strJDNTRKB = CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_JDNTRKB.Tag))
    
    'éÛíçì˙ïtÇâÊñ Ç©ÇÁéÊìæ
    strJDNDT = CF_Ora_Date(CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_JDNDT.Tag)))
    
    'ìæà”êÊÉRÅ[ÉhÇâÊñ Ç©ÇÁéÊìæ
    strTOKCD = CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_TOKCD.Tag))
    
    'åèñºÇâÊñ Ç©ÇÁéÊìæ
    strKENNMA = CF_Get_Item_Value(Main_Inf.Dsp_Sub_Inf(HD_KENNMA.Tag))
    
    strSQL = ""
    strSQL = strSQL & " SELECT "
    strSQL = strSQL & "  JDNTHA.JDNNO   AS JDNTHA_JDNNO"        'éÛíçî‘çÜ
    strSQL = strSQL & ", JDNTHA.JDNDT   AS JDNTHA_JDNDT"        'éÛíçì`ï[ì˙ït
    strSQL = strSQL & ", JDNTHA.DENDT   AS JDNTHA_DENDT"        'éÛíçì˙ït
    strSQL = strSQL & ", JDNTHA.JDNTRKB AS JDNTHA_JDNTRKB"      'éÛíçéÊà¯ãÊï™
    strSQL = strSQL & ", JDNTHA.KENNMA  AS JDNTHA_KENNMA"       'åèñºÇP
    strSQL = strSQL & ", JDNTHA.KENNMB  AS JDNTHA_KENNMB"       'åèñºÇQ
    strSQL = strSQL & ", TOKMTA.TOKRN   AS TOKMTA_TOKRN"        'ìæà”êÊó™èÃ
    strSQL = strSQL & ", MEIMTA.MEINMA  AS MEIMTA_JDNTRKBNM"    'éÛíçéÊà¯ãÊï™ñºèÃ
' === 20061109 === UPDATE S - ACE)Nagasawa ÉåÉXÉ|ÉìÉXëŒâû
'' === 20060906 === UPDATE S - ACE)Nagasawa ê‘çïëŒâû
''    strSQL = strSQL & " FROM JDNTHA"
'    strSQL = strSQL & " FROM JDNTHV JDNTHA"
'' === 20060906 === UPDATE E -
    strSQL = strSQL & " FROM JDNTHA "
    strSQL = strSQL & " ,    (SELECT MAX(DATNO) AS MAX_DATNO "
    strSQL = strSQL & "         FROM JDNTHA "
    strSQL = strSQL & "        WHERE DATKB = '" & gc_strDATKB_USE & "' "
    strSQL = strSQL & "        GROUP BY JDNNO ) THA_SUB "
' === 20061109 === UPDATE E -
    strSQL = strSQL & ",     TOKMTA"
    strSQL = strSQL & ",     MEIMTA"
' === 20061109 === UPDATE S - ACE)Nagasawa ÉåÉXÉ|ÉìÉXëŒâû
'    strSQL = strSQL & " WHERE JDNTHA.TOKCD     = TOKMTA.TOKCD (+)"
    strSQL = strSQL & " WHERE JDNTHA.DATNO     = THA_SUB.MAX_DATNO "
    strSQL = strSQL & " AND   JDNTHA.AKAKROKB  = '" & gc_strDATKB_USE & "' "
    strSQL = strSQL & " AND   JDNTHA.TOKCD     = TOKMTA.TOKCD (+)"
' === 20061109 === UPDATE E -
    strSQL = strSQL & " AND   JDNTHA.JDNTRKB   = MEIMTA.MEICDA (+)"
    strSQL = strSQL & " AND   JDNTHA.DATKB     = '" & gc_strDATKB_USE & "'"
    strSQL = strSQL & " AND   TOKMTA.DATKB (+) = '" & gc_strDATKB_USE & "'"
    strSQL = strSQL & " AND   MEIMTA.DATKB (+) = '" & gc_strDATKB_USE & "'"
    strSQL = strSQL & " AND   MEIMTA.KEYCD (+) = '" & gc_strKEYCD_JDNTRKB & "'"
    
' === 20060930 === INSERT S - ACE)Nagasawa äCäOëŒâû
    If Trim(WLSJDN_FRNB) <> "" Then
        strSQL = strSQL & " AND   JDNTHA.FRNKB   = '" & CF_Ora_String(WLSJDN_FRNB, 1) & "' "
    End If
' === 20060930 === INSERT E -
    
    'âcã∆íSìñé“ÉRÅ[Éh
    If Trim(strTANCD) <> "" Then
        strSQL = strSQL & " AND JDNTHA.TANCD   = '" & CF_Ora_String(strTANCD, 6) & "'"
    End If
    
    'éÛíçî‘çÜ
    If Trim(strJdnNo) <> "" Then
        strSQL = strSQL & " AND JDNTHA.JDNNO  >= '" & CF_Ora_String(strJdnNo, 10) & "'"
    End If
    
    'éÛíçéÊà¯ãÊï™
    If Trim(strJDNTRKB) <> "" Then
        strSQL = strSQL & " AND JDNTHA.JDNTRKB = '" & CF_Ora_String(strJDNTRKB, 2) & "'"
    End If
    
    'éÛíçì˙ït
    If Trim(strJDNDT) <> "" Then
' === 20070223 === UPDATE S - ACE)Nagasawa éÛíçì˙ïtä÷òAèCê≥
'        strSQL = strSQL & " AND JDNTHA.JDNDT  >= '" & CF_Ora_String(strJDNDT, 8) & "'"
        strSQL = strSQL & " AND JDNTHA.DENDT  >= '" & CF_Ora_String(strJDNDT, 8) & "'"
' === 20070223 === UPDATE E -
    End If
    
    'ìæà”êÊÉRÅ[Éh
    If Trim(strTOKCD) <> "" Then
        strSQL = strSQL & " AND JDNTHA.TOKCD   = '" & CF_Ora_String(strTOKCD, 10) & "'"
    End If
    
    'åèñº
    If Trim(strKENNMA) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'        strSQL = strSQL & " AND JDNTHA.KENNMA || JDNTHA.KENNMB LIKE '%" & Trim(strKENNMA) & "%'"
        strSQL = strSQL & " AND JDNTHA.KENNMA || JDNTHA.KENNMB LIKE '%" & CF_Ora_String(Trim(strKENNMA), CF_Ctr_AnsiLenB(Trim(strKENNMA))) & "%'"
' === 20080929 === UPDATE E -
    End If

    strSQL = strSQL & " ORDER BY "
    strSQL = strSQL & "  JDNTHA_JDNNO"

    If Dyn_Open = True Then
        'ÉIÅ[ÉvÉìÇµÇƒÇ¢ÇΩÇÁÉNÉçÅ[ÉY
        Call CF_Ora_CloseDyn(Usr_Ody)
        Dyn_Open = False
    End If
    
    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSQL)
    Dyn_Open = True
    
    If CF_Ora_EOF(Usr_Ody) = True Then
        LST.Clear
    End If

    intRet = 0

F_Get_JDNTHA_End:

    F_Get_JDNTHA = intRet
    Exit Function

F_Get_JDNTHA_Err:

    intRet = 99
    GoTo F_Get_JDNTHA_End

End Function

' === 20060922 === INSERT S - ACE)Sejima
Private Sub Panel3D1_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Debug.Print "Panel3D1_MouseUp"
    Call Ctl_Item_MouseUp(Panel3D1, Button, Shift, X, Y)
End Sub
' === 20060922 === INSERT E

