VERSION 5.00
Object = "{0D181820-63E5-11D1-8959-E995CE93D831}#2.3#0"; "Threed5.ocx"
Begin VB.Form WLSHIN 
   Appearance      =   0  'Ã◊Øƒ
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'å≈íË¿ﬁ≤±€∏ﬁ
   Caption         =   "êªïiåüçı"
   ClientHeight    =   6030
   ClientLeft      =   1920
   ClientTop       =   2370
   ClientWidth     =   11310
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   6030
   ScaleWidth      =   11310
   Begin VB.TextBox HD_HINKB 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   375
      IMEMode         =   2  'µÃ
      Left            =   1695
      MaxLength       =   1
      TabIndex        =   2
      Text            =   "9"
      Top             =   105
      Width           =   270
   End
   Begin VB.TextBox HD_CODE 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   375
      IMEMode         =   2  'µÃ
      Left            =   1680
      MaxLength       =   10
      TabIndex        =   9
      Text            =   "XXXXXXXX10"
      Top             =   540
      Width           =   1335
   End
   Begin VB.TextBox HD_KATA 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   375
      IMEMode         =   2  'µÃ
      Left            =   4920
      MaxLength       =   30
      TabIndex        =   5
      Text            =   "XXXXXXXXX1XXXXXXXXX2XXXXXXXXX3"
      Top             =   105
      Width           =   3690
   End
   Begin VB.ComboBox WLSKANA 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   360
      Left            =   10050
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   7
      Top             =   105
      Width           =   1230
   End
   Begin VB.TextBox HD_HINKBNM 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H00C0C0C0&
      Height          =   375
      IMEMode         =   2  'µÃ
      Left            =   1950
      MaxLength       =   16
      TabIndex        =   3
      TabStop         =   0   'False
      Text            =   "MMMMMMMM1MMMM16"
      Top             =   105
      Width           =   1920
   End
   Begin Threed5.SSPanel5 Panel3D4 
      Height          =   375
      Left            =   105
      TabIndex        =   8
      Top             =   540
      Width           =   1590
      _ExtentX        =   2805
      _ExtentY        =   661
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BevelOuter      =   1
      Caption         =   "äJénêªïi∫∞ƒﬁ"
      OutLine         =   -1  'True
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSPanel5 SSPanel51 
      Height          =   375
      Left            =   4110
      TabIndex        =   4
      Top             =   105
      Width           =   825
      _ExtentX        =   1455
      _ExtentY        =   661
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BevelOuter      =   1
      Caption         =   "å^éÆ"
      OutLine         =   -1  'True
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSPanel5 PNL_USENM 
      Height          =   375
      Index           =   3
      Left            =   8820
      TabIndex        =   6
      Top             =   105
      Width           =   1230
      _ExtentX        =   2170
      _ExtentY        =   661
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BevelOuter      =   1
      Caption         =   "ÉJÉiåüçı"
      OutLine         =   -1  'True
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 CS_HINKB 
      Height          =   375
      Left            =   105
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   105
      Width           =   1590
      _ExtentX        =   2805
      _ExtentY        =   661
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "è§ïiãÊï™   "
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSPanel5 WLSLABEL 
      Height          =   375
      Left            =   45
      TabIndex        =   10
      Top             =   1440
      Width           =   11220
      _ExtentX        =   19791
      _ExtentY        =   661
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   1
      BevelOuter      =   1
      Caption         =   "êªïi∫∞ƒﬁ    å^    éÆ                        ïi    ñº"
      OutLine         =   -1  'True
      RoundedCorners  =   0   'False
   End
   Begin VB.ListBox LST 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   3630
      ItemData        =   "WLS_HIN2_HIN10.frx":0000
      Left            =   45
      List            =   "WLS_HIN2_HIN10.frx":0007
      TabIndex        =   11
      Top             =   1800
      Width           =   11220
   End
   Begin VB.CommandButton WLSOK 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      Caption         =   "OK"
      Height          =   330
      Left            =   4726
      TabIndex        =   12
      Top             =   5535
      Width           =   915
   End
   Begin VB.CommandButton WLSCANCEL 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      Caption         =   "∑¨›æŸ"
      Height          =   330
      Left            =   5656
      TabIndex        =   13
      Top             =   5535
      Width           =   915
   End
   Begin Threed5.SSPanel5 Panel3D1 
      Height          =   1005
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   11505
      _ExtentX        =   20294
      _ExtentY        =   1773
      BackColor       =   12632256
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
   End
   Begin VB.Image IM_MAE 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   0
      Left            =   4455
      Picture         =   "WLS_HIN2_HIN10.frx":0069
      Top             =   6300
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_ATO 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   0
      Left            =   5355
      Picture         =   "WLS_HIN2_HIN10.frx":06BB
      Top             =   6300
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_ATO 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   1
      Left            =   5760
      Picture         =   "WLS_HIN2_HIN10.frx":0D0D
      Top             =   6300
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image IM_MAE 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Index           =   1
      Left            =   4860
      Picture         =   "WLS_HIN2_HIN10.frx":135F
      Top             =   6300
      Visible         =   0   'False
      Width           =   360
   End
   Begin VB.Image WLSMAE 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Left            =   4238
      Picture         =   "WLS_HIN2_HIN10.frx":19B1
      Top             =   5535
      Width           =   360
   End
   Begin VB.Image WLSATO 
      Appearance      =   0  'Ã◊Øƒ
      Height          =   330
      Left            =   6713
      Picture         =   "WLS_HIN2_HIN10.frx":2003
      Top             =   5535
      Width           =   360
   End
End
Attribute VB_Name = "WLSHIN"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
    '********************************************************************************
    '*  ÉVÉXÉeÉÄñºÅ@Å@Å@ÅF  êVëççáèÓïÒÉVÉXÉeÉÄ
    '*  ÉTÉuÉVÉXÉeÉÄñºÅ@ÅFÅ@îÃîÑÉVÉXÉeÉÄ
    '*  ã@î\Å@Å@Å@Å@Å@Å@ÅFÅ@åüçıÉEÉBÉìÉhÉE
    '*  ÉvÉçÉOÉâÉÄñºÅ@Å@ÅFÅ@êªïiåüçı
    '*  ÉvÉçÉOÉâÉÄÇhÇcÅ@ÅF  WLSSHIN
    '*  çÏê¨é“Å@Å@Å@Å@Å@ÅFÅ@ACE)í∑‡V
    '*  çÏê¨ì˙Å@Å@Å@Å@Å@ÅF  2006.05.12
    '*-------------------------------------------------------------------------------
    '*<01> YYYY.MM.DDÅ@ÅFÅ@èCê≥èÓïÒ
    '*     èCê≥é“
    '********************************************************************************
    
'************************************************************************************
'   PrivateíËêî
'************************************************************************************
    
    Private Const WM_WLSKEY_ZOKUSEI = "X"       'äJénÉRÅ[Éhì¸óÕëÆê´ [0,X]

'************************************************************************************
'   Privateïœêî
'************************************************************************************
    'ÉEÉBÉìÉh’∞ªﬁ∞ê›íËïœêî
    Private WM_WLS_MFIL         As Integer          'ÉEÉBÉìÉhï\é¶“≤›Ãß≤Ÿ
    Private WM_WLS_CODELEN      As Integer          'äJénêªïi∫∞ƒﬁì¸óÕï∂éöêî
    Private WM_WLS_HINNMALEN    As Integer          'å^éÆì¸óÕï∂éöêî
    Private WM_WLS_HINNMBLEN    As Integer          'ïiñºï\é¶ï∂éöêî
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
    Private WM_WLS_HINKBLEN     As Integer          'è§ïiãÊï™ï∂éöêî
    Private WM_WLS_HINKBNMLEN   As Integer          'è§ïiãÊï™ñºï∂éöêî
' === 20061205 === INSERT E -

    'ÉEÉBÉìÉhì‡ïîégópïœêî
    Private WM_WLS_MAX          As Integer          'ÇPâÊñ ÇÃï\é¶åèêî
    Private WM_WLS_CODE         As String           'êªïiÉRÅ[Éhåüçıóp
    Private WM_WLS_HINNMA       As String           'å^éÆåüçıóp
    Private WM_WLS_HINNK_S      As String           'è§ïiñºÉJÉiåüçıóp(äJén)
    Private WM_WLS_HINNK_E      As String           'è§ïiñºÉJÉiåüçıóp(èIóπ)
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
    Private WM_WLS_HINKB        As String           'è§ïiãÊï™
' === 20061205 === INSERT E -
    Private WM_WLS_Pagecnt      As Integer          'ÉEÉBÉìÉhï\é¶ÉyÅ[ÉWÉJÉEÉìÉ^
    Private WM_WLS_LastPage     As Integer          'ÉEÉBÉìÉhç≈èIÉyÅ[ÉW
    Private WM_WLS_LastFL       As Boolean          'ÉEÉBÉìÉhç≈èIÉfÅ[É^ìûíBÉtÉâÉO
    Private WM_WLS_DSPArray()   As String           'ÉEÉBÉìÉhï\é¶ÉfÅ[É^
    Private WM_WLS_Dspflg       As Integer          'ÉEÉBÉìÉhï\é¶Ã◊∏ﬁ(True or False)

    Private DblClickFl As Boolean
    
    Private Usr_Ody             As U_Ody            '√ﬁ∞¿Õﬁ∞ΩèÓïÒ√∞ÃﬁŸ
    Private DB_HINMTA_W         As TYPE_DB_HINMTA
    Private Dyn_Open            As Boolean          'É_ÉCÉiÉZÉbÉgèÛë‘ÅiTrue:Open False:Close)
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
    Private bolInitWindow       As Boolean          'âÊñ èâä˙âªÉtÉâÉO(True:èâä˙âª)
' === 20061205 === INSERT E -
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_FORM_INIT
    '   äTóvÅF  âÊñ èâä˙âª
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    Private Sub WLS_FORM_INIT()
        '=== ï\é¶äJénÉRÅ[ÉhåÖêîê›íË ===
'''' UPD 2009/02/19  FKS) S.Nakajima    Start
'        WM_WLS_CODELEN = 8
        WM_WLS_CODELEN = 10
'''' UPD 2009/02/19  FKS) S.Nakajima    End
        WM_WLS_HINNMALEN = 30
' === 20060902 === UPDATE S - ACE)Nagasawa
'        WM_WLS_HINNMBLEN = 30
        WM_WLS_HINNMBLEN = 50
' === 20060902 === UPDATE E -
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
        WM_WLS_HINKBLEN = 1
        WM_WLS_HINKBNMLEN = 6
' === 20061205 === INSERT E -
        WM_WLS_MAX = 15                 'âÊñ ï\é¶åèêî
        
        'ïœêîèâä˙âª
        WLSHIN_RTNCODE = ""
        Call WLS_Clear
        Dyn_Open = False

    End Sub


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_SetArray
    '   äTóvÅF  ÉäÉXÉgï“èW
    '   à¯êîÅFÅ@ArrayCnt : ÉäÉXÉgï“èWëŒè€INDEX
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+

    Private Sub WLS_SetArray(ByVal ArrayCnt As Integer)

        WM_WLS_DSPArray(ArrayCnt) = LeftWid$(DB_HINMTA_W.HINCD, WM_WLS_CODELEN) & Space(2) & _
                                    LeftWid$(DB_HINMTA_W.HINNMA, WM_WLS_HINNMALEN) & Space(2) & _
                                    LeftWid$(DB_HINMTA_W.HINNMB, WM_WLS_HINNMBLEN)
                                    
    End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_TextSQL
    '   äTóvÅF  åüçısqlçÏê¨
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    Sub WLS_TextSQL()

        Dim strSQL          As String
        Dim intData         As Integer

        strSQL = ""
' === 20081205 === UPDATE S - ACE)Nagasawa ÉåÉXÉ|ÉìÉXëŒâû
'D        strSQL = strSQL & " Select HINCD "          'êªïiÉRÅ[Éh
        strSQL = strSQL & " Select "

        'ÉqÉìÉgãÂÇÃï“èW
        Select Case True
            'ì¸óÕåüçıèåèÇ™Ç»Ç¢èÍçáÅAéÂÉLÅ[åüçı
            Case Trim(WM_WLS_CODE) & Trim(WM_WLS_HINNMA) & Trim(WM_WLS_HINNK_S) & Trim(WM_WLS_HINKB) = ""
                If Trim(WLSHIN_SKHINGRP) <> "" Then
                    strSQL = strSQL & "        /*+ INDEX (HINMTA X_HINMTA07) */ "
                Else
                    strSQL = strSQL & "        /*+ INDEX (HINMTA X_HINMTA01) */ "
                End If
            'ÉJÉiÇ™éwíËÇ≥ÇÍÇƒÇ¢ÇÈèÍçáÅAÉLÅ[ÇOÇQÇ≈åüçı
            Case Trim(WM_WLS_HINNK_S) <> ""
                strSQL = strSQL & "        /*+ INDEX (HINMTA X_HINMTA02) */ "

            'äJénêªïiÉRÅ[ÉhÇ™éwíËÇ≥ÇÍÇƒÇ¢ÇÈèÍçáÅAéÂÉLÅ[Ç≈åüçı
            Case Trim(WM_WLS_CODE) <> ""
                strSQL = strSQL & "        /*+ INDEX (HINMTA X_HINMTA01) */ "

            'å^éÆÇ™ÇPï∂éöÇÃÇ›Ç≈ÇÃèÍçáÇÕéÂÉLÅ[Ç≈åüçı
            Case Len(Trim(WM_WLS_HINNMA)) = 1 _
             And Trim(WM_WLS_CODE) & Trim(WM_WLS_HINNK_S) & Trim(WM_WLS_HINKB) = ""
                strSQL = strSQL & "        /*+ INDEX (HINMTA X_HINMTA01) */ "
            
            'è„ãLà»äOÇÃèÍçáÇÕï“èWÇ»ÇµÅiÉLÅ[ÇOÇUÇ™égópÇ≥ÇÍÇÈÅHÅHÅj
            Case Else

        End Select

        strSQL = strSQL & "        HINCD "          'êªïiÉRÅ[Éh
' === 20081205 === UPDATE E - ACE)Nagasawa
        strSQL = strSQL & "      , HINNMA "         'å^éÆ
        strSQL = strSQL & "      , HINNMB "         'è§ïiñº
' === 20060726 === INSERT S - ACE)Nagasawa
        strSQL = strSQL & "      , HINNK "          'è§ïiñºÉJÉi
' === 20060726 === INSERT E -
        strSQL = strSQL & "   from HINMTA "
        strSQL = strSQL & "  Where DATKB    = '" & gc_strDATKB_USE & "' "
        strSQL = strSQL & "    and DSPKB    = '" & gc_strDSPKB_OK & "' "
'        strSQL = strSQL & "    and MNTENDKB = '" & gc_strMNTENDKB_NML & "' "
'        strSQL = strSQL & "    and SLENDKB  = '" & gc_strSLENDKB_NML & "' "
'        strSQL = strSQL & "    and JODSTPKB = '" & gc_strJODSTPKB_NML & "' "

        'êªïiÉRÅ[Éhåüçı
        If Trim(WM_WLS_CODE) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'            strSQL = strSQL & "    and HINCD >=   '" & WM_WLS_CODE & "'"
            strSQL = strSQL & "    and HINCD >=   '" & CF_Ora_String(WM_WLS_CODE, CF_Ctr_AnsiLenB(WM_WLS_CODE)) & "'"
' === 20080929 === UPDATE E -
        End If

        'å^éÆåüçı(Ç†Ç¢Ç‹Ç¢åüçı)
        If Trim(WM_WLS_HINNMA) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'            strSQL = strSQL & "    and HINNMA LIKE '%" & WM_WLS_HINNMA & "%'"
            strSQL = strSQL & "    and HINNMA LIKE '%" & CF_Ora_String(WM_WLS_HINNMA, CF_Ctr_AnsiLenB(WM_WLS_HINNMA)) & "%'"
' === 20080929 === UPDATE E -
        End If

        'è§ïiñºÉJÉiåüçı
        If Trim(WM_WLS_HINNK_S) <> "" Then
            strSQL = strSQL & "    and HINNK >= '" & WM_WLS_HINNK_S & "' And HINNK < '" & WM_WLS_HINNK_E & "'"
        End If

' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
        'è§ïiãÊï™åüçı
        If Trim(WM_WLS_HINKB) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'            strSQL = strSQL & "    and HINKB  = '" & WM_WLS_HINKB & "' "
            strSQL = strSQL & "    and HINKB  = '" & CF_Ora_String(WM_WLS_HINKB, CF_Ctr_AnsiLenB(WM_WLS_HINKB)) & "' "
' === 20080929 === UPDATE E -
        End If
' === 20061205 === INSERT E -

' === 20061026 === INSERT S - FKS)KUMEDA
        If Trim(WLSHIN_SKHINGRP) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'            strSQL = strSQL & "    and SKHINGRP = '" & WLSHIN_SKHINGRP & "' "
            strSQL = strSQL & "    and SKHINGRP = '" & CF_Ora_String(WLSHIN_SKHINGRP, CF_Ctr_AnsiLenB(WLSHIN_SKHINGRP)) & "' "
' === 20080929 === UPDATE E -
        End If
' === 20061026 === INSERT E

' === 20060828 === INSERT S - ACE)Sejima âºñ{ãÊï™ëŒâû
' === 20060829 === UPDATE S - ACE)Nagasawa
'        'âºñ{ãÊï™åüçıÅiÅ¶âÊñ ì¸óÕçÄñ⁄Ç≈Ç»Ç¢Åj
'        If Trim(WLSHIN_KHNKB) <> "" Then
'            strSQL = strSQL & "    and KHNKB = '" & WLSHIN_KHNKB & "'"
'        End If
        
        'ñ{êªïiÇÃÇ›åüçıÅiÅ¶âÊñ ì¸óÕçÄñ⁄Ç≈Ç»Ç¢Åj
        If Trim(WLSHIN_KHNSEARCH) <> "1" Then
            strSQL = strSQL & "    and KHNKB = '" & gc_strKHNKB_HON & "'"
        End If
        
' === 20060829 === UPDATE E -
' === 20060828 === INSERT E
        
        'ÉZÉbÉgÉAÉbÉvéÛíçìoò^ÅAí˘ê≥ÇÕïîïiè§ïiÉ}ÉXÉ^Ç‡çáÇÌÇπÇƒåüçı
        If Trim(WLSHIN_BHNSEARCH) = "1" Then
            strSQL = strSQL & " union "          'êªïiÉRÅ[Éh
            strSQL = strSQL & " Select HINCD "          'êªïiÉRÅ[Éh
            strSQL = strSQL & "      , HINNMA "         'å^éÆ
            strSQL = strSQL & "      , HINNMB "         'è§ïiñº
' === 20060726 === INSERT S - ACE)Nagasawa
            strSQL = strSQL & "      , HINNK "          'è§ïiñºÉJÉi
' === 20060726 === INSERT E -
            strSQL = strSQL & "   from BHNMTA "
            strSQL = strSQL & "  Where DATKB    = '" & gc_strDATKB_USE & "' "
            strSQL = strSQL & "    and DSPKB    = '" & gc_strDSPKB_OK & "' "
            strSQL = strSQL & "    and MNTENDKB = '" & gc_strMNTENDKB_NML & "' "
            strSQL = strSQL & "    and SLENDKB  = '" & gc_strSLENDKB_NML & "' "
            strSQL = strSQL & "    and JODSTPKB = '" & gc_strJODSTPKB_NML & "' "
    
            'êªïiÉRÅ[Éhåüçı
            If Trim(WM_WLS_CODE) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'                strSQL = strSQL & "    and HINCD >=   '" & WM_WLS_CODE & "'"
                strSQL = strSQL & "    and HINCD >=   '" & CF_Ora_String(WM_WLS_CODE, CF_Ctr_AnsiLenB(WM_WLS_CODE)) & "'"
' === 20080929 === UPDATE E -
            End If
    
            'å^éÆåüçı(Ç†Ç¢Ç‹Ç¢åüçı)
            If Trim(WM_WLS_HINNMA) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'                strSQL = strSQL & "    and HINNMA LIKE '%" & WM_WLS_HINNMA & "%'"
                strSQL = strSQL & "    and HINNMA LIKE '%" & CF_Ora_String(WM_WLS_HINNMA, CF_Ctr_AnsiLenB(WM_WLS_HINNMA)) & "%'"
' === 20080929 === UPDATE E -
            End If
    
            'è§ïiñºÉJÉiåüçı
            If Trim(WM_WLS_HINNK_S) <> "" Then
                strSQL = strSQL & "    and HINNK >= '" & WM_WLS_HINNK_S & "' And HINNK < '" & WM_WLS_HINNK_E & "'"
            End If
            
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
            'è§ïiãÊï™åüçı
            If Trim(WM_WLS_HINKB) <> "" Then
' === 20080929 === UPDATE S - ACE)Nagasawa ÉVÉìÉOÉãÉNÉHÅ[ÉeÅ[ÉVÉáÉìëŒâû
'                strSQL = strSQL & "    and HINKB  = '" & WM_WLS_HINKB & "' "
                strSQL = strSQL & "    and HINKB  = '" & CF_Ora_String(WM_WLS_HINKB, CF_Ctr_AnsiLenB(WM_WLS_HINKB)) & "' "
' === 20080929 === UPDATE E -
            End If
' === 20061205 === INSERT E -

        End If
        'É\Å[Égèåè
        strSQL = strSQL & "   order by "
        If Trim(WM_WLS_HINNK_S) <> "" Then
        'è§ïiñºÉJÉiåüçıÇÃèÍçá
            strSQL = strSQL & "   HINNK "
            strSQL = strSQL & "  ,HINCD "
        Else
        'êªïiÉRÅ[Éhåüçı,å^éÆåüçı
            strSQL = strSQL & "   HINCD "
        End If

        If Dyn_Open = True Then
            'ÉNÉçÅ[ÉY
            Call CF_Ora_CloseDyn(Usr_Ody)
            Dyn_Open = False
        End If
        
        'DBÉAÉNÉZÉX
        Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSQL)
        Dyn_Open = True
' === 20060726 === INSERT S - ACE)Nagasawa
        LST.Clear
' === 20060726 === INSERT E -

    End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_DspNew
    '   äTóvÅF  ÉäÉXÉgï“èWèàóù(èâä˙èÓïÒ)
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub WLS_DspNew()
    Dim Cnt             As Long
    
    Cnt = 0
    Do Until CF_Ora_EOF(Usr_Ody) = True
        
        'éÊìæì‡óeëﬁî
        DB_HINMTA_W.HINCD = CF_Ora_GetDyn(Usr_Ody, "HINCD", "")              'êªïiÉRÅ[Éh
        DB_HINMTA_W.HINNMA = CF_Ora_GetDyn(Usr_Ody, "HINNMA", "")             'å^éÆ
        DB_HINMTA_W.HINNMB = CF_Ora_GetDyn(Usr_Ody, "HINNMB", "")             'è§ïiñº
        
        'ï\é¶â¸ÉyÅ[ÉW
        If Cnt Mod WM_WLS_MAX = 0 Then
            WM_WLS_Pagecnt = WM_WLS_Pagecnt + 1
            ReDim Preserve WM_WLS_DSPArray((WM_WLS_Pagecnt + 1) * WM_WLS_MAX)
            Cnt = 0
            'ç≈èIÉyÅ[ÉWëﬁî
            WM_WLS_LastPage = WM_WLS_Pagecnt
        End If
    
        'ï\é¶ÉÅÉÇÉäìWäJ
        Call WLS_SetArray(WM_WLS_Pagecnt * WM_WLS_MAX + Cnt)
        
        Cnt = Cnt + 1
        
        Call CF_Ora_MoveNext(Usr_Ody)
        
        If Cnt >= WM_WLS_MAX Then
            Exit Do
        End If
    Loop
    
    'ç≈èIÉfÅ[É^ìûíB
    If CF_Ora_EOF(Usr_Ody) = True Then
        WM_WLS_LastFL = True
    End If
    
    If Cnt > 0 Then
        'ÉyÅ[ÉWÇï\é¶
        Call WLS_DspPage
    End If

End Sub
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_DspPage
    '   äTóvÅF  ÉäÉXÉgï“èWèàóù
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    Private Sub WLS_DspPage()
        Dim WL_Mode As Integer
        Dim intCnt     As Integer

        If UBound(WM_WLS_DSPArray) <= 0 Then
            Exit Sub
        End If

        LST.Clear
        intCnt = 0
        Do While intCnt < WM_WLS_MAX
            If Trim(WM_WLS_DSPArray(WM_WLS_Pagecnt * WM_WLS_MAX + intCnt)) > "" Then
                LST.AddItem WM_WLS_DSPArray(WM_WLS_Pagecnt * WM_WLS_MAX + intCnt)
            End If
            intCnt = intCnt + 1
        Loop
        If LST.ListCount > 0 Then
            LST.ListIndex = 0
' === 20061228 === INSERT S - ACE)Nagasawa
                        On Error Resume Next
' === 20061228 === INSERT E -
            LST.SetFocus
        End If
    End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_Kana_Init
    '   äTóvÅF  ÉJÉiÉRÉìÉ{É{ÉbÉNÉXèâä˙âª
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    Sub WLS_Kana_Init()

        'ÉJÉiåüçı Combo èâä˙âª
        WLSKANA.AddItem "ÉRÅ[Éh"
        WLSKANA.AddItem "ÉAçs      ±µ"
        WLSKANA.AddItem "ÉJçs      ∂∫"
        WLSKANA.AddItem "ÉTçs      ªø"
        WLSKANA.AddItem "É^çs      ¿ƒ"
        WLSKANA.AddItem "Éiçs      ≈…"
        WLSKANA.AddItem "Énçs       Œ"
        WLSKANA.AddItem "É}çs      œ”"
        WLSKANA.AddItem "ÉÑçs      ‘÷"
        WLSKANA.AddItem "Éâçs      ◊€"
        WLSKANA.AddItem "Éèçs      ‹›"

    End Sub

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub WLS_Clear
    '   äTóvÅF  ïœêîèâä˙âª
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    Sub WLS_Clear()

        'åüçıèåè
        WM_WLS_CODE = ""
        WM_WLS_HINNMA = ""
        WM_WLS_HINNK_S = ""
        WM_WLS_HINNK_E = ""
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
        WM_WLS_HINKB = ""
' === 20061205 === INSERT E -

        'âÊñ ï\é¶ÉyÅ[ÉW
        WM_WLS_Pagecnt = -1
        WM_WLS_LastPage = -1
        WM_WLS_LastFL = False

        'åüçıåãâ ï€éùîzóÒ
        ReDim WM_WLS_DSPArray(0)

    End Sub

'
'à»â∫ÇÕâÊñ ÉCÉxÉìÉgèàóù
'
    Private Sub Form_Activate()


' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
        If bolInitWindow = False Then
            Exit Sub
        Else
            bolInitWindow = False
        End If
' === 20061205 === INSERT E -

        'WINDOW à íuê›íË
        Left = (Screen.Width - Width) / 2
        Top = (Screen.Height - Height) / 2

        WM_WLS_Dspflg = False

        'çÄñ⁄èâä˙âª
        Call WLS_Kana_Init
        HD_CODE.Text = ""
        HD_KATA.Text = ""
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
        HD_HINKB.Text = ""
        HD_HINKBNM.Text = ""
' === 20061205 === INSERT E -
        WLSKANA.ListIndex = 0
        LST.Clear
        WM_WLS_Dspflg = True

        ReDim WM_WLS_DSPArray(0)

'''' UPD 2011/02/07  FKS) T.Yamamoto    Start    òAóçï[áÇFC11020701
'âÊñ ï\é¶éûÇ…åüçıÇµÇ»Ç¢
'        'èâä˙èÛë‘ëSåèï\é¶
'        Call WLS_TextSQL
'        Call WLS_DspNew
'ÉfÉtÉHÉãÉgÇ≈êªïiÇê›íË
        HD_HINKB.Text = "1"
        WM_WLS_HINKB = HD_HINKB.Text
        'è§ïiãÊï™ñºï“èW
        Call F_Dsp_HD_HINKBNM
'''' UPD 2011/02/07  FKS) T.Yamamoto    End
        
        DblClickFl = False
        
        Me.Refresh
'''' UPD 2011/02/07  FKS) T.Yamamoto    Start    òAóçï[áÇFC11020701
'' === 20060821 === UPDATE S - ACE)Nagasawa
''        HD_KATA.SetFocus
'' === 20061228 === INSERT S - ACE)Nagasawa
'                On Error Resume Next
'' === 20061228 === INSERT E -
'        LST.SetFocus
'' === 20060821 === UPDATE E -
    On Error Resume Next
        HD_KATA.SetFocus
'''' UPD 2011/02/07  FKS) T.Yamamoto    End
    End Sub

Private Sub Form_Load()
    'Windowèâä˙ê›íË
    Call WLS_FORM_INIT
' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
    bolInitWindow = True
' === 20061205 === INSERT E -
End Sub

Private Sub HD_CODE_GotFocus()
    If LenWid(HD_CODE.Text) > 0 Then
        HD_CODE.Text = SSS_EDTITM_WLS(HD_CODE.Text, HD_CODE.MaxLength, WM_WLSKEY_ZOKUSEI)
'---------- 20061019 ACE MENTE START ----------
'   Else
'       HD_CODE.Text = Space$(HD_CODE.MaxLength)
'---------- 20061019 ACE MENTE E N D ----------
    End If
    HD_CODE.SelStart = 0
    HD_CODE.SelLength = HD_CODE.MaxLength
End Sub

Private Sub HD_CODE_KeyDown(KEYCODE As Integer, Shift As Integer)
    If KEYCODE = vbKeyReturn Then
        WM_WLS_Dspflg = False
        HD_CODE.Text = SSS_EDTITM_WLS(HD_CODE.Text, HD_CODE.MaxLength, WM_WLSKEY_ZOKUSEI)

        'åüçıópïœêîÉZÉbÉg
        Call WLS_Clear
        WM_WLS_CODE = HD_CODE.Text
' === 20061211 === INSERT S - ACE)Nagasawa
        WM_WLS_HINKB = HD_HINKB.Text
' === 20061211 === INSERT E -

        'ëºåüçıèåèÉNÉäÉA
        WLSKANA.ListIndex = 0
        HD_KATA.Text = ""
        WM_WLS_Dspflg = True

        Call WLS_TextSQL
        Call WLS_DspNew
    End If
End Sub

Private Sub HD_CODE_KeyPress(KeyAscii As Integer)

    KeyAscii = Asc(UCase(Chr$(KeyAscii)))

End Sub

'2008/08/13 START ADD FKS)HAYASHI-òAóçï[áÇÅFFC08081301
Private Sub HD_KATA_Change()

    Dim lngCnt As Long
    
    lngCnt = HD_KATA.SelStart
    HD_KATA.Text = StrConv(HD_KATA.Text, vbUpperCase)
    HD_KATA.SelStart = lngCnt

End Sub
'2008/08/13 E.N.D ADD FKS)HAYASHI-òAóçï[áÇÅFFC08081301

Private Sub HD_KATA_GotFocus()
'---------- 20061019 ACE MENTE START ----------
'   If LenWid(HD_KATA.Text) <= 0 Then
'       HD_KATA.Text = Space$(HD_KATA.MaxLength)
'   End If
'---------- 20061019 ACE MENTE E N D ----------
    HD_KATA.SelStart = 0
    HD_KATA.SelLength = HD_KATA.MaxLength
End Sub

Private Sub HD_KATA_KeyDown(KEYCODE As Integer, Shift As Integer)
    If KEYCODE = vbKeyReturn Then
        WM_WLS_Dspflg = False

        'åüçıópïœêîÉZÉbÉg
        Call WLS_Clear
        WM_WLS_HINNMA = HD_KATA.Text
' === 20061211 === INSERT S - ACE)Nagasawa
        WM_WLS_HINKB = HD_HINKB.Text
' === 20061211 === INSERT E -

        'ëºåüçıèåèÉNÉäÉA
        WLSKANA.ListIndex = 0
        HD_CODE.Text = ""
        WM_WLS_Dspflg = True

        Call WLS_TextSQL
        Call WLS_DspNew
    End If
End Sub

Private Sub LST_DblClick()
    
    DblClickFl = True
    WLSHIN_RTNCODE = LeftWid$(LST.List(LST.ListIndex), WM_WLS_CODELEN)
    
End Sub

Private Sub LST_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    
    If DblClickFl Then Call WLSCANCEL_Click
    
End Sub

Private Sub LST_KeyDown(KEYCODE As Integer, Shift As Integer)
    
    Select Case KEYCODE
        'EnterÉLÅ[âüâ∫
        Case vbKeyReturn
            Call WLSOK_Click
            
        'EscapeÉLÅ[âüâ∫
        Case vbKeyEscape
            Call WLSCANCEL_Click
        
        'Å©ÉLÅ[âüâ∫
        Case vbKeyLeft
            Call WLSMAE_Click
            
        'Å®ÉLÅ[âüâ∫
        Case vbKeyRight
            Call WLSATO_Click
            If LST.ListCount > 0 Then
                LST.ListIndex = -1
            End If
    End Select
    
End Sub

    Private Sub WLSKANA_Click()
    Dim W_BUF
        If WM_WLS_Dspflg = False Then Exit Sub
        WM_WLS_Dspflg = False
        WM_WLS_Dspflg = True

        Call WLS_Clear

        'åüçıópïœêîÉZÉbÉg
        If WLSKANA.ListIndex > 0 Then
            W_BUF = Right$(WLSKANA.List(WLSKANA.ListIndex), 2)
            WM_WLS_HINNK_S = Left$(W_BUF, 1)
            WM_WLS_HINNK_E = Chr$(Asc(Right$(W_BUF, 1)) + 1)
' === 20061211 === INSERT S - ACE)Nagasawa
            WM_WLS_HINKB = HD_HINKB.Text
' === 20061211 === INSERT E -

            'ëºåüçıèåèÉNÉäÉA
            HD_CODE.Text = ""
            HD_KATA.Text = ""
            WM_WLS_Dspflg = True
    
            Call WLS_TextSQL
            Call WLS_DspNew
' === 20061211 === INSERT S - ACE)Nagasawa
        Else
            If WLSKANA.ListIndex = 0 Then
                WM_WLS_HINNK_S = ""
                WM_WLS_HINNK_E = ""
                WM_WLS_HINKB = HD_HINKB.Text
    
                'ëºåüçıèåèÉNÉäÉA
                HD_CODE.Text = ""
                HD_KATA.Text = ""
                WM_WLS_Dspflg = True
        
                Call WLS_TextSQL
                Call WLS_DspNew
            End If
' === 20061211 === INSERT E -
        End If

    End Sub

Private Sub WLSKANA_KeyDown(KEYCODE As Integer, Shift As Integer)
    If KEYCODE = vbKeyReturn Then
        WM_WLS_Dspflg = True
        Call WLSKANA_Click
    Else
        WM_WLS_Dspflg = False
    End If
End Sub

Private Sub WLSATO_Click()

    If LST.ListCount <= 0 Then Exit Sub

' === 20060728 === DELETE S - ACE)Furukawa
'    Call WLS_DspNew
' === 20060728 === DELETE E

    If WM_WLS_Pagecnt >= WM_WLS_LastPage Then
' === 20060728 === UPDATE S - ACE)Furukawa
'D        If Not WM_WLS_LastFL Then Call WLS_DspPage
' === 20060728 === UPDATE Å´
        If Not WM_WLS_LastFL Then Call WLS_DspNew
' === 20060728 === UPDATE E
    Else
        WM_WLS_Pagecnt = WM_WLS_Pagecnt + 1
        Call WLS_DspPage
    End If
End Sub

Private Sub WLSATO_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    WLSATO.Picture = IM_ATO(1).Picture
End Sub

Private Sub WLSATO_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    WLSATO.Picture = IM_ATO(0).Picture
End Sub

Private Sub WLSMAE_Click()
    If WM_WLS_Pagecnt > 0 Then
        WM_WLS_Pagecnt = WM_WLS_Pagecnt - 1
        Call WLS_DspPage
    End If
End Sub

Private Sub WLSMAE_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    WLSMAE.Picture = IM_MAE(1).Picture
End Sub

Private Sub WLSMAE_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    WLSMAE.Picture = IM_MAE(0).Picture
End Sub

Private Sub WLSOK_Click()

    WLSHIN_RTNCODE = LeftWid$(LST.List(LST.ListIndex), WM_WLS_CODELEN)
    Call WLSCANCEL_Click
    
End Sub

Private Sub WLSCANCEL_Click()
    If Dyn_Open = True Then
        'ÉNÉçÅ[ÉY
        Call CF_Ora_CloseDyn(Usr_Ody)
        Dyn_Open = False
    End If
    
    Hide
End Sub

' === 20061205 === INSERT S - ACE)Nagasawa åüçıèåèÇ…è§ïiãÊï™í«â¡
Private Sub HD_HINKB_GotFocus()
    If LenWid(HD_HINKB.Text) > 0 Then
        HD_HINKB.Text = SSS_EDTITM_WLS(HD_HINKB.Text, HD_HINKB.MaxLength, WM_WLSKEY_ZOKUSEI)
    End If
    HD_HINKB.SelStart = 0
    HD_HINKB.SelLength = HD_HINKB.MaxLength
End Sub

Private Sub HD_HINKB_KeyDown(KEYCODE As Integer, Shift As Integer)
    
    If KEYCODE = vbKeyReturn Then
        
' === 20061222 === INSERT S - ACE)Nagasawa
        'âÊñ ï\é¶ÉyÅ[ÉW
        WM_WLS_Pagecnt = -1
        WM_WLS_LastPage = -1
        WM_WLS_LastFL = False

        'åüçıåãâ ï€éùîzóÒ
        ReDim WM_WLS_DSPArray(0)
' === 20061222 === INSERT E -
        
        WM_WLS_Dspflg = False
        HD_HINKB.Text = SSS_EDTITM_WLS(HD_HINKB.Text, HD_HINKB.MaxLength, WM_WLSKEY_ZOKUSEI)

        'è§ïiãÊï™ñºï“èW
        Call F_Dsp_HD_HINKBNM
        
        WM_WLS_HINKB = HD_HINKB.Text

        WM_WLS_Dspflg = True

        Call WLS_TextSQL
        Call WLS_DspNew
    End If
End Sub

Private Sub HD_HINKB_KeyPress(KeyAscii As Integer)

    KeyAscii = Asc(UCase(Chr$(KeyAscii)))

End Sub

Private Sub HD_HINKB_LostFocus()

    WM_WLS_Dspflg = False
    HD_HINKB.Text = SSS_EDTITM_WLS(HD_HINKB.Text, HD_HINKB.MaxLength, WM_WLSKEY_ZOKUSEI)

    'è§ïiãÊï™ñºï“èW
    Call F_Dsp_HD_HINKBNM
    
    'åüçıópïœêîÉZÉbÉg
    WM_WLS_HINKB = HD_HINKB.Text

    WM_WLS_Dspflg = True
    
End Sub

Private Sub HD_HINKBNM_GotFocus()
    Call F_Ctl_HD_Focus
End Sub

Private Function F_Dsp_HD_HINKBNM() As Integer
    
    Dim Mst_Inf_MEI     As TYPE_DB_MEIMTA

    'è§ïiãÊï™ñºï“èW
    HD_HINKBNM.Text = ""
    If DSPMEIM_SEARCH(gc_strKEYCD_HINKB, HD_HINKB.Text, Mst_Inf_MEI) = 0 Then
        If Mst_Inf_MEI.DATKB = gc_strDATKB_USE Then
            HD_HINKBNM.Text = SSS_EDTITM_WLS(Mst_Inf_MEI.MEINMA, HD_HINKBNM.MaxLength, WM_WLSKEY_ZOKUSEI)
        End If
    End If
        
End Function

Private Function F_Ctl_HD_Focus() As Integer
    If LST.Enabled = True Then
' === 20061228 === INSERT S - ACE)Nagasawa
                On Error Resume Next
' === 20061228 === INSERT E -
        LST.SetFocus
    Else
        If WLSOK.Enabled = True Then
' === 20061228 === INSERT S - ACE)Nagasawa
                        On Error Resume Next
' === 20061228 === INSERT E -
            WLSOK.SetFocus
        End If
    End If
End Function

Private Sub CS_HINKB_Click()

' === 20061228 === INSERT S - ACE)Nagasawa
        On Error Resume Next
' === 20061228 === INSERT E -
    Me.HD_HINKB.SetFocus
    
    WLSMEI_KEYCD = gc_strKEYCD_HINKB
    
    DoEvents
    
    WLS_MEI.Show vbModal
    Unload WLS_MEI
        
    Set WLS_MEI = Nothing
    
    If Trim(WLSMEI_RTNMEICDA) <> "" Then
        'è§ïiãÊï™ï“èW
        HD_HINKB.Text = Trim(WLSMEI_RTNMEICDA)

        Call HD_HINKB_KeyDown(vbKeyReturn, 0)

    End If
    
End Sub
' === 20061205 === INSERT E -
