VERSION 5.00
Object = "{0D181820-63E5-11D1-8959-E995CE93D831}#2.3#0"; "Threed5.ocx"
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "spr32x30.ocx"
Begin VB.Form FR_SSSMAIN 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "ëOéÛè[ìññﬂÇµ"
   ClientHeight    =   10050
   ClientLeft      =   1455
   ClientTop       =   795
   ClientWidth     =   14520
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   9.75
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "URKET73.frx":0000
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   10050
   ScaleWidth      =   14520
   Begin Threed5.SSPanel5 pnl_syohizei 
      Height          =   330
      Left            =   4980
      TabIndex        =   57
      Top             =   2670
      Width           =   1410
      _ExtentX        =   2487
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BevelOuter      =   1
      Caption         =   "è¡îÔê≈ç∑äz"
      OutLine         =   -1  'True
   End
   Begin Threed5.SSPanel5 pnl_tesuryo 
      Height          =   330
      Left            =   3585
      TabIndex        =   55
      Top             =   2670
      Width           =   1410
      _ExtentX        =   2487
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BorderWidth     =   0
      BevelOuter      =   1
      Caption         =   "éËêîóø"
      OutLine         =   -1  'True
   End
   Begin VB.PictureBox img_bklight 
      AutoSize        =   -1  'True
      BorderStyle     =   0  'Ç»Çµ
      Height          =   330
      Index           =   1
      Left            =   585
      Picture         =   "URKET73.frx":030A
      ScaleHeight     =   330
      ScaleWidth      =   300
      TabIndex        =   38
      TabStop         =   0   'False
      Top             =   10140
      Width           =   300
   End
   Begin VB.PictureBox img_bklight 
      AutoSize        =   -1  'True
      BorderStyle     =   0  'Ç»Çµ
      Height          =   330
      Index           =   0
      Left            =   225
      Picture         =   "URKET73.frx":0494
      ScaleHeight     =   330
      ScaleWidth      =   300
      TabIndex        =   37
      TabStop         =   0   'False
      Top             =   10140
      Width           =   300
   End
   Begin FPSpread.vaSpread spd_body 
      Height          =   5880
      Left            =   75
      TabIndex        =   6
      Top             =   3405
      Width           =   14385
      _Version        =   196608
      _ExtentX        =   25374
      _ExtentY        =   10372
      _StockProps     =   64
      AllowUserFormulas=   -1  'True
      ColHeaderDisplay=   0
      ColsFrozen      =   1
      DisplayRowHeaders=   0   'False
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MaxCols         =   36
      MaxRows         =   9999
      NoBeep          =   -1  'True
      ScrollBars      =   2
      SpreadDesigner  =   "URKET73.frx":061E
      UserResize      =   2
      VisibleCols     =   36
      VisibleRows     =   9999
      ScrollBarTrack  =   1
   End
   Begin Threed5.SSCommand5 cmd_kesidt 
      Height          =   330
      Left            =   315
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   645
      Width           =   1695
      _ExtentX        =   2990
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "*è¡çû(è[ìñ)ì˙"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSPanel5 pnl_tail 
      Height          =   735
      Left            =   0
      TabIndex        =   8
      Top             =   9330
      Width           =   14535
      _ExtentX        =   25638
      _ExtentY        =   1296
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
      Begin VB.PictureBox img_light 
         AutoSize        =   -1  'True
         BorderStyle     =   0  'Ç»Çµ
         Height          =   330
         Left            =   150
         Picture         =   "URKET73.frx":1C225
         ScaleHeight     =   330
         ScaleWidth      =   300
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   135
         Width           =   300
      End
      Begin Threed5.SSPanel5 pnl_msg 
         Height          =   465
         Left            =   600
         TabIndex        =   22
         Top             =   135
         Width           =   12480
         _ExtentX        =   22013
         _ExtentY        =   820
         Enabled         =   0   'False
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Begin VB.TextBox txt_message 
            Appearance      =   0  'Ã◊Øƒ
            BackColor       =   &H8000000F&
            BorderStyle     =   0  'Ç»Çµ
            Height          =   195
            Left            =   105
            TabIndex        =   24
            TabStop         =   0   'False
            Text            =   "ÉGÉâÅ[Ç‚ÉvÉçÉìÉvÉgÇÃÉÅÉbÉZÅ[ÉWÇ™èoóÕÇ≥ÇÍÇÈÇ∆Ç±ÇÎÇ≈Ç∑ÅB"
            Top             =   90
            Width           =   12180
         End
      End
   End
   Begin Threed5.SSCommand5 cmd_tokseicd 
      Height          =   330
      Left            =   315
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   960
      Width           =   1695
      _ExtentX        =   2990
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "*êøãÅêÊ    "
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_kaidt_From 
      Height          =   330
      Left            =   315
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   1275
      Width           =   1695
      _ExtentX        =   2990
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   " *îÑè„ì˙(äJén)"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_fridt 
      Height          =   330
      Left            =   315
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   2010
      Visible         =   0   'False
      Width           =   1695
      _ExtentX        =   2990
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "êUçûä˙ì˙ "
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_tesuryo 
      Height          =   330
      Left            =   3585
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   2670
      Width           =   1410
      _ExtentX        =   2487
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "éËêîóø"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_syohi 
      Height          =   330
      Left            =   4980
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   2670
      Width           =   1410
      _ExtentX        =   2487
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "è¡îÔê≈ç∑äz"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_zenkesi 
      Height          =   330
      Left            =   11325
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   2670
      Width           =   1320
      _ExtentX        =   2328
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "ëSè¡çû"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_zenkaijo 
      Height          =   330
      Left            =   9930
      TabIndex        =   18
      TabStop         =   0   'False
      Top             =   2670
      Width           =   1320
      _ExtentX        =   2328
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "ëSâèú"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSCommand5 cmd_saihyoji 
      Height          =   330
      Left            =   12855
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   2670
      Width           =   1320
      _ExtentX        =   2328
      _ExtentY        =   582
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "çƒï\é¶"
      BevelWidth      =   1
      RoundedCorners  =   0   'False
   End
   Begin Threed5.SSPanel5 pnl_head 
      Height          =   555
      Left            =   0
      TabIndex        =   20
      Top             =   0
      Width           =   14535
      _ExtentX        =   25638
      _ExtentY        =   979
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      OutLine         =   -1  'True
      Begin Threed5.SSPanel5 pnl_unydt 
         Height          =   330
         Left            =   12525
         TabIndex        =   21
         Top             =   105
         Width           =   1680
         _ExtentX        =   2963
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "YYYY/MM/DD"
      End
      Begin VB.Image img_unlock 
         Height          =   330
         Left            =   1320
         Picture         =   "URKET73.frx":1C3AF
         Top             =   90
         Width           =   360
      End
      Begin VB.Image img_showwnd 
         Height          =   330
         Left            =   870
         Picture         =   "URKET73.frx":1C539
         Top             =   90
         Width           =   360
      End
      Begin VB.Image img_exit 
         Height          =   330
         Left            =   150
         Picture         =   "URKET73.frx":1C6C3
         Top             =   90
         Width           =   360
      End
      Begin VB.Image img_resist 
         Height          =   330
         Left            =   510
         Picture         =   "URKET73.frx":1C84D
         Top             =   90
         Width           =   360
      End
   End
   Begin Threed5.SSPanel5 pnl_condition1 
      Height          =   1860
      Left            =   60
      TabIndex        =   39
      Top             =   570
      Width           =   14310
      _ExtentX        =   25241
      _ExtentY        =   3281
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "èåèópÇP"
      Begin VB.PictureBox Picture2 
         Appearance      =   0  'Ã◊Øƒ
         BorderStyle     =   0  'Ç»Çµ
         Enabled         =   0   'False
         ForeColor       =   &H80000008&
         Height          =   405
         Left            =   11055
         ScaleHeight     =   405
         ScaleWidth      =   3180
         TabIndex        =   52
         Top             =   75
         Width           =   3180
         Begin VB.TextBox txt_opeid 
            Appearance      =   0  'Ã◊Øƒ
            BackColor       =   &H8000000F&
            Height          =   330
            Left            =   0
            TabIndex        =   54
            TabStop         =   0   'False
            Text            =   "XXXXXXX8"
            Top             =   0
            Width           =   915
         End
         Begin VB.TextBox txt_openm 
            Appearance      =   0  'Ã◊Øƒ
            BackColor       =   &H8000000F&
            Height          =   330
            Left            =   900
            TabIndex        =   53
            TabStop         =   0   'False
            Text            =   "MMMMMMMMM1MMMMMMMMM2"
            Top             =   0
            Width           =   2220
         End
      End
      Begin VB.Frame frm_opt1 
         Caption         =   "ø∞ƒèåè"
         Height          =   660
         Left            =   9690
         TabIndex        =   44
         Top             =   615
         Width           =   4560
         Begin VB.OptionButton opt_sort 
            Caption         =   "ãqêÊíçï∂î‘çÜ"
            Height          =   195
            Index           =   2
            Left            =   2790
            TabIndex        =   11
            TabStop         =   0   'False
            Top             =   285
            Width           =   1590
         End
         Begin VB.OptionButton opt_sort 
            Caption         =   "îÑè„ì˙"
            Height          =   270
            Index           =   0
            Left            =   255
            TabIndex        =   7
            TabStop         =   0   'False
            Top             =   255
            Width           =   1200
         End
         Begin VB.OptionButton opt_sort 
            Caption         =   "éÛíçî‘çÜ"
            Height          =   195
            Index           =   1
            Left            =   1485
            TabIndex        =   9
            TabStop         =   0   'False
            Top             =   285
            Width           =   1260
         End
      End
      Begin VB.TextBox txt_kaidt_To 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   4815
         MaxLength       =   10
         TabIndex        =   3
         Text            =   "YYYY/MM/DD"
         Top             =   705
         Width           =   1215
      End
      Begin VB.TextBox txt_kesikb 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   1935
         MaxLength       =   1
         TabIndex        =   4
         Text            =   "9"
         Top             =   1020
         Width           =   285
      End
      Begin VB.TextBox txt_kesidt 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   1935
         MaxLength       =   10
         TabIndex        =   0
         Text            =   "YYYY/MM/DD"
         Top             =   75
         Width           =   1215
      End
      Begin VB.TextBox txt_tokseicd 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   1935
         MaxLength       =   5
         TabIndex        =   1
         Text            =   "XXXX5"
         Top             =   390
         Width           =   1215
      End
      Begin VB.TextBox txt_kaidt_From 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   1935
         MaxLength       =   10
         TabIndex        =   2
         Text            =   "YYYY/MM/DD"
         Top             =   705
         Width           =   1215
      End
      Begin VB.TextBox txt_fridt 
         Appearance      =   0  'Ã◊Øƒ
         Height          =   330
         IMEMode         =   2  'µÃ
         Left            =   1935
         MaxLength       =   10
         TabIndex        =   5
         TabStop         =   0   'False
         Text            =   "YYYY/MM/DD"
         Top             =   1440
         Visible         =   0   'False
         Width           =   1215
      End
      Begin Threed5.SSPanel5 pnl_kesikb 
         Height          =   330
         Left            =   255
         TabIndex        =   40
         Top             =   1020
         Width           =   1695
         _ExtentX        =   2990
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "è[ìñçœ√ﬁ∞¿ï\é¶"
         OutLine         =   -1  'True
      End
      Begin Threed5.SSPanel5 pnl_condition2 
         Height          =   480
         Left            =   1920
         TabIndex        =   41
         Top             =   1020
         Width           =   450
         _ExtentX        =   794
         _ExtentY        =   847
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "èåèópÇQ"
      End
      Begin Threed5.SSCommand5 cmd_kaidt_To 
         Height          =   330
         Left            =   3135
         TabIndex        =   43
         TabStop         =   0   'False
         Top             =   705
         Width           =   1695
         _ExtentX        =   2990
         _ExtentY        =   582
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "*îÑè„ì˙(èIóπ)"
         BevelWidth      =   1
         RoundedCorners  =   0   'False
      End
      Begin Threed5.SSPanel5 pnl_opeid 
         Height          =   330
         Left            =   9810
         TabIndex        =   45
         Top             =   75
         Width           =   1260
         _ExtentX        =   2223
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "ì¸óÕíSìñé“"
         OutLine         =   -1  'True
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  'Ã◊Øƒ
         BorderStyle     =   0  'Ç»Çµ
         Enabled         =   0   'False
         ForeColor       =   &H80000008&
         Height          =   405
         Left            =   3135
         ScaleHeight     =   405
         ScaleWidth      =   6540
         TabIndex        =   50
         Top             =   390
         Width           =   6540
         Begin VB.TextBox txt_tokseinma 
            Appearance      =   0  'Ã◊Øƒ
            BackColor       =   &H8000000F&
            Height          =   330
            Left            =   0
            TabIndex        =   51
            TabStop         =   0   'False
            Text            =   "MMMMMMMMM1MMMMMMMMM2MMMMMMMMM3MMMMMMMMM4MMMMMMMMM5MMMMMMMMM6"
            Top             =   0
            Width           =   6465
         End
      End
      Begin VB.Label lbl_hytokkesdd 
         BackStyle       =   0  'ìßñæ
         Caption         =   "ññì˙"
         Height          =   420
         Index           =   1
         Left            =   11265
         TabIndex        =   49
         Top             =   1635
         Width           =   1995
      End
      Begin VB.Label lbl_hytokkesdd 
         BackStyle       =   0  'ìßñæ
         Caption         =   "âÒé˚ì˙  :"
         Height          =   420
         Index           =   0
         Left            =   10260
         TabIndex        =   48
         Top             =   1650
         Width           =   1995
      End
      Begin VB.Label lbl_shakbnm 
         BackStyle       =   0  'ìßñæ
         Caption         =   "êUçûÇ‹ÇΩÇÕéËå`"
         Height          =   420
         Index           =   1
         Left            =   11250
         TabIndex        =   47
         Top             =   1380
         Width           =   3000
      End
      Begin VB.Label lbl_shakbnm 
         BackStyle       =   0  'ìßñæ
         Caption         =   "éxï•èåè:"
         Height          =   420
         Index           =   0
         Left            =   10260
         TabIndex        =   46
         Top             =   1380
         Width           =   3000
      End
      Begin VB.Label lbl_b 
         Caption         =   "1:ï\é¶ÇµÇ»Ç¢  9:ï\é¶Ç∑ÇÈ"
         Height          =   300
         Left            =   2385
         TabIndex        =   42
         Top             =   1080
         Width           =   2850
      End
   End
   Begin Threed5.SSPanel5 pnl_hihyoji 
      Height          =   2805
      Left            =   150
      TabIndex        =   25
      Top             =   570
      Width           =   14265
      _ExtentX        =   25162
      _ExtentY        =   4948
      Enabled         =   0   'False
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "ï\é¶å¿íËÉeÉLÉXÉgÉ{ÉbÉNÉXê›íËópÉpÉlÉã"
      Begin VB.TextBox txt_urigoukei 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   165
         TabIndex        =   31
         TabStop         =   0   'False
         Text            =   "-9,999,999,999"
         Top             =   2415
         Width           =   1650
      End
      Begin VB.TextBox txt_nyukin 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   1800
         TabIndex        =   30
         TabStop         =   0   'False
         Text            =   "-9,999,999,999"
         Top             =   2415
         Width           =   1650
      End
      Begin VB.TextBox txt_nyugoukei 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   6225
         TabIndex        =   29
         TabStop         =   0   'False
         Text            =   "-9,999,999,999"
         Top             =   2415
         Width           =   1650
      End
      Begin VB.TextBox txt_kesizan 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   7860
         TabIndex        =   28
         TabStop         =   0   'False
         Text            =   "-9,999,999,999"
         Top             =   2415
         Width           =   1650
      End
      Begin VB.TextBox txt_tesuryo 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   3435
         TabIndex        =   27
         TabStop         =   0   'False
         Text            =   "-999,999"
         Top             =   2415
         Width           =   1410
      End
      Begin VB.TextBox txt_syohi 
         Alignment       =   1  'âEëµÇ¶
         Appearance      =   0  'Ã◊Øƒ
         BackColor       =   &H8000000F&
         Height          =   330
         Left            =   4830
         TabIndex        =   26
         TabStop         =   0   'False
         Text            =   "-999,999"
         Top             =   2415
         Width           =   1410
      End
      Begin Threed5.SSPanel5 pnl_urigoukei 
         Height          =   330
         Left            =   165
         TabIndex        =   32
         Top             =   2100
         Width           =   1650
         _ExtentX        =   2910
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "îÑè„çáåv"
         OutLine         =   -1  'True
      End
      Begin Threed5.SSPanel5 pnl_nyukin 
         Height          =   330
         Left            =   1800
         TabIndex        =   33
         Top             =   2100
         Width           =   1650
         _ExtentX        =   2910
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "ëOéÛì¸ã‡äz"
         OutLine         =   -1  'True
      End
      Begin Threed5.SSPanel5 pnl_nyugoukei 
         Height          =   330
         Left            =   6225
         TabIndex        =   34
         Top             =   2100
         Width           =   1650
         _ExtentX        =   2910
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "ëOéÛì¸ã‡çáåv"
         OutLine         =   -1  'True
      End
      Begin Threed5.SSPanel5 pnl_kesizan 
         Height          =   330
         Left            =   7860
         TabIndex        =   35
         Top             =   2100
         Width           =   1650
         _ExtentX        =   2910
         _ExtentY        =   582
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
         Caption         =   "è[ìñécäz"
         OutLine         =   -1  'True
      End
      Begin VB.Label lbl_c 
         Caption         =   "ÅÉè¡çûèÓïÒÅÑ"
         Height          =   300
         Left            =   0
         TabIndex        =   36
         Top             =   1860
         Width           =   1455
      End
   End
   Begin Threed5.SSPanel5 SSPanel51 
      Height          =   330
      Left            =   0
      TabIndex        =   56
      Top             =   0
      Width           =   1410
      _ExtentX        =   2487
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BorderWidth     =   0
      BevelOuter      =   1
      Caption         =   "éËêîóø"
      OutLine         =   -1  'True
   End
   Begin VB.Image img_bkunlock 
      Height          =   330
      Index           =   0
      Left            =   3489
      Picture         =   "URKET73.frx":1CE9F
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkunlock 
      Height          =   330
      Index           =   1
      Left            =   3915
      Picture         =   "URKET73.frx":1D029
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkshowwnd 
      Height          =   330
      Index           =   1
      Left            =   3066
      Picture         =   "URKET73.frx":1D1B3
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkshowwnd 
      Height          =   330
      Index           =   0
      Left            =   2643
      Picture         =   "URKET73.frx":1D33D
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkexit 
      Height          =   330
      Index           =   1
      Left            =   1374
      Picture         =   "URKET73.frx":1D4C7
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkexit 
      Height          =   330
      Index           =   0
      Left            =   951
      Picture         =   "URKET73.frx":1D651
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkresist 
      Height          =   330
      Index           =   1
      Left            =   2220
      Picture         =   "URKET73.frx":1D7DB
      Top             =   10140
      Width           =   360
   End
   Begin VB.Image img_bkresist 
      Height          =   330
      Index           =   0
      Left            =   1797
      Picture         =   "URKET73.frx":1DE2D
      Top             =   10140
      Width           =   360
   End
   Begin VB.Menu mnu_syo 
      Caption         =   "èàóù(&1)"
      Begin VB.Menu mnu_regist 
         Caption         =   "ìoò^(&R)"
         Shortcut        =   ^R
      End
      Begin VB.Menu bar11 
         Caption         =   "-"
      End
      Begin VB.Menu mnu_exit 
         Caption         =   "èIóπ(&X)"
      End
   End
   Begin VB.Menu mnu_hen 
      Caption         =   "ï“èW(&2)"
      Begin VB.Menu mnu_initdsp 
         Caption         =   "âÊñ èâä˙âª(&S)"
         Shortcut        =   ^S
      End
      Begin VB.Menu bar21 
         Caption         =   "-"
      End
      Begin VB.Menu mnu_zenkesi 
         Caption         =   "ëSè¡çû(&A)"
         Shortcut        =   ^A
      End
      Begin VB.Menu mnu_zenkaijo 
         Caption         =   "ëSâèú(&U)"
         Shortcut        =   ^U
      End
   End
   Begin VB.Menu mnu_sou 
      Caption         =   "ëÄçÏ(&3)"
      Begin VB.Menu mnu_showwnd 
         Caption         =   "åÛï‚ÇÃàÍóó(&L)"
         Shortcut        =   {F5}
      End
   End
End
Attribute VB_Name = "FR_SSSMAIN"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
    Option Explicit
'//* All Right Reserved Copy Right (C)  äîéÆâÔé–ïxémí ä÷êºÉVÉXÉeÉÄÉY
'//***************************************************************************************
'//*
'//*ÅÉñºèÃÅÑ
'//* URKET73 ëOéÛè[ìññﬂÇµ
'//*
'//*ÅÉÉoÅ[ÉWÉáÉìÅÑ
'//* 1.00
'//*
'//*ÅÉçÏê¨é“ÅÑ
'//* FKS)
'//*
'//*ÅÉê‡ñæÅÑ
'//* ëOéÛè[ìñÇÃñﬂÇµèàóùâÊñ 
'//*
'//**************************************************************************************
'//*ïœçXóöó
'//*  ﬁ∞ºﬁÆ›  |  ì˙ït    | çXêVé“        |ì‡óe
'//* ---------|----------|---------------|-----------------------------------------------
'//* 1.00     |2009/06/13|FKS)íÜìc       |êVãKçÏê¨(URKET53 ì¸ã‡è¡çûÇÊÇËó¨ópçÏê¨)
'//* 1.01     |2009/07/06|FKS)íÜìc       |è¡çûâ¬î\ã‡äzéÊìæÉçÉWÉbÉNÇÃí«â¡
'//* 1.02     |2009/08/28|FKS)íÜìc       |è¡çûâ¬î\ã‡äzéÊìæÉçÉWÉbÉNÇÃïœçX(getUdntraNyukn)
'//* 1.03     |2009/09/03|FKS)íÜìc       |êUçûä˙ì˙Ç…ä÷Ç∑ÇÈèàóùÇïœçX(ñﬂÇµâÊñ Ç©ÇÁÇÃì¸óÕÇÇ≈Ç´Ç»Ç≠Ç∑ÇÈ)
'//*          |          |               |Å@êUçûä˙ì˙(cmd_fridt/txt_fridt)ÇÃVisibleÇ
'//* Å@Å@Å@Å@ |          |               |Å@ÅuTureÅvÇ©ÇÁÅuFalseÅvÇ÷ïœçX
'//* Å@Å@Å@Å@ |          |               |Å@êUçûä˙ì˙(txt_fridt)ÇÃTabStopÇÅuTureÅvÇ©ÇÁÅuFalseÅvÇ÷ïœçX
'//* 1.04     |2009/09/07|FKS)íÜìc       |êøãÅí˜ì˙à»ëOÇÃì˙ïtÇì¸óÕïsâ¬Ç∆Ç∑ÇÈÅB
'//* Å@Å@Å@Å@ |          |               |êøãÅêÊÇÃíSìñé“Ç™âcã∆íSìñÇ≈ñ≥Ç¢èÍçáÅAÉGÉâÅ[Ç∆Ç∑ÇÈÅB
'//* 2.00     |2009/09/16|FKS)íÜìc       |ÅEì¸ã‡è¡çûÉTÉ}ÉäÅ[ÇÃñ{ì¸ã‡çÄñ⁄Ç…ëŒÇµÇƒâΩÇ‡çXêVÇµÇ»Ç¢ÇÊÇ§Ç…Ç∑ÇÈ
'//*          |          |               |ÅEëOåéâèúéûÇÃì¸ã‡è¡çûÉTÉ}ÉäÅ[ÇÃñﬂÇµêÊïœçXÅiì¸ã‡Å®è¡çûÅj
'//*          |          |               |ÅEéËêîóøÅEè¡îÔÇÕé©êgÇÃéùÇ¡ÇƒÇ¢ÇÈì¸ã‡ãÊï™Ç…Çƒè¡çûÉgÉâÉìÇçÏê¨Ç∑ÇÈ
'//*          |          |               |ÅEï™î[ëŒâûÇÃÇΩÇﬂÅAã‡äzÉ`ÉFÉbÉNÅEì`ï[íPà É`ÉFÉbÉNÇäOÇ∑
'//**************************************************************************************



Private Declare Function ReleaseTabCapture Lib "TabCap.DLL" (ByVal hwnd As Long) As Long
Private Declare Function SetTabCapture Lib "TabCap.DLL" (ByVal hwnd As Long) As Long

Dim intUrigoukei    As Currency     'îÑè„ã‡äzÇÃçáåvÇäiî[Åiñæç◊ï\é¶éûÇ…ÉZÉbÉgÅj
Dim intBfkesiknkei  As Currency     'è¡çûçœäz(í˜ì˙ëO)ÇÃçáåväzÇäiî[Åiñæç◊ï\é¶éûÇ…ÉZÉbÉgÅj


Dim blnFriEnabled   As Boolean      'êUçûä˙ì˙Çì¸óÕÇ≈Ç´ÇÈÇ©Ç«Ç§Ç©ÇÃÉtÉâÉO(îªíËÇÕÅuéËå`ÅvÅuêUçûä˙ì˙ÅiÉtÉ@ÉNÉ^ÉäÉìÉOÅjÅvÇ™ë∂ç›Ç∑ÇÈéûÅj

Dim blnUsableSpread As Boolean      'ΩÃﬂ⁄ØƒﬁÇÃ≤Õﬁ›ƒÇé¿çsÇ∑ÇÈÇ©Ç«Ç§Ç©ÇÃÃ◊∏ﬁ
Dim intMaxRow       As Integer      'ΩÃﬂ⁄ØƒﬁÇÃï\é¶ç≈ëÂçsêîÇäiî[

Dim blnUsableButton As Boolean      'éËêîóøÅAè¡îÔê≈ç∑äzÅAëSè¡çûÅAëSâèúÅAçƒï\é¶ÅAêUçûä˙ì˙(ñæç◊ïî)ÇÃ≤Õﬁ›ƒÇé¿çsÇ∑ÇÈÇ©Ç«Ç§Ç©ÇÃÃ◊∏ﬁ
Dim intChkKb        As Integer      'É`ÉFÉbÉNãÊï™(1:É`ÉFÉbÉN 2:É`ÉFÉbÉN(ëOâÒÇ©ÇÁïœçXéûÇÃÇ›)
Dim blnUsableEvent  As Boolean      '≤Õﬁ›ƒÇé¿çsÇ∑ÇÈÇ©Ç«Ç§Ç©ÇÃÃ◊∏ﬁ(îƒóp)
Dim blnINIT_FLG     As Boolean


Dim intInputMode    As Integer      'ì¸óÕèÛë‘(1:ÉwÉbÉ_Å[ 2:ñæç◊ 9:âÊñ ÉNÉäÉAÅ[èàóù)


''ê‘çïÉ`ÉFÉbÉNópç\ë¢ëÃ
Private Type TYPE_AKAKRO_CHK
    idx            As Long      'çsî‘çÜ
    CHKMK          As Integer   'É`ÉFÉbÉNÉ}Å[ÉN
    UDNDT          As String    'îÑè„ì˙
    JDNNO          As String    'éÛíçáÇ
    KESIKN         As Currency  'è¡çûã‡äz
End Type

Private AKAKRO_CHK() As TYPE_AKAKRO_CHK


''ì`ï[íPà É`ÉFÉbÉNópç\ë¢ëÃ
Private Type TYPE_JDNTRKB_CHK
    idx            As Long      'çsî‘çÜ
    JDNNO          As String    'éÛíçáÇ
    HYJDNNO        As String    'ï\é¶ópéÛíçî‘çÜ
    KOMIKN         As Currency  'ê≈çûîÑè„ã‡äz
End Type

Private JDNTRKB_CHK() As TYPE_JDNTRKB_CHK



'ÉtÉHÅ[ÉÄÉçÅ[ÉhÉCÉxÉìÉg
Private Sub Form_Load()

    'WINDOW à íuê›íË
    Left = (Screen.Width - Width) / 2
    Top = (Screen.Height - Height) / 2

    'ÉçÅ[ÉJÉãïœêîèâä˙âª
    intUrigoukei = 0
    intBfkesiknkei = 0
    intMaxRow = 0
    intChkKb = 2

    blnFriEnabled = False
    blnUsableSpread = False
    blnUsableButton = False
    blnUsableEvent = True

    'ÅöDBÇ÷ÇÃê⁄ë±
    If CF_Ora_USR1_Open = False Then
        MsgBox "DBÇÃê⁄ë±Ç…é∏îsÇµÇ‹ÇµÇΩÅB", vbCritical, "ê⁄ë±ÉGÉâÅ["
    End If

    'PGèâä˙âª
    Call CF_Init

    'âÊñ èâä˙âª
    initForm
    initCondition
    initHead
    initBody


    intInputMode = 1

    'ÉVÉXÉeÉÄã§í èàóù
    Call CF_System_Process(Me)

    
    'ÅöÉçÉOÇÃèëÇ´èoÇµ
    Call SSSWIN_LOGWRT("ÉvÉçÉOÉâÉÄãNìÆ")
End Sub

'ÉtÉHÅ[ÉÄÉAÉìÉçÅ[ÉhÉCÉxÉìÉg
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
    'ÅúèIóπämîFÇÃMSG

    If ChkInputChange() = True Then
        If showMsg("0", "_ENDCK", 0) = vbNo Then
            Cancel = vbCancel
            Exit Sub
        End If
    Else
        If showMsg("0", "_ENDCM", 0) = vbNo Then
            Cancel = vbCancel
            Exit Sub
        End If
    End If


    'îrëºÉeÅ[ÉuÉãçÌèú
    Call SSSEXC_EXCTBZ_CLOSE

' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃâèú
    Call SSSWIN_Unlock_EXCTBZ
' === 20130708 === INSERT E -

    'DBÇÃê⁄ë±Çêÿíf
    Call CF_Ora_DisConnect(gv_Oss_USR1, gv_Odb_USR1)

    Call CF_Ora_DisConnect(gv_Oss_USR_SAIBAN, gv_Oss_USR_SAIBAN)


    'ÅöÉçÉOÇÃèëÇ´èoÇµ
    Call SSSWIN_LOGWRT("ÉvÉçÉOÉâÉÄèIóπ")

    End 'ÅúPGèIóπ
End Sub

'ÉtÉHÅ[ÉÄÇÃèâä˙âª
Private Sub initForm()
    Dim i As Integer
'''' ADD 2009/11/26  FKS) T.Yamamoto    Start    òAóçï[áÇ702
    Dim strRet As String
'''' ADD 2009/11/26  FKS) T.Yamamoto    End

    'ÉtÉHÅ[ÉÄÉLÉÉÉvÉVÉáÉìÉZÉbÉg
    Me.Caption = SSS_PrgNm

    'â^ópì˙ÇÃéÊìæ
    gstrUnydt = getUnydt
    'ëOâÒåoóùí˜é¿çsì˙ÇÃéÊìæ
    Call getSYSTBA
'''' UPD 2009/11/26  FKS) T.Yamamoto    Start    òAóçï[áÇ702
'    'å†å¿ÇÃéÊìæ
'    Call Get_Authority(gstrUnydt)
    'å†å¿ÇÃéÊìæ
    strRet = Get_Authority(gstrUnydt)
    If strRet = "9" Then
        'ãNìÆå†å¿Ç»ÇµÇÃèÍçáÅAèàóùèIóπ
        Call showMsg("2", "RUNAUTH", 0)
        End
    End If
'''' UPD 2009/11/26  FKS) T.Yamamoto    End

    'âÊñ âEè„ÇÃçÄñ⁄Ç…â^ópì˙ÇÉZÉbÉg
    pnl_unydt.Caption = CNV_DATE(gstrUnydt)

    'ì¸óÕíSìñé“ÇÉZÉbÉg
    txt_opeid.Text = SSS_OPEID
    txt_openm.Text = getTannm(SSS_OPEID)

    txt_message.Text = ""

    'èåèå≈íËópÉpÉlÉãÇâBÇ∑
    pnl_condition1.Caption = ""
    pnl_condition1.BevelOuter = ssBevelNone
    pnl_condition2.Caption = ""
    pnl_condition2.BevelOuter = ssBevelNone

    'ï\é¶å¿íËÉeÉLÉXÉgÉ{ÉbÉNÉXê›íËópÉpÉlÉãÇâBÇ∑
    pnl_hihyoji.Caption = ""
    pnl_hihyoji.BevelOuter = ssBevelNone


    'ΩÃﬂ⁄ØƒﬁâBÇµçÄñ⁄ÇîÒï\é¶Ç…Ç∑ÇÈ
    If SHOW_HIDE_COLUMN_FLAG = False Then
        With spd_body
            .Row = -1
            For i = COL_BFKESIKN To COL_HENPI
                .Col = i
                .ColHidden = True
            Next i
        End With
    End If


End Sub

'ì¸óÕèåèÇÃèâä˙âª
Private Sub initCondition()

    Call initVal    '∏ﬁ€∞ ﬁŸïœêîÇÃèâä˙âª

    txt_kesidt.Text = CNV_DATE(gstrUnydt)   'â^ópì˙ÇÉZÉbÉg
    txt_kesidt.ForeColor = vbBlack
    txt_kesidt.BackColor = vbWhite

    txt_tokseicd.Text = Space(5)            '5byte space
    txt_tokseicd.ForeColor = vbBlack
    txt_tokseicd.BackColor = vbWhite

    txt_tokseinma.Text = ""

    txt_kaidt_From.Text = Space(10)             '10byte space
    txt_kaidt_From.ForeColor = vbBlack
    txt_kaidt_From.BackColor = vbWhite

    txt_kaidt_To.Text = CNV_DATE(gstrUnydt)     'â^ópì˙ÇÉZÉbÉg
    txt_kaidt_To.ForeColor = vbBlack
    txt_kaidt_To.BackColor = vbWhite



    'ëOéÛè[ìñÇÕèâä˙ílÇÅuÇXÅvÇ∆Ç∑ÇÈÅB
    'txt_kesikb.Text = 1
    txt_kesikb.Text = 9

    blnFriEnabled = False
    txt_fridt.Text = Space(10)                  '10byte space
    txt_fridt.ForeColor = vbBlack
    txt_fridt.BackColor = vbWhite
    txt_fridt.Enabled = blnFriEnabled

    blnUsableButton = False
    blnUsableEvent = True

    'ÉIÉvÉVÉáÉìçÄñ⁄ÇÃêßå‰
    frm_opt1.Visible = OPTION_SHOW_FLAG
    opt_sort(0).Value = True
    lbl_shakbnm(0).Visible = OPTION_SHOW_FLAG
    lbl_shakbnm(1).Visible = OPTION_SHOW_FLAG
    lbl_shakbnm(1).Caption = ""
    lbl_hytokkesdd(0).Visible = OPTION_SHOW_FLAG
    lbl_hytokkesdd(1).Visible = OPTION_SHOW_FLAG
    lbl_hytokkesdd(1).Caption = ""
    bar21.Visible = OPTION_SHOW_FLAG
    mnu_zenkesi.Visible = OPTION_SHOW_FLAG
    mnu_zenkaijo.Visible = OPTION_SHOW_FLAG
    mnu_zenkesi.Enabled = blnUsableButton
    mnu_zenkaijo.Enabled = blnUsableButton
End Sub

'ÉwÉbÉ_ïî(è¡çûèÓïÒ)ÇÃèâä˙âª
Private Sub initHead()
    txt_urigoukei.Text = 0
    txt_nyukin.Text = 0
    txt_tesuryo.Text = 0
    txt_syohi.Text = 0
    txt_nyugoukei.Text = 0
    txt_kesizan.Text = 0
    intUrigoukei = 0
    intBfkesiknkei = 0
End Sub

'ñæç◊ïîÇÃèâä˙âª
Private Sub initBody()
    'èàóùíÜÇÕΩÃﬂ⁄Øƒﬁ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    blnUsableSpread = False

    With spd_body
        .ReDraw = False

        .Col = -1
        .Row = -1
        .Action = ActionClearText

        'ÉJÅ[É\Éãà íuÇêÊì™Ç…ñﬂÇ∑
        .Col = 1
        .Row = 1
        .Action = ActionSelectBlock

        .MaxRows = 9999
        .ReDraw = True
    End With

    intMaxRow = 0

    'ΩÃﬂ⁄Øƒﬁ≤Õﬁ›ƒÇÃãñâ¬
    blnUsableSpread = True
End Sub

'ñæç◊ïîÇÃèÓïÒÇï\é¶
Private Sub showBody()
    Dim strSql  As Variant
    Dim Usr_Ody As U_Ody
    Dim tmp     As Variant
    Dim intRet  As Integer
    Dim lw_sort As Integer
    Dim bleNextFlg As Boolean
    Dim idxRow As Long
    Dim strHyjdnno As String
    Dim strTEGDT    As String

' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃí«â¡
    Dim rResult     As Integer  ' èàóùÉ`ÉFÉbÉNä÷êîñﬂÇËíl
    Dim strUDNDT    As String
' === 20130708 === INSERT E

' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃâèú
    Call SSSWIN_Unlock_EXCTBZ
' === 20130708 === INSERT E -

    'èàóùíÜÇÕΩÃﬂ⁄Øƒﬁ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    blnUsableSpread = False

    'îrëºópîzóÒÇÃèâä˙âª
    ReDim ARY_UDNTRA_HAITA(0)
    ReDim ARY_JDNTRA_HAITA(0)
    ReDim ARY_UDNTRA_NYU_HAITA(0)
    
    ReDim ARY_NYUKN_KS(0)
    
    ARY_NYUKN_KS_CNT = 0

    'É}ÉEÉXÉJÅ[É\ÉãÇçªéûåvÇ…Ç∑ÇÈ
    Me.MousePointer = vbHourglass
    
    'ñæç◊ÉfÅ[É^éÊìæópSQLÇçÏê¨
    Select Case True
        Case opt_sort(0).Value
            lw_sort = 0
        Case opt_sort(1).Value
            lw_sort = 1
        Case opt_sort(2).Value
            lw_sort = 2
    End Select
    
    
    'ñæç◊ïîï\é¶ÉfÅ[É^éÊìæSQLÇçÏê¨Ç∑ÇÈ
    strSql = getSQLforBody( _
                            DB_SYSTBA.SMAUPDDT, _
                            gstrTokseicd, _
                            gstrKaidt_Fr, _
                            gstrKaidt_To, _
                            txt_kesikb.Text, _
                            lw_sort)
    '√ﬁ∞¿éÊìæ
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

    'ï\é¶çÄñ⁄èâä˙âª
    initHead
    initBody


    'èàóùíÜÇÕΩÃﬂ⁄Øƒﬁ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    blnUsableSpread = False


    With spd_body
        .ReDraw = False

        Do While CF_Ora_EOF(Usr_Ody) = False

            'ì\ÇËïtÇØÇÈÉfÅ[É^Ç™ï‘ïiÉfÅ[É^ÇÃèÍçá§çïÉfÅ[É^Çåüçı
            bleNextFlg = True

            'ï‘ïiÇÃê‘çïÉ`ÉFÉbÉN
            If chkHenpin(Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNNO", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNLINNO", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "RECNO", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNWRTFSTDT", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNWRTFSTTM", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "URITK", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "URIKN", ""))) = False Then


                'ÉfÅ[É^ÇÃï\é¶ÇçsÇÌÇ»Ç¢
                bleNextFlg = False
            Else
                bleNextFlg = True
            End If
            
            If Trim$(CF_Ora_GetDyn(Usr_Ody, "HENRSNCD", "")) = "" Then
                'ï‘ïiå„ÅAéÛíçí˘ê≥èàóùÇÃê‘çïÉ`ÉFÉbÉN
                If chkHenpinTeisei(Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNNO", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNLINNO", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNNO", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "LINNO", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNDT", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNWRTFSTDT", "")), _
                                Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNWRTFSTTM", ""))) = False Then

                   'ÉfÅ[É^ÇÃï\é¶ÇçsÇÌÇ»Ç¢
                     bleNextFlg = False
                Else
                    bleNextFlg = True
                End If
            End If


        ''ì¸óÕÇ≥ÇÍÇΩè¡çûì˙à»ç~ÇÃîÑè„ÉfÅ[É^ÇèoÇ≥Ç»Ç¢
            If bleNextFlg = False Then
                bleNextFlg = False

            Else
                If Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNDT", "")) > DeCNV_DATE(Trim$(txt_kesidt.Text)) _
                        And Trim$(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")) > 0 Then

                    'çïÉfÅ[É^Ç≈ì¸óÕÇ≥ÇÍÇΩè¡çûì˙ÇÊÇËå„ÇÃîÑè„ÇÕï\é¶ÇµÇ»Ç¢
                    bleNextFlg = False

                ElseIf Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNDT", "")) > DeCNV_DATE(Trim$(txt_kesidt.Text)) _
                        And Trim$(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")) < 0 Then
                    'ï‘ïiÇÃèÍçáÇÕÅAä˘Ç…âÊñ è„Ç…ìØÇ∂éÛíçî‘çÜÇ™ë∂ç›Ç∑ÇÈÇ©ÇämîFÇ∑ÇÈÅB
                    With spd_body
                          For idxRow = intMaxRow To 1 Step -1
                              Call .GetText(COL_HYJDNNO, idxRow, tmp)
                              strHyjdnno = CStr(tmp)

                              If Trim(strHyjdnno) = Trim$(CF_Ora_GetDyn(Usr_Ody, "HY_JDNNO", "")) Then
                                  'âÊñ è„Ç…çïÇ™Ç¢ÇÍÇŒèoóÕ
                                  bleNextFlg = True
                                  Exit For
                              Else
                                  bleNextFlg = False
                              End If
                          Next idxRow
                      End With
                Else
                    bleNextFlg = True

                End If
            End If



            '//ï\é¶îªífÉ`ÉFÉbÉN
            If chkHenpin2(Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNNO", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "JDNLINNO", "")), _
                            Trim$(CF_Ora_GetDyn(Usr_Ody, "UDNDT", ""))) = False Then
                bleNextFlg = False
            End If


            If bleNextFlg = True Then

                intMaxRow = intMaxRow + 1

                'ÉXÉvÉåÉbÉhÇ…éÊìæÇµÇΩÉfÅ[É^Çï\é¶
                .Row = intMaxRow
                .Col = COL_NO           'No.
                .Text = intMaxRow

                .Col = COL_NXTKB        'í†í[
                .Text = CF_Ora_GetDyn(Usr_Ody, "nxtkb", "")

                .Col = COL_HYUDNDT      'îÑè„ì˙
                .Text = CF_Ora_GetDyn(Usr_Ody, "hy_udndt", "")
' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃí«â¡
                strUDNDT = .Text
' === 20130708 === INSERT E -

                .Col = COL_HYJDNNO      'éÛíçî‘çÜ
                .Text = CF_Ora_GetDyn(Usr_Ody, "hy_jdnno", "")
' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃí«â¡
                If .Text <> "" Then
                    'îrëºÉ`ÉFÉbÉN
                    rResult = SSSWIN_EXCTBZ_CHECK2(Left$(.Text, 6))
                    Select Case rResult
                        'ê≥èÌ
                        Case 0
                        
                        'îrëºèàóùíÜ
                        Case 1
                        MsgBox ("ëºÇÃÉvÉçÉOÉâÉÄÇ≈çXêVíÜÇÃÇΩÇﬂÅAìoò^Ç≈Ç´Ç‹ÇπÇÒÅB" & vbCrLf & vbCrLf _
                                    & "çsNo:" & vbTab & intMaxRow & vbCrLf _
                                    & "îÑè„ì˙: " & vbTab & strUDNDT & vbCrLf _
                                    & "éÛíçî‘çÜ: " & vbTab & .Text)
                        Call SSSWIN_Unlock_EXCTBZ
                        initBody
                        GoTo STEP10_ShowBody
                        
                        'àŸèÌèIóπ
                        Case 9
                        Call showMsg("2", "URKET73_034", 0)  'çXêVàŸèÌ
                        Call SSSWIN_Unlock_EXCTBZ
                        initBody
                        GoTo STEP10_ShowBody
                    End Select
                End If
' === 20130708 === INSERT E -

                .Col = COL_HYKAIDT      'âÒé˚ó\íËì˙
                .Text = CF_Ora_GetDyn(Usr_Ody, "hy_kaidt", "")

                .Col = COL_TOKJDNNO     'ãqêÊíçï∂î‘çÜ
                .Text = CF_Ora_GetDyn(Usr_Ody, "tokjdnno", "")

                .Col = COL_TANNM        'âcã∆íSìñé“
                .Text = CF_Ora_GetDyn(Usr_Ody, "tannm", "")

                .Col = COL_URIKN        'ê≈î≤îÑè„ã‡äz
                .Text = CF_Ora_GetDyn(Usr_Ody, "urikn", "")

                .Col = COL_UZEKN        'è¡îÔê≈äz
                .Text = CF_Ora_GetDyn(Usr_Ody, "uzekn", "")

                .Col = COL_KOMIKN       'ê≈çûîÑè„ã‡äz
                .Text = CF_Ora_GetDyn(Usr_Ody, "komikn", "")
                'çáåvã‡äzÇåvéZ
                intUrigoukei = intUrigoukei + SSSVal(.Text)

                .Col = COL_KESIKN       'ì¸ã‡çœäz
                .Text = CF_Ora_GetDyn(Usr_Ody, "kesikn", "")

                .Col = COL_MINYUKN      'ñ¢ì¸ã‡äz(îÒï\é¶)
                .Text = CF_Ora_GetDyn(Usr_Ody, "kesikn", "")

                .Col = COL_HYFRIDT      'êUçûä˙ì˙
                strTEGDT = Get_NKSTRA_TEGDT(CF_Ora_GetDyn(Usr_Ody, "datno", ""), CF_Ora_GetDyn(Usr_Ody, "linno", ""))
                If Trim(strTEGDT) <> "" Then
                    .Text = CNV_DATE(strTEGDT)
                Else
        '*** 2009/09/03 ADD START FKS)NAKATA V1.03
                    'ì¸ã‡ÉåÉRÅ[ÉhÇÊÇËêUçûä˙ì˙ÇéÊìæÇ∑ÇÈ
                    strTEGDT = Get_NYUKN_TEGDT(CF_Ora_GetDyn(Usr_Ody, "jdnno", ""), CF_Ora_GetDyn(Usr_Ody, "jdnlinno", ""))
        '*** 2009/09/03 ADD E.N.D FKS)NAKATA
                    If Trim(strTEGDT) <> "" Then
                        .Text = CNV_DATE(strTEGDT)
                    End If
                End If
                
                .Col = COL_BFHYFRIDT    'êUçûä˙ì˙(ïœçXëO)
                If Trim(strTEGDT) <> "" Then
                    .Text = CNV_DATE(strTEGDT)
                
        '*** 2009/09/03 DEL START FKS)NAKATA V1.03
        '        Else
        '            .Text = CNV_DATE(gstrFridt)                 'ÕØ¿ﬁÇ≈éwíËÇµÇΩêUçûä˙ì˙Çèâä˙ï\é¶
        '*** 2009/09/03 DEL START FKS)NAKATA V1.03
                End If
                .Col = COL_HYFRIDT      'êUçûä˙ì˙

                'ÉwÉbÉ_ïîÇ∆ìØÇ∂Ç≠ÅAñæç◊ïîÇÃì¸óÕÇ‡êßå¿

                .Lock = Not blnFriEnabled
                
                .Col = COL_BFKESIKN  'è¡çûçœäz(í˜ì˙ëO)
                .Text = CF_Ora_GetDyn(Usr_Ody, "bfkesikn", "")
                    'çáåvã‡äzÇåvéZ
                    intBfkesiknkei = intBfkesiknkei + SSSVal(.Text)

                    'Åúì¸ã‡çœäz(KESIKN) - è¡çûçœäz(í˜ì˙ëO) > 0 ÇÃÇ∆Ç´¡™Ø∏ŒﬁØ∏ΩÇ…¡™Ø∏ÇïtÇØÇÈ
                    .GetText COL_KESIKN, .Row, tmp
                    
                    If SSSVal(tmp) <> 0 Then

                        .Col = COL_CHK
                        .Value = 1

                        .Col = COL_BFCHECK
                        .Value = 1

                    End If

                .Col = COL_AFKESIKN     'è¡çûçœäz(í˜ì˙å„)
                .Text = CF_Ora_GetDyn(Usr_Ody, "afkesikn", "")

                .Col = COL_JDNNO        'éÛíçî‘çÜ(6åÖ)
                .Text = CF_Ora_GetDyn(Usr_Ody, "jdnno", "")

                .Col = COL_JDNLINNO     'éÛíççsî‘çÜ
                .Text = CF_Ora_GetDyn(Usr_Ody, "jdnlinno", "")

                .Col = COL_UDNDT        'îÑè„ì˙(ÉXÉâÉbÉVÉÖÇ»Çµ)
                .Text = CF_Ora_GetDyn(Usr_Ody, "udndt", "")

                .Col = COL_KESDT        'âÒé˚ó\íËì˙(ÉXÉâÉbÉVÉÖÇ»ÇµÅj
                .Text = CF_Ora_GetDyn(Usr_Ody, "kesdt", "")

                .Col = COL_TOKCD        'ìæà”êÊ∫∞ƒﬁ
                .Text = CF_Ora_GetDyn(Usr_Ody, "tokcd", "")

                .Col = COL_TOKSEICD     'êøãÅêÊ∫∞ƒﬁ
                .Text = CF_Ora_GetDyn(Usr_Ody, "tokseicd", "")

                .Col = COL_TANCD        'íSìñé“∫∞ƒﬁ
                .Text = CF_Ora_GetDyn(Usr_Ody, "tancd", "")

                .Col = COL_JDNDT        'éÛíçì˙
                .Text = CF_Ora_GetDyn(Usr_Ody, "jdndt", "")

                .Col = COL_TUKKB        'í â›ãÊï™
                .Text = CF_Ora_GetDyn(Usr_Ody, "tukkb", "")

                .Col = COL_INVNO        '≤›Œﬁ≤Ωî‘çÜ
                .Text = CF_Ora_GetDyn(Usr_Ody, "invno", "")

                .Col = COL_FURIKN       'äCäOîÑè„ã‡äz
                .Text = CF_Ora_GetDyn(Usr_Ody, "furikn", "")

                .Col = COL_FRNKB        'äCäOéÊà¯ãÊï™
                .Text = CF_Ora_GetDyn(Usr_Ody, "frnkb", "")

                .Col = COL_UDNDATNO     'îÑè„DATNO
                .Text = CF_Ora_GetDyn(Usr_Ody, "datno", "")

                .Col = COL_UDNLINNO     'îÑè„çsî‘çÜ
                .Text = CF_Ora_GetDyn(Usr_Ody, "linno", "")

                .Col = COL_MAEUKKB      'ëOéÛãÊï™
                .Text = CF_Ora_GetDyn(Usr_Ody, "maeukkb", "")

                .Col = COL_JDNDATNO     'éÛíçDATNO
                .Text = CF_Ora_GetDyn(Usr_Ody, "jdndatno", "")


                .Col = COL_KESIKN_MAE   'è¡çûã‡äzëO
                .Text = SSSVal(CF_Ora_GetDyn(Usr_Ody, "bfkesikn", "")) + SSSVal(CF_Ora_GetDyn(Usr_Ody, "afkesikn", ""))

                
                If SSSVal(CF_Ora_GetDyn(Usr_Ody, "komikn", "")) - SSSVal(CF_Ora_GetDyn(Usr_Ody, "kesikn", "")) < 0 Then
                    .Col = COL_HENPI
                    .Text = "1"
                End If
                
                
                'îÑè„ÉgÉâÉìÇÃîrëºèÓïÒéÊìæ
                ReDim Preserve ARY_UDNTRA_HAITA(intMaxRow)
                ARY_UDNTRA_HAITA(intMaxRow).DATNO = CStr(CF_Ora_GetDyn(Usr_Ody, "DATNO", ""))
                ARY_UDNTRA_HAITA(intMaxRow).LINNO = CStr(CF_Ora_GetDyn(Usr_Ody, "LINNO", ""))
                ARY_UDNTRA_HAITA(intMaxRow).OPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNOPEID", ""))
                ARY_UDNTRA_HAITA(intMaxRow).CLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNCLTID", ""))
                ARY_UDNTRA_HAITA(intMaxRow).WRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNWRTDT", ""))
                ARY_UDNTRA_HAITA(intMaxRow).WRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNWRTTM", ""))
                ARY_UDNTRA_HAITA(intMaxRow).UOPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNUOPEID", ""))
                ARY_UDNTRA_HAITA(intMaxRow).UCLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNUCLTID", ""))
                ARY_UDNTRA_HAITA(intMaxRow).UWRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNUWRTDT", ""))
                ARY_UDNTRA_HAITA(intMaxRow).UWRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNUWRTTM", ""))

                'éÛíçÉgÉâÉìÇÃîrëºèÓïÒéÊìæ
                ReDim Preserve ARY_JDNTRA_HAITA(intMaxRow)
                ARY_JDNTRA_HAITA(intMaxRow).DATNO = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNDATNO", ""))
                ARY_JDNTRA_HAITA(intMaxRow).JDNNO = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNNO", ""))
                ARY_JDNTRA_HAITA(intMaxRow).LINNO = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNLINNO", ""))
                ARY_JDNTRA_HAITA(intMaxRow).OPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNOPEID", ""))
                ARY_JDNTRA_HAITA(intMaxRow).CLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNCLTID", ""))
                ARY_JDNTRA_HAITA(intMaxRow).WRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNWRTDT", ""))
                ARY_JDNTRA_HAITA(intMaxRow).WRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNWRTTM", ""))
                ARY_JDNTRA_HAITA(intMaxRow).UOPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNUOPEID", ""))
                ARY_JDNTRA_HAITA(intMaxRow).UCLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNUCLTID", ""))
                ARY_JDNTRA_HAITA(intMaxRow).UWRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNUWRTDT", ""))
                ARY_JDNTRA_HAITA(intMaxRow).UWRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "JDNUWRTTM", ""))
                
                
                'îÑè„ÉgÉâÉìì¸ã‡ÉåÉRÅ[ÉhÇÃîrëºèÓïÒéÊìæ
                Call getUdntraNyukn(CStr(CF_Ora_GetDyn(Usr_Ody, "JDNNO", "")), CStr(CF_Ora_GetDyn(Usr_Ody, "JDNLINNO", "")))

            End If

            Usr_Ody.Obj_Ody.MoveNext
        Loop

    End With

    Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ

    'è¡çûëŒè€Ç™Ç»ÇØÇÍÇŒÉÅÉbÉZÅ[ÉWÇï\é¶
    If intMaxRow = 0 Then
        Call showMsg("2", "RNOTFOUND", "0")    'ÅúäYìñÉfÅ[É^Ç»Çµ
        txt_kesidt.SetFocus

    'ëŒè€Ç™Ç†ÇÈéû
    Else

        'ì¸ã‡è¡çûÉgÉâÉìÇÃîrëºèÓïÒéÊìæ
        Call Get_NKSTRA_HAITA_INF

        'ï\é¶çsêîÇ™16çsà»è„ÇÃÇ∆Ç´ÅAΩÃﬂ⁄ØƒﬁçsêîÇê›íË
        If intMaxRow > 16 Then
            spd_body.MaxRows = intMaxRow
        Else
            spd_body.MaxRows = 16
        End If

        showHead    'ÕØ¿ﬁïîÇÃï\é¶
        
        'spd_body.SetFocus
        blnUsableButton = True  'ÅúŒﬁ¿›égópÇÃãñâ¬
        mnu_zenkesi.Enabled = blnUsableButton
        mnu_zenkaijo.Enabled = blnUsableButton
        'èåèÉpÉlÉãÇÃÉçÉbÉN
        pnl_condition1.Enabled = False
        pnl_condition2.Enabled = False


'*** 2009/09/16 ADD START FKS)NAKATA
        'ï‘ïiã‡äzÇÃçló∂
        getHenpinKingaku
'*** 2009/09/16 ADD E.N.D FKS)NAKATA


    End If
' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃí«â¡
STEP10_ShowBody:
' === 20130708 === INSERT E
    


    spd_body.ReDraw = True

    
    'ΩÃﬂ⁄Øƒﬁ≤Õﬁ›ƒÇÃãñâ¬
    blnUsableSpread = True

    'É}ÉEÉXÉJÅ[É\ÉãÇïWèÄÇ…ñﬂÇ∑
    Me.MousePointer = vbNormal
End Sub

'ÉwÉbÉ_ïî(è¡çûèÓïÒ)ÇÃï\é¶
Public Sub showHead()

    Dim intZankn    As Currency     'è¡çûì˙åéìxÇ‹Ç≈ÇÃè¡çûécäzåv
    Dim intKesikn   As Currency     'åoóùí˜ì˙à»ç~ÇÃè¡çûäz
    Dim intTesuryo  As Currency     'è¡çûì˙åéìxÇÃéËêîóøäzÇäiî[
    Dim intSyohi    As Currency     'è¡çûì˙åéìxÇÃè¡îÔê≈äzÇäiî[

    Dim tmp As Currency
    Dim i       As Integer

    
    intZankn = 0
    intKesikn = 0
    intTesuryo = 0
    intSyohi = 0


    'îrëºèÓïÒÇ∆è¡çûã‡äzèÓïÒÇéÊìæ
    Call getHaitaAndKnSum(DB_TOKMTA.TOKSEICD _
                        , Get_Acedt(gstrKesidt) _
                        , DB_TOKMTA.SHAKB)


    'è¡çûì˙åéìxÇ‹Ç≈ÇÃè¡çûécäzåv
    For i = 0 To 9
        intZankn = intZankn + ARY_NKSSMB_KS(i).KSKZANKN
    Next i

    'åoóùí˜ì˙à»ç~ÇÃè¡çûäz
    For i = 0 To 9
        intKesikn = intKesikn + ARY_NKSSMB_KS(i).SSANYUKN - ARY_NKSSMB_KS(i).KSKNYKKN
    Next i

    'è¡çûì˙åéìxÇÃéËêîóøÅEè¡îÔê≈äzÇäiî[
    i = SSSVal(TesuryoID)
    intTesuryo = ARY_NKSSMB_KS(i).KSKZANKN + ARY_NKSSMB_KS(i).SSANYUKN - ARY_NKSSMB_KS(i).KSKNYKKN 'SSSVal(CF_Ora_GetDyn(Usr_Ody, "SSANYUKN" & TesuryoID, ""))
    i = SSSVal(SyohiID)
    intSyohi = ARY_NKSSMB_KS(i).KSKZANKN + ARY_NKSSMB_KS(i).SSANYUKN - ARY_NKSSMB_KS(i).KSKNYKKN 'SSSVal(CF_Ora_GetDyn(Usr_Ody, "SSANYUKN" & TesuryoID, ""))


    'îÑè„çáåvã‡äzÇÃï\é¶
    txt_urigoukei.Text = Format(intUrigoukei, "###,###,##0")

    'ì¸ã‡äzÅEéËêîóøäzÅEè¡îÔê≈äzÇÃï\é¶
    tmp = intZankn + intKesikn
    If tmp - (intTesuryo + intSyohi) > 0 Then
        txt_nyukin.Text = Format(tmp - (intTesuryo + intSyohi), "#,###,##0")
        txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
        txt_syohi.Text = Format(intSyohi, "#,###,##0")
    'écÇ™ÉvÉâÉXÇÃÇ∆Ç´
    ElseIf tmp > 0 Then
        If intTesuryo > 0 Then
            If intSyohi > 0 Then
                'écäzÇ™ÉvÉâÉXÇ≈ÅAéËêîóøÇ‡ÅAè¡îÔê≈ç∑äzÇ‡ÉvÉâÉXÇÃéû
                If tmp - intTesuryo > 0 Then
                    txt_nyukin.Text = Format(0, "#,###,##0")
                    txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
                    txt_syohi.Text = Format(tmp - intTesuryo, "#,###,##0")
                Else
                    txt_nyukin.Text = Format(0, "#,###,##0")
                    txt_tesuryo.Text = Format(tmp, "#,###,##0")
                    txt_syohi.Text = Format(0, "#,###,##0")
                End If

            ElseIf intSyohi <= 0 Then
                'écäzÇ™ÉvÉâÉXÇ≈ÅAéËêîóøÇ™ÉvÉâÉXÅAè¡îÔê≈ç∑äzÇ™É}ÉCÉiÉXÇÃéû
                txt_nyukin.Text = Format(0, "#,###,##0")
                txt_tesuryo.Text = Format(tmp - intSyohi, "#,###,##0")
                txt_syohi.Text = Format(intSyohi, "#,###,##0")
            End If

        ElseIf intTesuryo <= 0 Then
            If intSyohi > 0 Then
                'écäzÇ™ÉvÉâÉXÇ≈ÅAéËêîó Ç™É}ÉCÉiÉXÅAè¡îÔê≈ç∑äzÇ™ÉvÉâÉXÇÃéû
                txt_nyukin.Text = Format(0, "#,###,##0")
                txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
                txt_syohi.Text = Format(tmp - intTesuryo, "#,###,##0")
            ElseIf intSyohi <= 0 Then
                'écäzÇ™ÉvÉâÉXÇ≈ÅAéËêîóøÇ‡ÅAè¡îÔê≈ç∑äzÇ‡É}ÉCÉiÉXÇÃéû
                'tmp - (intTesuryo + intSyohi) ÇÕê‚ëŒÇ…ê≥Ç»ÇÃÇ≈ÅAÇ±Ç±Ç…èàóùÇÕïsóv
            End If
        End If

    'écÇ™ïâÇÃéû
    ElseIf tmp <= 0 Then
        If intTesuryo > 0 Then
            If intSyohi > 0 Then
                'écäzÇ™É}ÉCÉiÉXÇ≈ÅAéËêîóøÇ‡ÅAè¡îÔê≈ç∑äzÇ‡ÉvÉâÉXÇÃéû
                txt_nyukin.Text = Format(tmp, "#,###,##0")
                txt_tesuryo.Text = Format(0, "#,###,##0")
                txt_syohi.Text = Format(0, "#,###,##0")
            ElseIf intSyohi <= 0 Then
                'écäzÇ™É}ÉCÉiÉXÇ≈ÅAéËêîóøÇ™ÉvÉâÉXÅAè¡îÔê≈ç∑äzÇ™É}ÉCÉiÉXÇÃéû
                If tmp + intTesuryo + intSyohi > 0 Then
                    txt_nyukin.Text = Format(0, "#,###,##0")
                    txt_tesuryo.Text = Format(tmp - intSyohi, "#,###,##0")
                    txt_syohi.Text = Format(intSyohi, "#,###,##0")
                Else
                    txt_nyukin.Text = Format(tmp - intSyohi, "#,###,##0")
                    txt_tesuryo.Text = Format(0, "#,###,##0")
                    txt_syohi.Text = Format(intSyohi, "#,###,##0")
                End If
            End If
        ElseIf intTesuryo <= 0 Then
            If intSyohi > 0 Then
                'écäzÇ™É}ÉCÉiÉXÇ≈ÅAéËêîó Ç™É}ÉCÉiÉXÅAè¡îÔê≈ç∑äzÇ™ÉvÉâÉXÇÃéû
                If tmp + intTesuryo + intSyohi > 0 Then
                    txt_nyukin.Text = Format(0, "#,###,##0")
                    txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
                    txt_syohi.Text = Format(tmp - intTesuryo, "#,###,##0")
                Else
                    txt_nyukin.Text = Format(tmp - intTesuryo, "#,###,##0")
                    txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
                    txt_syohi.Text = Format(0, "#,###,##0")
                End If
            ElseIf intSyohi <= 0 Then
                'écäzÇ™É}ÉCÉiÉXÇ≈ÅAéËêîóøÇ‡ÅAè¡îÔê≈ç∑äzÇ‡É}ÉCÉiÉXÇÃéû
                txt_nyukin.Text = Format(tmp - (intTesuryo + intSyohi), "#,###,##0")
                txt_tesuryo.Text = Format(intTesuryo, "#,###,##0")
                txt_syohi.Text = Format(intSyohi, "#,###,##0")
            End If
        End If
    End If

    'ì¸ã‡çáåväzÇÃï\é¶
    tmp = SSSVal(txt_nyukin.Text) + SSSVal(txt_tesuryo.Text) + SSSVal(txt_syohi.Text)
    txt_nyugoukei.Text = Format(tmp, "###,###,##0")

    'ì¸ã‡écäzÇÃï\é¶
    txt_kesizan.Text = Format(intZankn + intKesikn, "###,###,##0")

End Sub

'ñæç◊ïîçáåvã‡äzÇÃéÊìæ
Private Function getBodyKesikei(strColName As String) As Currency
    Dim i As Integer
    Dim intKesikei As Currency
    Dim tmp As Variant

    intKesikei = 0
    blnUsableSpread = False
    With spd_body
        For i = 1 To intMaxRow
            .GetText strColName, i, tmp
            intKesikei = intKesikei + SSSVal(tmp)
        Next i
    End With
    blnUsableSpread = True

    getBodyKesikei = intKesikei
End Function


'îrëºèÓïÒÇ∆è¡çûã‡äzèÓïÒÇéÊìæÅAÉOÉçÅ[ÉoÉãïœêîÇ…äiî[
Private Sub getHaitaAndKnSum(ByVal pin_strTOKCD As String _
                           , ByVal pin_strSMADT As String _
                           , ByVal pin_strSHAKB As String)
    Dim strSql  As Variant
    Dim Usr_Ody As U_Ody
    Dim i       As Integer

    'è¡çûì˙åéìxÇÃè¡çûèÛë‘ÇéÊìæ
    
    strSql = ""
    strSql = strSql & " SELECT * "
    strSql = strSql & "   FROM NKSSMB "
    strSql = strSql & "  WHERE TOKCD = '" & CF_Ora_Sgl(pin_strTOKCD) & "' "
    strSql = strSql & "    AND SMADT = '" & CF_Ora_Sgl(DeCNV_DATE(pin_strSMADT)) & "' "

    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

    'ì¸ã‡è¡çûÉTÉ}ÉäÅ[ÇÃîrëºèÓïÒéÊìæ
    ReDim ARY_NKSSMB_HAITA(1)
    ARY_NKSSMB_HAITA(1).TOKCD = CStr(CF_Ora_GetDyn(Usr_Ody, "TOKCD", ""))
    ARY_NKSSMB_HAITA(1).SMADT = CStr(CF_Ora_GetDyn(Usr_Ody, "SMADT", ""))
    ARY_NKSSMB_HAITA(1).OPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "OPEID", ""))
    ARY_NKSSMB_HAITA(1).CLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "CLTID", ""))
    ARY_NKSSMB_HAITA(1).WRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTDT", ""))
    ARY_NKSSMB_HAITA(1).WRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTTM", ""))

    'ì¸ã‡è¡çûÉTÉ}ÉäÇÃèÓïÒÇç\ë¢ëÃîzóÒÇ÷éÊìæ
    ReDim ARY_NKSSMB_KS(9)
    For i = 0 To 9
        With ARY_NKSSMB_KS(i)
            .UPDID = Format(i, "00")

            If i <> 8 Then
                If CF_Ora_EOF(Usr_Ody) = False Then
                    .SSANYUKN = SSSVal(CF_Ora_GetDyn(Usr_Ody, "SSANYUKN" & .UPDID, ""))
                    .KSKNYKKN = SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKNYKKN" & .UPDID, ""))
                    .KSKZANKN = SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKZANKN" & .UPDID, ""))
                End If
            Else
                '09ÅFñ{ì¸ã‡ ÇÕÅAëäéËÇ…ÇµÇ»Ç¢
                .SSANYUKN = 0
                .KSKNYKKN = 0
                .KSKZANKN = 0
            End If

            'éÊà¯ãÊï™ÇÃê›íË
            Select Case i
                Case 0: .DATKB = "01"       '01ÅFåªã‡
                Case 1: .DATKB = "02"       '02ÅFêUçû
                Case 2: .DATKB = "03"       '03ÅFéËå`
                Case 3: .DATKB = "04"       '04ÅFëäéE
                Case 4: .DATKB = "05"       '05ÅFílà¯
                Case 5: .DATKB = "06"       '06ÅFéËêî
                Case 6: .DATKB = "07"       '07ÅFëº
                Case 7: .DATKB = "08"       '08ÅFêUçûâº
                Case 8: .DATKB = "09"       '09ÅFñ{ì¸ã‡
                Case 9: .DATKB = "99"       '99ÅFè¡îÔ
            End Select


            'è¡çûèáèòÇÃê›íËÅi-1 ÇÕè¡çûÇ»ÇµÅj
            ' á@ëäéEÅ®áAè¡îÔê≈Å®áBéËêîóøÅ®áCåªã‡Å®áDêUçûÅ®áEéËå`Å®áFêUçûâºÅ®áGílà¯Ç´Å®áHëº
            Select Case i
                Case 0: .SEQ = 4            'éÊà¯ãÊï™ÅÅ01ÅFåªã‡
                Case 1: .SEQ = 5            'éÊà¯ãÊï™ÅÅ02ÅFêUçû
                Case 2: .SEQ = 6            'éÊà¯ãÊï™ÅÅ03ÅFéËå`
                Case 3: .SEQ = 1            'éÊà¯ãÊï™ÅÅ04ÅFëäéE
                Case 4: .SEQ = 8            'éÊà¯ãÊï™ÅÅ05ÅFílà¯
                Case 5: .SEQ = 3            'éÊà¯ãÊï™ÅÅ06ÅFéËêî
                Case 6: .SEQ = 9            'éÊà¯ãÊï™ÅÅ07ÅFëº
                Case 7: .SEQ = 7            'éÊà¯ãÊï™ÅÅ08ÅFêUçûâº
                Case 8: .SEQ = -1           'éÊà¯ãÊï™ÅÅ09ÅFñ{ì¸ã‡
                Case 9: .SEQ = 2            'éÊà¯ãÊï™ÅÅ99ÅFè¡îÔ
            End Select

        End With
    Next i

    Call CF_Ora_CloseDyn(Usr_Ody)


    For i = 0 To 9
        'écã‡ÇåvéZÇ∑ÇÈ
        With ARY_NKSSMB_KS(i)
            .ZAN_KIN = .SSANYUKN - .KSKNYKKN + .KSKZANKN
        End With
    Next i
End Sub


'ëSâèúÉÅÉjÉÖÅ[ÉNÉäÉbÉNéû
Private Sub mnu_zenkaijo_Click()
    cmd_zenkaijo_Click
End Sub

'ëSëIëÉÅÉjÉÖÅ[ÉNÉäÉbÉNéû
Private Sub mnu_zenkesi_Click()
    cmd_zenkesi_Click
End Sub

Private Sub opt_sort_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)


    'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫éû
    If KeyCode >= vbKeyF1 And KeyCode <= vbKeyF12 Then
        'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã§í èàóù
        Call CF_FuncKey_Execute(KeyCode, Shift)
    End If

    
End Sub

'ÉwÉbÉ_ÉpÉlÉãÉ}ÉEÉXÉÄÅ[Éuéû
Private Sub pnl_head_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    'ÉqÉìÉgÇÃï\é¶Çèâä˙âªÇ∑ÇÈ
    img_light.Picture = img_bklight(0).Picture
    txt_message.Text = ""
End Sub

'ÉAÉCÉRÉì[èIóπ]ÉNÉäÉbÉNéû
Private Sub img_exit_Click()
    Unload Me
End Sub
'ÉAÉCÉRÉì[èIóπ]É}ÉEÉXÉ_ÉEÉìéû
Private Sub img_exit_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_exit.Picture = img_bkexit(1).Picture
End Sub
'ÉAÉCÉRÉì[èIóπ]É}ÉEÉXÉÄÅ[Éuéû
Private Sub img_exit_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_light.Picture = img_bklight(1).Picture
    txt_message.Text = "ÉÅÉjÉÖÅ[Ç…ñﬂÇËÇ‹Ç∑ÅB"
End Sub
'ÉAÉCÉRÉì[èIóπ]É}ÉEÉXÉAÉbÉvéû
Private Sub img_exit_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_exit.Picture = img_bkexit(0).Picture
End Sub

'ÉAÉCÉRÉì[ìoò^]ÉNÉäÉbÉNéû
Private Sub img_resist_Click()
    mnu_regist_Click
End Sub
'ÉAÉCÉRÉì[ìoò^]É}ÉEÉXÉ_ÉEÉìéû
Private Sub img_resist_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_resist.Picture = img_bkresist(1).Picture
End Sub
'ÉAÉCÉRÉì[ìoò^]É}ÉEÉXÉÄÅ[Éuéû
Private Sub img_resist_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_light.Picture = img_bklight(1).Picture
    txt_message.Text = "ìoò^ÇµÇ‹Ç∑ÅB"
End Sub
'ÉAÉCÉRÉì[ìoò^]É}ÉEÉXÉAÉbÉvéû
Private Sub img_resist_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_resist.Picture = img_bkresist(0).Picture
End Sub

'ÉAÉCÉRÉì[åüçı]ÉNÉäÉbÉNéû
Private Sub img_showwnd_Click()
    mnu_showwnd_Click
End Sub
'ÉAÉCÉRÉì[åüçı]É}ÉEÉXÉ_ÉEÉìéû
Private Sub img_showwnd_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_showwnd.Picture = img_bkshowwnd(1).Picture
End Sub
'ÉAÉCÉRÉì[åüçı]É}ÉEÉXÉÄÅ[Éuéû
Private Sub img_showwnd_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_light.Picture = img_bklight(1).Picture
    txt_message.Text = "ÉEÉBÉìÉhÉEÇï\é¶ÇµÇ‹Ç∑ÅB"
End Sub
'ÉAÉCÉRÉì[åüçı]É}ÉEÉXÉAÉbÉvéû
Private Sub img_showwnd_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_showwnd.Picture = img_bkshowwnd(0).Picture
End Sub

'ÉAÉCÉRÉì[âèú]ÉNÉäÉbÉNéû
Private Sub img_unlock_Click()
    
    If blnUsableButton = True Then
        blnUsableButton = False
        pnl_condition1.Enabled = True
        pnl_condition2.Enabled = True
        initHead
        initBody
        txt_kesidt.SetFocus
        intInputMode = 1
' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃâèú
        Call SSSWIN_Unlock_EXCTBZ
' === 20130708 === INSERT E -
   End If

End Sub
'ÉAÉCÉRÉì[âèú]É}ÉEÉXÉ_ÉEÉìéû
Private Sub img_unlock_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_unlock.Picture = img_bkunlock(1).Picture
End Sub
'ÉAÉCÉRÉì[âèú]É}ÉEÉXÉÄÅ[Éuéû
Private Sub img_unlock_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_light.Picture = img_bklight(1).Picture
    txt_message.Text = "âÊñ ÇÉNÉäÉAÇµÇƒÉRÅ[ÉhÇÃì¸óÕÇë“ÇøÇ‹Ç∑ÅB"
End Sub
'ÉAÉCÉRÉì[âèú]É}ÉEÉXÉAÉbÉvéû
Private Sub img_unlock_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    img_unlock.Picture = img_bkunlock(0).Picture
End Sub

'ÉÅÉjÉÖÅ[[èàóù]Å|[èIóπ]ëIëéû
Private Sub mnu_exit_Click()
    Unload Me
End Sub

'ÉÅÉjÉÖÅ[[èàóù]Å|[ìoò^]ëIëéû
Private Sub mnu_regist_Click()

Dim intRtn  As Integer


    'ÉwÉbÉ_ïîÇÃì¸óÕÉ`ÉFÉbÉN
    If chkCondition = False Then Exit Sub
    'ñæç◊ïîÇÃì¸óÕÉ`ÉFÉbÉN
    If blnUsableButton = False Then
        showMsg "0", "_UPDATE", "2"     'Åúñæç◊ïîñ¢ì¸óÕÇÃMSG
        Exit Sub
    End If


    'ï‘ïièàóùÇÃÇ»Ç´ï™Ç©ÇÍÉ`ÉFÉbÉN
    If chkAkaKro = False Then
        Exit Sub
    End If

'**** 2009/09/16 DEL START FKS)NAKATA
'ï™î[ëŒâûÇÃÇΩÇﬂÉ`ÉFÉbÉNÇäOÇ∑
''    'îÑè„ã‡äzÇ∆è[ìñã‡äzÇÃÉ`ÉFÉbÉN
''    If chkUrikn = False Then
''        Exit Sub
''    End If
''
''
''    'ì`ï[íPà Ç≈ÇÃè[ìñÉ`ÉFÉbÉN
''    If chkJdntrkb = False Then
''        Exit Sub
''    End If
'**** 2009/09/16 DEL E.N.D FKS)NAKATA


    'ì¸ã‡Ç™ìoò^Ç≥ÇÍÇƒÇ¢ÇÈÇ©ÇÃÉ`ÉFÉbÉN
    If chkNyukn = False Then
        Exit Sub
    End If


    'éËå`Ç™ì¸Ç¡ÇƒÇ¢ÇÈèÍçáÇÕêUçûä˙ì˙ÇÃì¸óÕÉ`ÉFÉbÉN
    If chkFurikomiDT = False Then
        Exit Sub
    End If



    'Åúìoò^ämîFÇÃMSG
    If showMsg("0", "_UPDATE", 0) = vbYes Then
        'Åöå†å¿ÇÃîªíf
        If gs_UPDAUTH = "9" And AUTHORITY_ENABLE = True Then
            showMsg "2", "UPDAUTH", "0"
            Exit Sub
        End If

        'îrëºÉ`ÉFÉbÉN
        If Left(SSSEXC_EXCTBZ_CHECK, 1) = "9" Then
            MsgBox "Åy" & Trim(Mid(SSSEXC_EXCTBZ_CHECK, 2, 30)) & "ÅzÇ™ãNìÆíÜÇ≈Ç∑ÅB" & _
                   Trim(SSS_PrgNm) & "Çì¸óÕÇ∑ÇÈéñÇÕÇ≈Ç´Ç‹ÇπÇÒÅB", vbExclamation Or vbOKOnly, SSS_PrgNm
'            Call HD_CLEAR
'            Call P_vaData_Init
            Exit Sub
        Else
            Call SSSEXC_EXCTBZ_OPEN
        End If


        Me.MousePointer = vbHourglass
        
        'çXêVèàóù
        Select Case sRegistration(spd_body)
            Case 9
                'ÅúçXêVèàóùé∏îséû
                MsgBox "çXêVÇ…é∏îsÇµÇ‹ÇµÇΩÅB", vbCritical, "çXêVÉGÉâÅ["
            Case 1
            
            Case 0
                'ÅöÉçÉOÇÃèëÇ´èoÇµ
                Call SSSWIN_LOGWRT("ìoò^äÆóπ:" & Left(DB_TOKMTA.TOKSEICD, 5) & ":" & DB_TOKMTA.TOKRN)
                
                mnu_initdsp_Click   'âÊñ ï\é¶ÇÃèâä˙âª

        End Select
        
        Me.MousePointer = vbDefault


    End If

End Sub

'ÉÅÉjÉÖÅ[[ï“èW]Å|[âÊñ èâä˙âª]ëIëéû
Private Sub mnu_initdsp_Click()
    
    intInputMode = 9
    pnl_condition1.Enabled = True
    pnl_condition2.Enabled = True
    'âÊñ ÇÃèâä˙âª
    initCondition
    initHead
    initBody
    'è¡çûì˙Ç…ÉtÉHÅ[ÉJÉXÇà⁄ìÆ
    txt_kesidt.SetFocus
    txt_kesidt.BackColor = vbYellow
    blnINIT_FLG = True
' === 20130708 === INSERT S - FWEST)Koroyasu îrëºêßå‰ÇÃâèú
    Call SSSWIN_Unlock_EXCTBZ
' === 20130708 === INSERT E -

End Sub


'ÉÅÉjÉÖÅ[[ëÄçÏ]Å|[åÛï‚ÇÃàÍóó]
Private Sub mnu_showwnd_Click()
    'è¡çûì˙Ç…ÉtÉHÅ[ÉJÉXÇ™Ç†ÇÈÇ∆Ç´
    If Me.ActiveControl.Name = txt_kesidt.Name Then
        cmd_kesidt_Click

    'êøãÅêÊ∫∞ƒﬁÇ…ÉtÉHÅ[ÉJÉXÇ™Ç†ÇÈÇ∆Ç´
    ElseIf Me.ActiveControl.Name = txt_tokseicd.Name Then
        cmd_tokseicd_Click


    'âÒé˚ó\íËì˙Ç…ÉtÉHÅ[ÉJÉXÇ™Ç†ÇÈÇ∆Ç´
    ElseIf Me.ActiveControl.Name = txt_kaidt_From.Name Then
        Call cmd_kaidt_From_Click

    'âÒé˚ó\íËì˙Ç…ÉtÉHÅ[ÉJÉXÇ™Ç†ÇÈÇ∆Ç´
    ElseIf Me.ActiveControl.Name = txt_kaidt_To.Name Then
        Call cmd_kaidt_To_Click


    'êUçûä˙ì˙Ç…ÉtÉHÅ[ÉJÉXÇ™Ç†ÇÈÇ∆Ç´
    ElseIf Me.ActiveControl.Name = txt_fridt.Name Then
        cmd_fridt_Click
    End If
End Sub



Private Sub spd_body_Change(ByVal Col As Long, ByVal Row As Long)
Dim spd_fridt   As String
Dim spd_fridt_val  As Variant
Dim ret As Boolean
Dim lw_col  As Long
Dim lw_row  As Long

    If Col = 14 Then 'ä˙ì˙êUçûì˙ÇÃÉ`ÉFÉbÉN

        lw_col = Col
        lw_row = Row
        'åoóùí˜ì˙à»ëOÇÃì˙ïtÇÃéûÇÕÉGÉâÅ[
        ret = spd_body.GetText(Col, Row, spd_fridt_val)
        If ret = True Then
            spd_fridt = Format$(spd_fridt_val, "yyyy/mm/dd")
            If Trim$(spd_fridt) = "" Then
                blnUsableButton = True
            End If
            If DeCNV_DATE(spd_fridt) <= DB_SYSTBA.SMAUPDDT Then
                Call showMsg("1", "URKET73_010", 0)     'Åúåoóùí˜ÇﬂçœÇ›ÇÃMSG
                spd_body.Col = lw_col
                spd_body.Row = lw_row
                spd_body.ForeColor = vbRed
                spd_body.Action = 0
                blnUsableButton = False
            Else
                spd_body.Col = Col
                spd_body.Row = Row
                spd_body.ForeColor = vbBlack
                spd_body.Row = Row + 1
                spd_body.Action = 0
                blnUsableButton = True
            End If
        End If
     End If
End Sub

Private Sub spd_body_KeyDown(KeyCode As Integer, Shift As Integer)


    'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫éû
    If KeyCode >= vbKeyF1 And KeyCode <= vbKeyF12 Then
        'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã§í èàóù
        Call CF_FuncKey_Execute(KeyCode, Shift)
    End If

    
End Sub

Private Sub txt_fridt_Validate(Cancel As Boolean)

    'ì¸óÕÉ`ÉFÉbÉN
    chkFridt

    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_fridt.BackColor = vbWhite

End Sub


'êøãÅêÊ∫∞ƒﬁçÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_tokseicd_Change()
    Dim p As Integer

    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»Ç¢éûÇÕ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    If blnUsableEvent = False Then Exit Sub

    blnUsableEvent = False
    p = txt_tokseicd.SelStart

    'ëSäpÇçÌèúÇ∑ÇÈ
    txt_tokseicd.Text = delZenkaku(txt_tokseicd.Text)
    'ì¸óÕílÇ™5byteÇ≈ñ≥Ç¢éûÇÕãÛîíñÑÇﬂ
    txt_tokseicd.Text = txt_tokseicd.Text & Space(5 - Len(txt_tokseicd.Text))

    txt_tokseicd.SelStart = p
    blnUsableEvent = True

    'ÉJÅ[É\ÉãÇ™âEí[Ç…à⁄ìÆÇµÇΩéûÇÕÅAéüÇÃçÄñ⁄Ç÷à⁄ìÆ
    If txt_tokseicd.SelStart = 5 Then
        intChkKb = 1                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉN

        'ì¸óÕÉ`ÉFÉbÉN
        If chkTokseicd = True Then
            'éüçÄñ⁄
            txt_kaidt_From.SetFocus
        End If

    End If
    txt_tokseicd.SelLength = 1

End Sub

'êøãÅêÊ∫∞ƒﬁçÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_tokseicd_GotFocus()
    'êÊì™à íuÇëIëèÛë‘Ç…Ç∑ÇÈ
    txt_tokseicd.SelStart = 0
    txt_tokseicd.SelLength = 1
    'îwåiêFÇâ©êFÇ…Ç∑ÇÈ
    txt_tokseicd.BackColor = vbYellow
    'åüçıèàóùÇé¿çsâ¬î\Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = True
End Sub


'êøãÅêÊ∫∞ƒﬁçÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_tokseicd_KeyDown(KeyCode As Integer, Shift As Integer)

    'ÉLÅ[ì¸óÕêßå‰
    Select Case Ctl_tokseicd_KeyDown(KeyCode, Shift, txt_tokseicd)
        Case 0
            'âΩÇ‡ÇµÇ»Ç¢
        Case 1
            'ì¸óÕÉ`ÉFÉbÉN
            If chkTokseicd = True Then
                'éüçÄñ⁄
                txt_kaidt_From.SetFocus
            End If
        Case 2
            'ì¸óÕÉ`ÉFÉbÉN
            If chkTokseicd = True Then
                'ëOçÄñ⁄
                txt_kesidt.SetFocus
            End If
    End Select
    
    KeyCode = 0
    
End Sub


'êøãÅêÊ∫∞ƒﬁçÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_tokseicd_KeyPress(KeyAscii As Integer)
    'ÉAÉãÉtÉ@ÉxÉbÉgè¨ï∂éöÇëÂï∂éöÇ…ïœä∑Ç∑ÇÈ
    If Chr(KeyAscii) Like "[a-z]" Then
        KeyAscii = KeyAscii - 32
    End If
End Sub

'êøãÅêÊ∫∞ƒﬁçÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_tokseicd_LostFocus()
    
    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_tokseicd.BackColor = vbWhite

End Sub


'è¡çûçœÇ›√ﬁ∞¿ï\é¶çÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_kesikb_Change()
    If txt_kesikb.Text <> 9 Then
        txt_kesikb.Text = 1
    End If
    txt_kesikb.SelStart = 0
    txt_kesikb.SelLength = 1

    If txt_kesikb.Text = 1 Then
        cmd_kaidt_From.Caption = " îÑè„ì˙(äJén)"
    Else
        cmd_kaidt_From.Caption = " *îÑè„ì˙(äJén)"
    End If

End Sub

'è¡çûçœÇ›√ﬁ∞¿ï\é¶çÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kesikb_GotFocus()
    'ëIëèÛë‘Ç…Ç∑ÇÈ
    txt_kesikb.SelStart = 0
    txt_kesikb.SelLength = 1
    'îwåiêFÇâ©êFÇ…Ç∑ÇÈ
    txt_kesikb.BackColor = vbYellow
    'åüçıèàóùÇé¿çsïsâ¬Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = False
End Sub

'è¡çûçœÇ›√ﬁ∞¿ï\é¶çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kesikb_KeyDown(KeyCode As Integer, Shift As Integer)

    'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫éû
    If KeyCode >= vbKeyF1 And KeyCode <= vbKeyF12 Then
        'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã§í èàóù
        Call CF_FuncKey_Execute(KeyCode, Shift)
    End If

    
    'è„ñÓàÛ or ç∂ñÓàÛâüâ∫éû
    If KeyCode = vbKeyUp Or KeyCode = vbKeyLeft Then
        txt_kaidt_To.SetFocus

    'Enter or â∫ñÓàÛ or âEñÓàÛâüâ∫éû
    ElseIf KeyCode = vbKeyReturn Or KeyCode = vbKeyDown Or KeyCode = vbKeyRight Then
        'êøãÅêÊÇÃéxï•èåèÇ™êUçûä˙ì˙ÅAÃß∏¿ÿ›∏ﬁÇÃéûÇÕêUçûä˙ì˙Ç…çÄñ⁄à⁄ìÆ
        'ÇªÇÍà»äOÇÕè¡çûëŒè€Çåüçı
        If blnFriEnabled = True Then
            txt_fridt.SetFocus
        Else
            spd_body.SetFocus
        End If

    'TABâü
    ElseIf KeyCode = vbKeyF16 Then
        'êøãÅêÊÇÃéxï•èåèÇ™êUçûä˙ì˙ÅAÃß∏¿ÿ›∏ﬁÇÃéûÇÕêUçûä˙ì˙Ç…çÄñ⁄à⁄ìÆ
        'ÇªÇÍà»äOÇÕè¡çûëŒè€Çåüçı
        If blnFriEnabled = True Then
            txt_fridt.SetFocus
        Else
            spd_body.SetFocus
        End If

    

    'TABâü
    ElseIf KeyCode = vbKeyF15 Then
        txt_kaidt_To.SetFocus

    
    End If

    KeyCode = 0
End Sub

'è¡çûçœÇ›√ﬁ∞¿ï\é¶çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kesikb_KeyPress(KeyAscii As Integer)
    'êîílÇÃÇ›ì¸óÕâ¬Ç∆Ç∑ÇÈ
    If Not Chr(KeyAscii) Like "[0-9]" Then
        KeyAscii = 0
    End If
End Sub

'è¡çûçœÇ›√ﬁ∞¿ï\é¶çÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kesikb_LostFocus()
    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_kesikb.BackColor = vbWhite
End Sub

'=======================================================ñæç◊ïî(ÉXÉvÉåÉbÉh)=======================================================

'ÉtÉHÅ[ÉJÉXéÊìæéû
Private Sub spd_body_GotFocus()

    If intInputMode <> 1 Then
        Exit Sub
    End If

    'Œﬁ¿›Ç™égópâ¬î\(ñæç◊√ﬁ∞¿Ç†ÇË)ÇÃéûÇÕé¿çsÇµÇ»Ç¢
    If blnUsableButton = True Then Exit Sub

    'ÉwÉbÉ_Ç™ì¸óÕÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉfÅ[É^ÇåüçıÅEï\é¶Ç∑ÇÈ
    If chkCondition = True Then
    
        intInputMode = 2
    
        showBody    'Åö√ﬁ∞¿ï\é¶
        
        'ï‘ïiÇè¡çûÇµÅAÉçÉbÉN
        'ëOéÛÇ≈ÇÕÅAé©ìÆÉ`ÉFÉbÉNã@î\ÇégópÇµÇ»Ç¢ÅB(óLå¯Ç…Ç∑ÇÈèÍçáÇÕÉRÉÅÉìÉgÇäOÇµÇƒÇ≠ÇæÇ≥Ç¢)
        'lockHenpin
        
    End If
End Sub

'ñæç◊Œﬁ¿›∏ÿØ∏éû
Private Sub spd_body_ButtonClicked(ByVal Col As Long, ByVal Row As Long, ByVal ButtonDown As Integer)

    Dim intKesizan  As Currency  'ÉwÉbÉ_ïîè¡çûécäz
    Dim intKomikn   As Currency  'ê≈çûîÑè„äz
    Dim intKesikn   As Currency  'è¡çûäz
    Dim intBfKesikn As Currency  'è¡çûäz(í˜ì˙ëO)
    Dim tmp As Variant

    Dim LS_HYFRIDT As Variant
    Dim sumHenpin       As Currency
    Dim intJDNNOKesikn  As Currency
    Dim intHenkn        As Currency
    Dim strHyjdnno      As String
    Dim str_theHYJDNNO  As String
    Dim intchk          As Integer
    Dim idxRowJDNNO     As Long

'*** 2009/09/03 ADD START FKS)NAKATA V1.03
    Dim strBfHYFRIDT  As String
'*** 2009/09/03 ADD E.N.D FKS)NAKATA



    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»Ç¢éûÇÕ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    If blnUsableSpread = False Then
        Exit Sub
    End If

    
    On Error Resume Next

    With spd_body
        '¡™Ø∏ŒﬁØ∏Ω∏ÿØ∏éûÅAñæç◊ÇÃã‡äzÅAÉwÉbÉ_ÇÃécã‡äzÇ…âûÇ∂ÇƒÉ`ÉFÉbÉNÇÃONÅAOFFÇçsÇ§
        If Col = 1 Then
            .Col = Col
            .Row = Row

            'ï\é¶çsà»è„ÇÃçsÇÉNÉäÉbÉNÇµÇΩéûÇÕÉ`ÉFÉbÉNÇÕÇ¬ÇØÇ»Ç¢
            If Row > intMaxRow Then
                '¡™Ø∏âèúÇµÇ»Ç¢
                blnUsableSpread = False
                .Value = 0
                blnUsableSpread = True
                Exit Sub
            End If

            intKesizan = SSSVal(txt_kesizan.Text)

            'ê≈çûîÑè„äzÇéÊìæ
            Call .GetText(COL_KOMIKN, .Row, tmp)
            intKomikn = SSSVal(tmp)
            
            'ñæç◊ïîè¡çûäz
            Call .GetText(COL_KESIKN, .Row, tmp)
            intKesikn = SSSVal(tmp)

            '¡™Ø∏Ç™ïtÇ¢ÇƒÇ¢ÇƒÅAâèúÇµÇΩéû
            If ButtonDown = 0 Then

               'âèúäzÇ™ÉvÉâÉXÇ≈Ç†ÇÍÇŒÅAñ≥èåèÇ…ÉwÉbÉ_ïîÇ…â¡éZ
                If intKesikn - intBfKesikn > 0 Then
                    txt_kesizan.Text = Format(intKesizan + (intKesikn - intBfKesikn), "###,###,##0")
                    .SetText COL_KESIKN, .Row, intBfKesikn

                
                    If DB_TOKMTA.SHAKB Like "[256]" Then
                        .GetText COL_HYFRIDT, .Row, LS_HYFRIDT
                        If Trim$(LS_HYFRIDT) <> "" Then
                            .SetText COL_HYFRIDT, .Row, ""
                        End If
                    End If


                ElseIf intKesizan >= intBfKesikn - intKesikn Then
                    txt_kesizan.Text = Format(intKesizan + (intKesikn - intBfKesikn), "###,###,##0")
                    .SetText COL_KESIKN, .Row, intBfKesikn


                    If DB_TOKMTA.SHAKB Like "[256]" Then
                        .GetText COL_HYFRIDT, .Row, LS_HYFRIDT
                        If Trim$(LS_HYFRIDT) <> "" Then
                            .SetText COL_HYFRIDT, .Row, ""
                        End If
                    End If

                Else
                    '¡™Ø∏âèúÇµÇ»Ç¢
                    blnUsableSpread = False
                    .Value = 1
                    blnUsableSpread = True
                End If


            '¡™Ø∏Ç™ïtÇ¢ÇƒÇ¢Ç»Ç≠ÇƒÅAÉ`ÉFÉbÉNÇì¸ÇÍÇΩéû
            ElseIf ButtonDown = 1 Then

                    'è¡çûäzÇ™É}ÉCÉiÉXÇ≈Ç†ÇÍÇŒ§ñ≥èåèÇ…ÉwÉbÉ_ïîÇ…â¡éZ
                    If intKomikn - intKesikn < 0 Then
                        txt_kesizan.Text = Format(intKesizan - (intKomikn - intKesikn), "###,###,##0")
                        .SetText COL_KESIKN, .Row, intKomikn
    
                        If DB_TOKMTA.SHAKB Like "[256]" Then
                            .GetText COL_HYFRIDT, .Row, LS_HYFRIDT
                    
                            If Trim$(LS_HYFRIDT) = "" Then
                            '*** 2009/09/03 CHG START FKS)NAKATA V1.03
                                '.SetText COL_HYFRIDT, .Row, txt_fridt.Text
                                Call .GetText(COL_BFHYFRIDT, .Row, tmp)
                                strBfHYFRIDT = tmp
                                .SetText COL_HYFRIDT, .Row, strBfHYFRIDT
                            '*** 2009/09/03 CHG START FKS)NAKATA
                            End If
                        End If
                    'ÉwÉbÉ_è¡çûécÇ™ïâÇÃéûÇÕÉ`ÉFÉbÉNÇÇ¬ÇØÇ»Ç¢
                    ElseIf intKesizan <= 0 Then
    
                        
                        blnUsableSpread = False
                        .Value = 0
                        blnUsableSpread = True
    
                    ElseIf intKesizan >= intKomikn - intKesikn Then
                        txt_kesizan.Text = Format(intKesizan - (intKomikn - intKesikn), "###,###,##0")
                        .SetText COL_KESIKN, .Row, intKomikn
       
                        If DB_TOKMTA.SHAKB Like "[256]" Then
                            .GetText COL_HYFRIDT, .Row, LS_HYFRIDT
                            If Trim$(LS_HYFRIDT) = "" Then
                            '*** 2009/09/03 CHG START FKS)NAKATA V1.03
                                '.SetText COL_HYFRIDT, .Row, txt_fridt.Text
                                Call .GetText(COL_BFHYFRIDT, .Row, tmp)
                                strBfHYFRIDT = tmp
                                .SetText COL_HYFRIDT, .Row, strBfHYFRIDT
                            '*** 2009/09/03 CHG START FKS)NAKATA
                            End If
                        End If
                    Else
                        
                        'àÍïîè[ìñÇÃã÷é~ (ê≈çûîÑè„ã‡äz <> è[ìñã‡äzÇÃèÍçá)
                        Call showMsg("1", "URKET73_041", 0) 'àÍïîè[ìñÇÕÇ≈Ç´Ç‹ÇπÇÒÅB
                        blnUsableSpread = False
                        .Value = 0
                        blnUsableSpread = True
    
''àÍïîè[ìñÇãñÇ∑èÍçáÇÕÅAà»â∫ÇÃÉRÉÅÉìÉgÇäOÇ∑
''DEL START (Å´)
'                        txt_kesizan.Text = Format(0, "###,###,##0")
''                        .SetText COL_KESIKN, .Row, intKesikn + intKesizan
''
''                        If DB_TOKMTA.SHAKB Like "[256]" Then
''                            .GetText COL_HYFRIDT, .Row, LS_HYFRIDT
''                            If Trim$(LS_HYFRIDT) = "" Then
''                                .SetText COL_HYFRIDT, .Row, txt_fridt.Text
''                            End If
''                        End If
''DEL START (Å™)

                    End If
            End If
        End If
    End With
End Sub

'================================================================
'2009/06/12 DEL START FKS)NAKATA

'éËêîópÅEè¡îÔê≈äzÇÃìoò^ÇÕÅAñ{èàóùÇ≈ÇÕçsÇÌÇ»Ç¢ÅB
'ñ{èàóùÇégópÇ∑ÇÈèÍçáÇÕÅAÉRÉÅÉìÉgÉAÉEÉgÇäOÇµ
'Åupnl_tesuryoÅvÅupnl_syohizeiÅvÇÉtÉHÅ[ÉÄÇ©ÇÁçÌèúÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB
'ÉpÉlÉãÇÃâ∫Ç…É{É^ÉìÇâBÇµÇƒÇ¢Ç‹Ç∑ÅB


''éËêîóøŒﬁ¿›é¿çséû
'Private Sub cmd_tesuryo_Click()
'
'    Dim tmp             As Variant
'    Dim intchk          As Long
'    Dim idxRow          As Long
'    Dim idxRowJDNNO     As Long
'
'    Dim kesizan         As Currency 'ÉwÉbÉ_ïîè¡çûécäz
'    Dim kesikn          As Currency 'ñæç◊çsÇÃì¸ã‡çœäz
'
'
'    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»ÇØÇÍÇŒé¿çsÇµÇ»Ç¢
'    If blnUsableButton = False Then Exit Sub
'
'    'Åúç∑äzì¸ã‡âÊñ ÇÃï\é¶
''    FR_SSSSUB.Show (vbModal)
'
'
'    'ÉwÉbÉ_èÓïÒÇÃçƒï\é¶
'    showHead

'    'ÉwÉbÉ_ïîè¡çûécäzÇÃëﬁî
'    kesizan = txt_kesizan.Text
'
'    With spd_body
'        For idxRow = 1 To intMaxRow
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
'            .GetText COL_CHK, idxRow, tmp
'            intchk = SSSVal(tmp)
'
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
'            If intchk = 1 Then
'                'è¡çûäzÇÃéÊìæ
'                Call .GetText(COL_KESIKN, idxRow, tmp)
'                kesikn = kesikn + CCur(tmp)
'            End If
'
'       Next idxRow
'    End With
'
'    txt_kesizan.Text = Format(kesizan - kesikn, "###,###,##0")
'
'End Sub
'
''è¡îÔê≈äzŒﬁ¿›é¿çséû
'Private Sub cmd_syohi_Click()
'
'
'    Dim tmp             As Variant
'    Dim intchk          As Long
'    Dim idxRow          As Long
'    Dim idxRowJDNNO     As Long
'
'    Dim kesizan         As Currency 'ÉwÉbÉ_ïîè¡çûécäz
'    Dim kesikn          As Currency 'ñæç◊çsÇÃì¸ã‡çœäz
'
'
'    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»ÇØÇÍÇŒé¿çsÇµÇ»Ç¢
'    If blnUsableButton = False Then Exit Sub
'
'    'Åúç∑äzì¸ã‡âÊñ ÇÃï\é¶
'    FR_SSSSUB.Show (vbModal)
'
'
'    'ÉwÉbÉ_èÓïÒÇÃçƒï\é¶
'    showHead
'
'    'ÉwÉbÉ_ïîè¡çûécäzÇÃëﬁî
'    kesizan = txt_kesizan.Text
'
'    With spd_body
'        For idxRow = 1 To intMaxRow
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
'            .GetText COL_CHK, idxRow, tmp
'            intchk = SSSVal(tmp)
'
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
'            If intchk = 1 Then
'                'è¡çûäzÇÃéÊìæ
'                Call .GetText(COL_KESIKN, idxRow, tmp)
'                kesikn = kesikn + CCur(tmp)
'            End If
'
'       Next idxRow
'    End With
'
'    txt_kesizan.Text = Format(kesizan - kesikn, "###,###,##0")
'
'
'End Sub
'2009/06/12 DEL E.N.D FKS)NAKATA
'================================================================


'ëSè¡çûŒﬁ¿›é¿çséû
Private Sub cmd_zenkesi_Click()
    Dim i As Integer
    Dim varKesikn As Variant

    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»ÇØÇÍÇŒé¿çsÇµÇ»Ç¢
    If blnUsableButton = False Then Exit Sub
    

'ëSè¡çûÉ{É^ÉìÇâüâ∫éûÇÕÅAèâä˙ï\é¶éûÇ∆ìØÇ∂è¡çûëŒè€Ç…É`ÉFÉbÉNÇì¸ÇÍÇÈÅB
'ëOéÛÇ≈ÇÕÅAé©ìÆÉ`ÉFÉbÉNã@î\ÇégópÇµÇ»Ç¢ÅB(óLå¯Ç…Ç∑ÇÈèÍçáÇÕÉRÉÅÉìÉgÇäOÇµÇƒÇ≠ÇæÇ≥Ç¢)
'    lockHenpin


    'ëSçsÇ…ëŒÇµÅA¡™Ø∏ŒﬁØ∏ΩÇÃ¡™Ø∏
    For i = 1 To intMaxRow
        With spd_body
            .Col = COL_CHK
            .Row = i
            If .Value = 0 Then
                'ëSè¡çûéûÇ…É`ÉFÉbÉNÇ™ì¸ÇÁÇ»Ç¢ïsãÔçáÇèCê≥ 2007/02/28 Saito
                spd_body_ButtonClicked COL_CHK, i, 1
                .GetText COL_KESIKN, i, varKesikn
                If SSSVal(varKesikn) <> 0 Then
                    blnUsableSpread = False
                    .Value = 1
                    blnUsableSpread = True
                End If
            End If
        End With
    Next i

End Sub

'ëSâèúŒﬁ¿›é¿çséû
Private Sub cmd_zenkaijo_Click()
    Dim i As Integer
    Dim varKesikn As Variant
    Dim varBfKesikn As Variant

    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»ÇØÇÍÇŒé¿çsÇµÇ»Ç¢
    If blnUsableButton = False Then Exit Sub

    'ëSçsÇ…ëŒÇµÅA¡™Ø∏ŒﬁØ∏ΩÇÃâèú
    For i = 1 To intMaxRow
        With spd_body
            .Col = COL_CHK
            .Row = i
            If .Value = 1 Then
                'âèúéûÇ…É`ÉFÉbÉNÇ™äOÇÍÇ»Ç¢ïsãÔçáÇèCê≥ 2007/02/28 Saito
                spd_body_ButtonClicked COL_CHK, i, 0
            

                .GetText COL_KESIKN, i, varKesikn
                .GetText COL_BFKESIKN, i, varBfKesikn

                If SSSVal(varKesikn) = 0 Then

                    blnUsableSpread = False
                    .Value = 0
                    blnUsableSpread = True
                End If

            End If
        End With
    Next i
End Sub

'çƒï\é¶Œﬁ¿›é¿çséû
Private Sub cmd_saihyoji_Click()
    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»ÇØÇÍÇŒé¿çsÇµÇ»Ç¢
    If blnUsableButton = False Then Exit Sub


    If ChkInputChange() = True Then
        If showMsg("1", "URKET73_040", 0) = vbNo Then
            Exit Sub
        End If
    End If

    
    'ÉwÉbÉ_Ç™ì¸óÕÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉfÅ[É^ÇåüçıÅEï\é¶Ç∑ÇÈ
    If chkCondition = True Then

        intInputMode = 2

        showBody    'Åö√ﬁ∞¿ï\é¶
               
        'ëOéÛÇ≈ÇÕÅAé©ìÆÉ`ÉFÉbÉNã@î\ÇégópÇµÇ»Ç¢ÅB(óLå¯Ç…Ç∑ÇÈèÍçáÇÕÉRÉÅÉìÉgÇäOÇµÇƒÇ≠ÇæÇ≥Ç¢)
        'ï‘ïiÇè¡çûÇµÅAÉçÉbÉN
        'lockHenpin

    End If

End Sub

'è¡çûì˙Œﬁ¿›∏ÿØ∏éû
Private Sub cmd_kesidt_Click()
    If txt_kesidt.Enabled = False Then Exit Sub

    If Trim(txt_kesidt.Text) <> "" Then
        Set_date = txt_kesidt.Text
    Else
        Set_date = CNV_DATE(gstrUnydt)
    End If

    WLSDATE_RTNCODE = ""

    'ÉJÉåÉìÉ_Å[ÉEÉBÉìÉhÉEÇï\é¶
    WLS_DATE.Show vbModal
    Unload WLS_DATE

    txt_kesidt.SetFocus
    If WLSDATE_RTNCODE <> "" Then
        txt_kesidt.Text = WLSDATE_RTNCODE
        intChkKb = 1                   'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
        txt_tokseicd.SetFocus
    End If
End Sub

'êøãÅêÊ∫∞ƒﬁŒﬁ¿›∏ÿØ∏éû
Private Sub cmd_tokseicd_Click()
    If txt_tokseicd.Enabled = False Then Exit Sub
    WLS_TOK1.Show vbModal
    Unload WLS_TOK1

    txt_tokseicd.SetFocus
    If WLSTOKSUB_RTNCODE <> "" Then
        txt_tokseicd.Text = WLSTOKSUB_RTNCODE
        intChkKb = 1
        chkTokseicd
        txt_kaidt_From.SetFocus

    End If
End Sub

'âÒé˚ì˙Œﬁ¿›∏ÿØ∏éû
Private Sub cmd_kaidt_From_Click()
    
    If txt_kaidt_From.Enabled = False Then Exit Sub

    If Trim(txt_kaidt_From.Text) <> "" Then
        Set_date = txt_kaidt_From.Text
    Else
        Set_date = CNV_DATE(gstrUnydt)
    End If

    WLSDATE_RTNCODE = ""

    'ÉJÉåÉìÉ_Å[ÉEÉBÉìÉhÉEÇï\é¶
    WLS_DATE.Show vbModal
    Unload WLS_DATE

    txt_kaidt_From.SetFocus
    If WLSDATE_RTNCODE <> "" Then
        txt_kaidt_From.Text = WLSDATE_RTNCODE
        intChkKb = 1                   'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
        txt_kaidt_To.SetFocus
    End If

End Sub


'âÒé˚ì˙Œﬁ¿›∏ÿØ∏éû
Private Sub cmd_kaidt_To_Click()
    If txt_kaidt_To.Enabled = False Then Exit Sub

    If Trim(txt_kaidt_To.Text) <> "" Then
        Set_date = txt_kaidt_To.Text
    Else
        Set_date = CNV_DATE(gstrUnydt)
    End If

    WLSDATE_RTNCODE = ""

    'ÉJÉåÉìÉ_Å[ÉEÉBÉìÉhÉEÇï\é¶
    WLS_DATE.Show vbModal
    Unload WLS_DATE

    txt_kaidt_To.SetFocus
    If WLSDATE_RTNCODE <> "" Then
        txt_kaidt_To.Text = WLSDATE_RTNCODE
        intChkKb = 1                   'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
        txt_kesikb.SetFocus
    End If
End Sub


'êUçûä˙ì˙Œﬁ¿›∏ÿØ∏éû
Private Sub cmd_fridt_Click()
    'êUçûä˙ì˙Ç™ì¸óÕÇ≈Ç´Ç»Ç¢éûÇÕ≤Õﬁ›ƒÇÕé¿çsÇµÇ»Ç¢
    If blnFriEnabled = False Then Exit Sub
    If txt_fridt.Enabled = False Then Exit Sub

    If Trim(txt_fridt.Text) <> "" Then
        If IsDate(txt_fridt.Text) = True Then
            Set_date = txt_fridt.Text
        Else
            Set_date = CNV_DATE(gstrUnydt)
            txt_fridt.Text = ""
        End If
    Else
        Set_date = CNV_DATE(gstrUnydt)
    End If

    WLSDATE_RTNCODE = ""

    'ÉJÉåÉìÉ_Å[ÉEÉBÉìÉhÉEÇï\é¶
    WLS_DATE.Show vbModal
    Unload WLS_DATE

    txt_fridt.SetFocus
    If WLSDATE_RTNCODE <> "" Then
        txt_fridt.Text = WLSDATE_RTNCODE
        intChkKb = 1                   'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
        spd_body.SetFocus
    End If
End Sub

'**** 2009/09/19 ADD START FKS)NAKATA
'ï™î[ëŒâû
Private Sub getHenpinKingaku()
    
    
    Dim idxRow          As Long
    Dim tmp             As Variant
    
    
    Dim i               As Long
    Dim strHenpin       As String
    Dim strJdnno        As String
    Dim strJdnlinno     As String
    Dim strOkrjono      As String
    Dim curKomikn       As Currency
    Dim maxSeq           As Integer
        
    On Error Resume Next

    With spd_body
    
        For idxRow = 1 To intMaxRow
        
            strHenpin = ""
            
            'ï‘ïiÉtÉâÉOÇÃéÊìæ
            Call .GetText(COL_HENPI, idxRow, tmp)
            strHenpin = CStr(tmp)
            
            
            'ï‘ïiÇ≈Ç†ÇÍÇŒÅAã‡äzí≤êÆÇçsÇ§
            If strHenpin = "1" Then

                'éÛíçî‘çÜÇÃéÊìæ
                Call .GetText(COL_JDNNO, idxRow, tmp)
                strJdnno = CStr(tmp)
                
                'éÛíççsî‘çÜÇÃéÊìæ
                Call .GetText(COL_JDNLINNO, idxRow, tmp)
                strJdnlinno = CStr(tmp)

                'ê≈çûîÑè„ã‡äzÇÃéÊìæ
                Call .GetText(COL_KOMIKN, idxRow, tmp)
                curKomikn = CCur(tmp)
                
                'ëóÇËèÛáÇÇÃéÊìæ
                strOkrjono = getOKRJONO(strJdnno, strJdnlinno)


                For i = 0 To UBound(ARY_NYUKN_KS)
                
                    'éÛíçî‘çÜ
                    If ARY_NYUKN_KS(i).OKRJONO = strOkrjono Then
                        maxSeq = i
                    End If
                    
                Next i

                'ï‘ïiÇÃã‡äzÇécã‡Ç÷â¡éZÇ∑ÇÈ
                ARY_NYUKN_KS(maxSeq).ZANKN = ARY_NYUKN_KS(maxSeq).ZANKN + curKomikn * (-1)
            
            End If
    
        Next idxRow
        
    End With
    
End Sub
'**** 2009/09/19 ADD E.N.D FKS)NAKATA


'ï‘ïiè¡çû
Private Sub lockHenpin()
    Dim intKesizan      As Currency  'ÉwÉbÉ_ïîè¡çûécäz
    Dim intKomikn       As Currency  'ê≈çûîÑè„äz
    Dim intKesikn       As Currency  'è¡çûäz
    Dim intBfKesikn     As Currency  'è¡çûäz(í˜ì˙ëO)
    Dim tmp             As Variant
    Dim LS_HYFRIDT      As Variant
    Dim idxRow          As Long
    Dim idxRowJDNNO     As Long
    Dim strFRIDT        As String
    Dim strHyjdnno      As String
    Dim str_theHYJDNNO  As String
    Dim intchk          As Integer

    On Error Resume Next
    'êUçûä˙ì˙ÇéÊìæ

    strFRIDT = txt_fridt.Text
    'è¡çûécäzÇéÊìæ

    intKesizan = SSSVal(txt_kesizan.Text)
    'ï‘ïiÇåüçı

    With spd_body

        For idxRow = 1 To intMaxRow
            'ê≈çûîÑè„äzÇéÊìæ

            Call .GetText(COL_KOMIKN, idxRow, tmp)
            intKomikn = SSSVal(tmp)
            'ì¸ã‡çœäzÇéÊìæ

            Call .GetText(COL_KESIKN, idxRow, tmp)
            intKesikn = SSSVal(tmp)
            'í˜ì˙à»ëOè¡çûäz


            Call .GetText(COL_KESIKN_MAE, idxRow, tmp)
            intBfKesikn = SSSVal(tmp)

            
            'è¡çûäzÇ™É}ÉCÉiÉXÇ≈Ç†ÇÍÇŒìØàÍéÛíçî‘çÜÇ≈ëäéE
            If intKomikn - intKesikn < 0 Then
                
                'è¡çûäzÇè¡çûécäzÇ÷í«â¡
                intKesizan = intKesizan - (intKomikn - intKesikn)
                
                'ì¸ã‡çœäzê›íË
                .SetText COL_KESIKN, idxRow, intKomikn
                
                'É`ÉFÉbÉNÉ{ÉbÉNÉXê›íË
                blnUsableSpread = False
                .Row = idxRow
                .Col = COL_CHK
                .Value = 1
                blnUsableSpread = True
                

                Call .SetText(COL_HENPI, idxRow, "1")

                
                'éÛíçî‘çÜéÊìæ
                Call .GetText(COL_HYJDNNO, idxRow, tmp)
                strHyjdnno = CStr(tmp)
                
                'ìØàÍéÛíçî‘çÜÇåüçı
                For idxRowJDNNO = intMaxRow To 1 Step -1
                    .GetText COL_HYJDNNO, idxRowJDNNO, tmp
                    str_theHYJDNNO = CStr(tmp)
                    
                    'éÛíçî‘çÜàÍívÇ∑ÇÍÇŒëäéE
                    If strHyjdnno <> str_theHYJDNNO Then
                    Else
                        .GetText COL_CHK, idxRowJDNNO, tmp
                        intchk = SSSVal(tmp)
                        
                        'é©ï™é©êgÇ≈Ç»Ç¢ÅAÇ‹ÇΩÇÕÉ`ÉFÉbÉNÇ≥ÇÍÇƒÇ¢Ç»Ç¢
                        If idxRowJDNNO <> idxRow And intchk = 1 Then
                        Else
                            
                            'ê≈çûîÑè„äzÇéÊìæ
                            Call .GetText(COL_KOMIKN, idxRowJDNNO, tmp)
                            intKomikn = SSSVal(tmp)
                            
                            'ì¸ã‡çœäzÇéÊìæ
                            Call .GetText(COL_KESIKN, idxRowJDNNO, tmp)
                            intKesikn = SSSVal(tmp)
                            
                            'í˜ì˙à»ëOè¡çûäz

                            Call .GetText(COL_KESIKN_MAE, idxRow, tmp)
                            intBfKesikn = SSSVal(tmp)
                            
                            'ê≈çûîÑè„ã‡äzëSäzëäéE
                            If intKesizan >= intKomikn - intKesikn Then
                                
                                'ì¸ã‡çœäzê›íË
                                .SetText COL_KESIKN, idxRowJDNNO, intKomikn
                                
                                'É`ÉFÉbÉNÉ{ÉbÉNÉXê›íË
                                blnUsableSpread = False
                                .Row = idxRowJDNNO
                                .Col = COL_CHK
                                .Value = 1
                                blnUsableSpread = True
                                
                                Call .SetText(COL_HENPI, idxRowJDNNO, "1")

                                'è¡çûécäzê›íË
                                intKesizan = intKesizan - (intKomikn - intKesikn)
                                
                                'êUçûä˙ì˙ê›íË
                                If DB_TOKMTA.SHAKB Like "[256]" Then
                                    .GetText COL_HYFRIDT, idxRowJDNNO, LS_HYFRIDT
                                    If Trim$(LS_HYFRIDT) = "" Then
                                        .SetText COL_HYFRIDT, idxRowJDNNO, strFRIDT
                                    End If
                                End If
                                'ê≈çûîÑè„ã‡äzàÍïîëäéE
                                'ì¸ã‡çœäzê›íË

                            Else

                                .SetText COL_KESIKN, idxRowJDNNO, intKesikn + intKesizan
                                'É`ÉFÉbÉNÉ{ÉbÉNÉXê›íË


                           ''è¡çûécäzÇ™É[ÉçÇÃèÍçáÅAÉ`ÉFÉbÉNÇÇ¬ÇØÇ»Ç¢
                            If intKesizan > 0 Then

                           
                                blnUsableSpread = False
                                .Row = idxRowJDNNO
                                .Col = COL_CHK
                                .Value = 1
                                blnUsableSpread = True
                           

                                Call .SetText(COL_HENPI, idxRowJDNNO, "1")

                        
                            End If
                                                           
                                'è¡çûécäzÉ[Éç
                                intKesizan = 0
                                
                                'êUçûä˙ì˙ê›íË
                                If DB_TOKMTA.SHAKB Like "[256]" Then
                                    .GetText COL_HYFRIDT, idxRowJDNNO, LS_HYFRIDT
                                    If Trim$(LS_HYFRIDT) = "" Then
                                        .SetText COL_HYFRIDT, idxRowJDNNO, strFRIDT
                                        'è¡çûécäzÇê›íË

                                    End If
                                End If
                            End If
                        End If
                    End If
                Next idxRowJDNNO
            End If
        Next idxRow
    End With

    txt_kesizan.Text = Format(intKesizan, "###,###,##0")

End Sub

' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF Function chk_HENPIN
'   äTóvÅF í˜ì˙ÇÇ‹ÇΩÇ¢Ç≈ï‘ïiìoò^ÅAéÛíçí˘ê≥ÇçsÇ¡ÇΩç€
'          ê‘çïÇ…ÇƒëäéEÇ≥ÇÍÇÈéÛíçÇï\é¶ÇµÇ»Ç¢
'   à¯êîÅF strJdnNo   : éÛíçì`ï[î‘çÜ
'   Å@Å@ÅF strJdnlinNo: éÛíçì`ï[çsî‘çÜ
'       :  strUrikn   : îÑè„ã‡äz
'   ñﬂílÅF É`ÉFÉbÉNåãâ 
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+

Function chkHenpin(ByVal strJdnno As String, ByVal strJdnlinno As String, ByVal strRECNO As String, _
                                    ByVal strWrtFstDt As String, ByVal strWrtFstTm As String, ByVal strUritk As String, ByVal strUrikn As String) As Boolean


    
    Dim Usr_Ody         As U_Ody
    Dim Usr_Ody2         As U_Ody
    Dim strSql          As String
    
    On Error GoTo ERR_chkHENPIN

    chkHenpin = False
    
    strSql = " "
    strSql = " SELECT *"
    strSql = strSql & " FROM    UDNTRA"
    strSql = strSql & " WHERE   JDNNO    =  '" & Trim$(strJdnno) & "'"
    strSql = strSql & " AND     JDNLINNO =  '" & Trim$(strJdnlinno) & "'"
    strSql = strSql & " AND     DATKB =  '1'"
    strSql = strSql & " AND     AKAKROKB =  '9'"
    strSql = strSql & " AND     DKBID    =  '01'"
    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
    
    'ÉfÅ[É^Ç™ë∂ç›ÇµÇΩèÍçá
    Do While CF_Ora_EOF(Usr_Ody) = False
                   
        'è¡çûÇ≥ÇÍÇƒÇ¢Ç»Ç¢èÍçáÅAèàóùÇçsÇ§
        If Trim$(CF_Ora_GetDyn(Usr_Ody, "KESIKB", "")) <> "1" Then
                 
            'ï‘ïióùóRÇ…ílÇ™äiî[Ç≥ÇÍÇƒÇ¢ÇÈîÑè„ÇëŒè€Ç∆Ç∑ÇÈ
            If Trim$(CF_Ora_GetDyn(Usr_Ody, "HENRSNCD", "")) <> "" And CF_Ora_GetDyn(Usr_Ody, "DKBID", "") = "01" Then
                
                
                'çïÇ∆ê‘ÇÃURIKNÇÃç∑äzÇ™Åu0ÅvÇ…Ç»ÇÈÇÃÇ»ÇÁï\é¶ÇµÇ»Ç¢
                If CLng(strUrikn) = CLng(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")) * (-1) Then
                    chkHenpin = False
                    GoTo END_chkHENPIN
                Else


                'ï‘ïiìoò^ÇçsÇ¡ÇΩéÛíçÇ…ëŒÇµíPâøí˘ê≥ÇçsÇ¡ÇΩèÍçáÅAãåíPâøÇ∆ÇªÇÃéûÇÃï‘ïiÉåÉRÅ[ÉhÇèoóÕÇµÇ»Ç¢ÇÊÇ§èCê≥
                
                    strSql = " "
                    strSql = " SELECT COUNT(*) AS CNT"
                    strSql = strSql & " FROM    UDNTRA"
                    strSql = strSql & " WHERE   JDNNO       =  '" & Trim$(strJdnno) & "'"
                    strSql = strSql & " AND     JDNLINNO    =  '" & Trim$(strJdnlinno) & "'"
                    strSql = strSql & " AND     DATKB       =  '1'"
                    strSql = strSql & " AND     AKAKROKB    =  '1'"
                    strSql = strSql & " AND     DKBID       =  '01'"
                    strSql = strSql & " AND     RECNO       =  '" & Trim$(strRECNO) & "'"
                    strSql = strSql & " AND     URITK       !=   " & strUritk & " "
                    strSql = strSql & " AND     (WRTFSTDT || WRTFSTTM)  >  '" & strWrtFstDt & strWrtFstTm & "'"

                    'DBÉAÉNÉZÉX
                    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody2, strSql)

                    'ÉfÅ[É^Ç™ë∂ç›ÇµÇΩèÍçá
                    Do While CF_Ora_EOF(Usr_Ody2) = False
                        
                       If CLng(CF_Ora_GetDyn(Usr_Ody2, "CNT", 0)) >= 1 Then
                            chkHenpin = False
                            Call CF_Ora_CloseDyn(Usr_Ody2)
                            GoTo END_chkHENPIN
                       Else
                            chkHenpin = True
                            Call CF_Ora_CloseDyn(Usr_Ody2)
                            GoTo END_chkHENPIN
                       End If
                       Usr_Ody2.Obj_Ody.MoveNext
                    Loop

                End If
            End If
            
        End If
        
        Usr_Ody.Obj_Ody.MoveNext
    Loop
    
    chkHenpin = True
    
END_chkHENPIN:
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody)

    Exit Function

ERR_chkHENPIN:
    GoTo END_chkHENPIN

End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF Function chkHenpinTeisei
'   äTóvÅF í˜ì˙ÇÇ‹ÇΩÇ¢Ç≈ï‘ïiìoò^ÅAéÛíçí˘ê≥ÇçsÇ¡ÇΩç€
'          ê‘çïÇ…ÇƒëäéEÇ≥ÇÍÇÈéÛíçÇï\é¶ÇµÇ»Ç¢
'   à¯êîÅF strJdnNo   : éÛíçì`ï[î‘çÜ
'   Å@Å@ÅF strJdnlinNo: éÛíçì`ï[çsî‘çÜ
'   Å@Å@ÅF strUrikn   : îÑè„ã‡äz
'   Å@Å@ÅF strUdnno   : îÑè„ì`ï[î‘çÜ
'   Å@Å@ÅF strLinno   : çsî‘çÜ
'   Å@Å@ÅF strUriDt   : îÑè„ì˙
'   ñﬂílÅF É`ÉFÉbÉNåãâ 
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Function chkHenpinTeisei(ByVal strJdnno As String, ByVal strJdnlinno As String, ByVal strUrikn As String, _
                                ByVal strUDNNO As String, ByVal strLINNO As String, ByVal strURIDT As String, ByVal strWrtFstDt As String, ByVal strWrtFstTm As String) As Boolean

    Dim Usr_Ody         As U_Ody
    Dim strSql          As String
    
    On Error GoTo ERR_chkHenpinTeisei

    chkHenpinTeisei = False
    
    strSql = " "
    
    strSql = " SELECT *"
    strSql = strSql & " FROM    UDNTRA"
    strSql = strSql & " WHERE   JDNNO    =  '" & strJdnno & "'"
    strSql = strSql & " AND     JDNLINNO =  '" & strJdnlinno & "'"
    strSql = strSql & " AND     DATKB =  '1'"
    strSql = strSql & " AND     AKAKROKB =  '9'"
    strSql = strSql & " AND     DKBID =  '01'"
    strSql = strSql & " AND     UDNNO  <>  '" & strUDNNO & "'"
    strSql = strSql & " AND     LINNO  =  '" & strLINNO & "'"
  '  strSql = strSql & " AND     UDNDT <>  '" & strURIDT & "'"
    strSql = strSql & " AND     (WRTFSTDT || WRTFSTTM)  <>  '" & strWrtFstDt & strWrtFstTm & "'"


    
    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
    
    'ÉfÅ[É^Ç™ë∂ç›ÇµÇΩèÍçá
    Do While CF_Ora_EOF(Usr_Ody) = False
    
        'è¡çûÇ≥ÇÍÇƒÇ¢Ç»Ç¢èÍçáÅAèàóùÇçsÇ§
        If Trim$(CF_Ora_GetDyn(Usr_Ody, "KESIKB", "")) <> "1" Then
                                
            'çïÇ∆ê‘ÇÃURIKNÇÃç∑äzÇ™Åu0ÅvÇ…Ç»ÇÈÇÃÇ»ÇÁï\é¶ÇµÇ»Ç¢
            If (CLng(strUrikn) + CLng(CF_Ora_GetDyn(Usr_Ody, "URIKN", ""))) = 0 Then
                chkHenpinTeisei = False
                GoTo END_chkHenpinTeisei
            Else
                chkHenpinTeisei = True
                GoTo END_chkHenpinTeisei
            End If
        
        End If
        
        Usr_Ody.Obj_Ody.MoveNext
    Loop
    
    chkHenpinTeisei = True
    
END_chkHenpinTeisei:
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody)

    Exit Function

ERR_chkHenpinTeisei:
    GoTo END_chkHenpinTeisei

End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF Sub chkAkaKro
'   äTóvÅF àÍïîï‘ïiÇ™ë∂ç›Ç∑ÇÈîÑè„Çè¡çûÇ∑ÇÈç€ÅAê‘Ç∆çïÇäÑÇËèoÇµ
'Å@Å@Å@Å@  ê‘ÇÃÇ›è¡çûÇ≥ÇÍÇÈèÍçáÇÕÅAÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇèoÇ∑ÅB
'          çïÇÃÇ›è¡çûÇ≥ÇÍÇÈèÍçáÇÕÅAê‘ÇÃë∂ç›Ç™Ç†ÇÈÇ±Ç∆ÇÉÅÉbÉZÅ[ÉWÇ∑ÇÈÅB
'
'   îıçlÅF 2008/08/13 ï™î[Ç≥ÇÍÇΩîÑè„Ç…ëŒÇµÇƒÇÃê‘çïÉ`ÉFÉbÉNÇÃí«â¡ÅEèCê≥
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkAkaKro()

    Dim intKesizan      As Currency  'ÉwÉbÉ_ïîè¡çûécäz
    Dim intKomikn       As Currency  'ê≈çûîÑè„äz
    Dim intKesikn       As Currency  'è¡çûäz
    Dim intBfKesikn     As Currency  'è¡çûäz(í˜ì˙ëO)
    Dim intAfKesikn     As Currency

    Dim intUrikn        As Currency  'îÑè„ã‡äz
    Dim wkKesikn        As Currency  'ê‘çïÉ`ÉFÉbÉNópè¡çûã‡ÉèÅ[ÉNïœêî
    Dim sumKesikn       As Currency  'ê‘çïÉ`ÉFÉbÉNópè¡çûã‡ïœêî
    Dim Cnt             As Integer   'ê‘çïÉ`ÉFÉbÉNópÉJÉEÉìÉgïœêî
    Dim i               As Integer   'ê‘çïÉ`ÉFÉbÉNóp
    Dim wkRow           As Long      'ê‘çïÉ`ÉFÉbÉNópçsî‘çÜ

    Dim tmp             As Variant
    Dim LS_HYFRIDT      As Variant
    Dim idxRow          As Long
    Dim idxRowJDNNO     As Long
    Dim strFRIDT        As String
    Dim strHyjdnno      As String
    Dim str_theHYJDNNO  As String
    Dim intchk          As Integer
    Dim strUDNDT       As String
     
     
    chkAkaKro = True
    
    'ï‘ïiÇåüçı
    With spd_body
        For idxRow = 1 To intMaxRow
            
            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
            .GetText COL_CHK, idxRow, tmp
            intchk = SSSVal(tmp)

            
            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
            If intchk = 1 Then

                ''ê‘çïÉ`ÉFÉbÉNîzóÒÇÃèâä˙âª
                ReDim Preserve AKAKRO_CHK(0)
                Cnt = 1
             
                'âÊñ ì¸óÕílÇÃè¡çûì˙à»ç~ÇÃì˙ïtÇ≥ÇÍÇƒÇ¢ÇÈèÍçáÉGÉâÅ[Ç∆Ç∑ÇÈÅB
                'îÑè„ì˙ÇÃéÊìæ
                Call .GetText(COL_UDNDT, idxRow, tmp)
                strUDNDT = CStr(tmp)
                
                If strUDNDT > DeCNV_DATE(Trim$(txt_kesidt.Text)) Then
                    MsgBox ("ì¸óÕÇ≥ÇÍÇΩè¡çûì˙à»ç~ÇÃîÑè„Ç™ë∂ç›ÇµÇ‹Ç∑ÅB")
                    chkAkaKro = False
                    Exit Function
                End If
                
                'ì¸ã‡çœäz(í˜ì˙ëO)
                Call .GetText(COL_BFKESIKN, idxRow, tmp)
                intBfKesikn = SSSVal(tmp)
                
                'ì¸ã‡çœäz(í˜ì˙å„)
                Call .GetText(COL_AFKESIKN, idxRow, tmp)
                intAfKesikn = SSSVal(tmp)
                
                
                'ì¸ã‡çœäzÇéÊìæ
                Call .GetText(COL_KESIKN, idxRow, tmp)
                intKesikn = SSSVal(tmp)
                
                'à»ëOÇ…è¡çûÇ≥ÇÍÇƒÇ¢ÇÈÇ‡ÇÃà»äO
                If intBfKesikn + intAfKesikn = 0 Then
                                
                    'è¡çûäzÇ™É}ÉCÉiÉXÇ≈Ç†ÇÍÇŒìØàÍéÛíçî‘çÜÇÃçïÇåüçı
                    If intKesikn < 0 Then
                                               
                        'éÛíçî‘çÜéÊìæ
                        Call .GetText(COL_HYJDNNO, idxRow, tmp)
                        strHyjdnno = CStr(tmp)
                        

                       'ê‘ÇÃÉfÅ[É^ÇîzóÒÇ…äiî[
                        AKAKRO_CHK(0).idx = idxRow
                        AKAKRO_CHK(0).CHKMK = intchk
                        AKAKRO_CHK(0).UDNDT = strUDNDT
                        AKAKRO_CHK(0).JDNNO = strHyjdnno
                        AKAKRO_CHK(0).KESIKN = intKesikn

                                
                        'ìØàÍéÛíçî‘çÜÇåüçı
                        For idxRowJDNNO = intMaxRow To 1 Step -1
                            .GetText COL_HYJDNNO, idxRowJDNNO, tmp
                            str_theHYJDNNO = CStr(tmp)
                            
                            'éÛíçî‘çÜàÍívÇ∑ÇÍÇŒëäéE
                            If strHyjdnno <> str_theHYJDNNO Then
                            Else
                                .GetText COL_CHK, idxRowJDNNO, tmp
                                intchk = SSSVal(tmp)
                                
                            
                             
                                If idxRowJDNNO <> idxRow Then
                               
                                   ''ìØàÍéÛíçî‘çÜÇÃçïÇÃè¡çûã‡äzÇéÊìæ
                                    .GetText COL_KESIKN, idxRowJDNNO, tmp
                                    wkKesikn = SSSVal(tmp)
                                    
                                    
                                    .GetText COL_UDNDT, idxRowJDNNO, tmp
                                     strUDNDT = CStr(tmp)
                                   
                                   ''ìØàÍéÛíçî‘çÜÇÃçïÇîzóÒÇ…äiî[
                                    ReDim Preserve AKAKRO_CHK(Cnt)
                                    
                                    AKAKRO_CHK(Cnt).idx = idxRowJDNNO
                                    AKAKRO_CHK(Cnt).CHKMK = intchk
                                    AKAKRO_CHK(Cnt).JDNNO = strHyjdnno
                                    AKAKRO_CHK(Cnt).UDNDT = strUDNDT
                                    AKAKRO_CHK(Cnt).KESIKN = wkKesikn
                                
                                    Cnt = Cnt + 1
                                End If
                    
                            End If
                        Next idxRowJDNNO
                        
                        
                        ''ï‘ïiÇÃê‘çïÉ`ÉFÉbÉN
                        'ÉTÉ}ÉäÇÃèâä˙âª
                        sumKesikn = AKAKRO_CHK(0).KESIKN
                        
                        For i = 1 To Cnt - 1
                        
                            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢Ç»Ç¢èÍçá
                            If AKAKRO_CHK(i).CHKMK = 0 Then
                                
                                wkRow = AKAKRO_CHK(i).idx
                                strUDNDT = AKAKRO_CHK(i).UDNDT
                            
                            'ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
                            Else
                                'ê‘ÇÃÉ}ÉCÉiÉXÇÃè¡çûã‡à»è„Ç…çïÇÃè¡çûÇ™Ç≥ÇÍÇƒÇ¢ÇÈ
                                 If sumKesikn + AKAKRO_CHK(i).KESIKN >= 0 Then
                                    sumKesikn = 0
                                    Exit For
                                Else
                                    '
                                    wkRow = AKAKRO_CHK(i).idx
                                    sumKesikn = sumKesikn + AKAKRO_CHK(i).KESIKN
                                End If
                            
                            End If
                        Next i
                        
                        'ÉTÉ}ÉäÇ™É}ÉCÉiÉXÇ…Ç»Ç¡ÇƒÇ¢ÇÈèÍçáÇÕÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶
                        If Cnt - 1 >= 1 And sumKesikn < 0 Then
                            MsgBox ("è[ìñÇ™ïKóvÇ»îÑè„Ç™Ç†ÇËÇ‹Ç∑ÅB" & vbCrLf & vbCrLf _
                                        & "çsNo:" & vbTab & wkRow & vbCrLf _
                                        & "îÑè„ì˙: " & vbTab & strUDNDT & vbCrLf _
                                        & "éÛíçî‘çÜ: " & vbTab & strHyjdnno)
                            chkAkaKro = False
                            Exit Function
                        End If

                    Else
                    'çïÉfÅ[É^Ç©ÇÁÇÃåüçı
                    
                        'éÛíçî‘çÜéÊìæ
                        Call .GetText(COL_HYJDNNO, idxRow, tmp)
                        strHyjdnno = CStr(tmp)
                        
                        'ìØàÍéÛíçî‘çÜÇåüçı
                        For idxRowJDNNO = intMaxRow To 1 Step -1
                            .GetText COL_HYJDNNO, idxRowJDNNO, tmp
                            str_theHYJDNNO = CStr(tmp)
                            
                            'éÛíçî‘çÜàÍívÇ∑ÇÍÇŒëäéE
                            If strHyjdnno <> str_theHYJDNNO Then
                            Else
                                
                                'É`ÉFÉbÉN
                                .GetText COL_CHK, idxRowJDNNO, tmp
                                intchk = SSSVal(tmp)
                        
                                'îÑè„ã‡äz
                                .GetText COL_URIKN, idxRowJDNNO, tmp
                                intUrikn = SSSVal(tmp)
                        
                        
                    
                                ''ï™î[Ç≥ÇÍÇƒÇ¢ÇÈçïÉfÅ[É^ÇåüèoÇµÇ»Ç¢ÇÊÇ§èCê≥
                                'é©ï™é©êgÇ≈Ç»Ç¢ÅAÇ©Ç¬É`ÉFÉbÉNÇ≥ÇÍÇƒÇ¢Ç»Ç¢ÅAÇ©Ç¬çïÉfÅ[É^Ç≈Ç»Ç¢
                                If idxRowJDNNO <> idxRow And intchk = 0 And intUrikn < 0 Then
                        
                        
                                    .GetText COL_UDNDT, idxRowJDNNO, tmp
                                    strUDNDT = CStr(tmp)
                                
                                    If MsgBox("è[ìñÇ™ïKóvÇ»îÑè„Ç™Ç†ÇËÇ‹Ç∑ÅB" & vbCrLf _
                                                & "çXêVÇµÇ‹Ç∑Ç©ÅH" & vbCrLf & vbCrLf _
                                                & "çsNo:" & vbTab & idxRowJDNNO & vbCrLf _
                                                & "îÑè„ì˙: " & vbTab & strUDNDT & vbCrLf _
                                                & "éÛíçî‘çÜ: " & vbTab & strHyjdnno, vbOKCancel) = vbOK Then
                                    
                                        chkAkaKro = True
    
                                    Else
                                        chkAkaKro = False
                                        Exit Function
                                    End If
                                                                    
                                End If
                            End If
                        Next idxRowJDNNO
                        
                    End If
                End If
            End If
       Next idxRow
    End With

End Function

'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
''   ñºèÃÅF Function chkNyukn
''   äTóvÅF ì¸ã‡Ç≥ÇÍÇƒÇ¢ÇÈÇ©ÇÃÉ`ÉFÉbÉN
''   îıçlÅF
'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkNyukn()


    Dim tmp             As Variant
    Dim idxRow          As Long
    Dim intchk          As Integer
    Dim i               As Integer
    Dim BlnFlg          As Boolean
    
'*** 2009/10/09 ADD START FKS)NAKATA
    Dim BlnFlgDay          As Boolean
'*** 2009/10/09 ADD E.N.D FKS)NAKATA

    Dim strJdnno        As String    'éÛíçî‘çÜ
    Dim strJdnlinno     As String    'éÛíççsî‘çÜ
    Dim strHyjdnno      As String
    Dim strOkrjono      As String    'ëóÇËèÛáÇ
    Dim curKesikn       As Currency
    Dim curKesiknMae    As Currency

    
    On Error GoTo ERR_chkNYUKN

    chkNyukn = True



    With spd_body
        For idxRow = 1 To intMaxRow

            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
            .GetText COL_CHK, idxRow, tmp
            intchk = SSSVal(tmp)


            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
            If intchk = 1 Then

                BlnFlg = False
'*** 2009/10/09 ADD START FKS)NAKATA
                BlnFlgDay = False
'*** 2009/10/09 ADD E.N.D FKS)NAKATA


                'éÛíçî‘çÜÇéÊìæ
                Call .GetText(COL_JDNNO, idxRow, tmp)
                strJdnno = CStr(tmp)

                'éÛíççsî‘çÜÇéÊìæ
                Call .GetText(COL_JDNLINNO, idxRow, tmp)
                strJdnlinno = CStr(tmp)

                'ï\é¶ópéÛíçî‘çÜÇéÊìæ
                Call .GetText(COL_HYJDNNO, idxRow, tmp)
                strHyjdnno = CStr(tmp)

                'ëóÇËèÛáÇÇÃéÊìæ
                strOkrjono = getOKRJONO(strJdnno, strJdnlinno)

                'ì¸ã‡äz
                Call .GetText(COL_KESIKN, idxRow, tmp)
                curKesikn = SSSVal(tmp)

                'ì¸ã‡äz
                Call .GetText(COL_KESIKN_MAE, idxRow, tmp)
                curKesiknMae = SSSVal(tmp)
                

                If Abs(curKesikn) > Abs(curKesiknMae) Then

                        For i = 0 To UBound(ARY_NYUKN_KS)
                            
                            'ì¸ã‡Ç≥ÇÍÇƒÇ¢ÇÈÇ©ÇÃämîF
                            If strOkrjono = ARY_NYUKN_KS(i).OKRJONO Then
                                
                                BlnFlg = True
                                
                                'ì¸ã‡ì˙Ç∆è[ìñì˙ÇÃÉ`ÉFÉbÉN
                                If ARY_NYUKN_KS(i).UDNDT <= gstrKesidt Then
                                    BlnFlgDay = True
                                Else
                                    Exit For
                                End If
                                    
                                Exit For
                            
                            End If
                        Next i
        
                        
                        'ì¸ã‡Ç™çsÇÌÇÍÇƒÇ¢Ç»Ç¢èÍçáÅAÉGÉâÅ[Ç∆Ç∑ÇÈÅB
                        If BlnFlg = False Then
                            If MsgBox("ì¸ã‡Ç™ìoò^Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB" & vbCrLf & vbCrLf _
                                        & "çsNo:" & vbTab & idxRow & vbCrLf _
                                        & "éÛíçî‘çÜ: " & vbTab & strHyjdnno, vbOKOnly, "ëOéÛè[ìññﬂÇµèàóù") = vbOK Then
                                chkNyukn = False
                                GoTo END_chkNyukn
                            End If
                        End If
                 
'*** 2009/10/09 ADD START FKS)NAKATA
                        'è[ìñì˙ÇÊÇËì¸ã‡ì˙Ç™à»ëOÇÃèÍçáÅAÉGÉâÅ[Ç∆Ç∑ÇÈÅB
                        If BlnFlgDay = False Then
                            If MsgBox("ì¸ã‡ì˙à»ëOÇ≈ÇÕè[ìñÇ≈Ç´Ç‹ÇπÇÒÅB" & vbCrLf & vbCrLf _
                                        & "çsNo:" & vbTab & idxRow & vbCrLf _
                                        & "éÛíçî‘çÜ: " & vbTab & strHyjdnno, vbOKOnly, "ëOéÛè[ìññﬂÇµèàóù") = vbOK Then
                                chkNyukn = False
                                GoTo END_chkNyukn
                            End If
                        End If
'*** 2009/10/09 ADD E.N.D FKS)NAKATA
                 
                 
                 
                End If
                     
            End If
       
       Next idxRow
    End With


END_chkNyukn:
    
    Exit Function

ERR_chkNYUKN:
    GoTo END_chkNyukn

End Function

'**** 2009/09/16 DEL START FKS)NAKATA
'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
''   ñºèÃÅF Function chkURIKN
''   äTóvÅF îÑè„ã‡äzÇ∆è[ìñã‡äzÇÃÉ`ÉFÉbÉN
''   îıçlÅF
'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'Private Function chkUrikn()
'
'    Dim tmp             As Variant
'    Dim idxRow          As Long
'    Dim intchk          As Integer
'
'    Dim strJdnno        As String    'éÛíçî‘çÜ
'    Dim strJdnlinno     As String    'éÛíççsî‘çÜ
'    Dim strHyjdnno      As String    'ï\é¶ópéÛíçî‘çÜ
'    Dim strOkrjono      As String    'ëóÇËèÛáÇ
'    Dim strJdntrkb      As String    'éÛíçéÊà¯ãÊï™
'
'    Dim curBfKesikn     As Currency  'è¡çûäz(í˜ì˙ëO)
'    Dim curAfKesikn     As Currency  'è¡çûäz(í˜ì˙å„)
'
'    Dim curNYUKN        As Currency  'ì¸ã‡ÉåÉRÅ[Éhì¸ã‡äz
'    Dim curUrikn        As Currency  'îÑè„ÉåÉRÅ[ÉhîÑè„ã‡äz + ê≈ã‡
'
'    Dim Usr_Ody         As U_Ody
'    Dim strSql          As String
'
'    On Error GoTo ERR_chkUrikn
'
'
'
'    chkUrikn = True
'
'    'ï‘ïiÇåüçı
'    With spd_body
'        For idxRow = 1 To intMaxRow
'
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
'            .GetText COL_CHK, idxRow, tmp
'            intchk = SSSVal(tmp)
'
'
'            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
'            If intchk = 1 Then
'
'
'                'éÛíçî‘çÜÇéÊìæ
'                Call .GetText(COL_JDNNO, idxRow, tmp)
'                strJdnno = CStr(tmp)
'
'
'                'éÛíççsî‘çÜÇéÊìæ
'                Call .GetText(COL_JDNLINNO, idxRow, tmp)
'                strJdnlinno = CStr(tmp)
'
'
'                'ï\é¶ópéÛíçî‘çÜÇéÊìæ
'                Call .GetText(COL_HYJDNNO, idxRow, tmp)
'                strHyjdnno = CStr(tmp)
'
'
'                'ì¸ã‡çœäz(í˜ì˙ëO)
'                Call .GetText(COL_BFKESIKN, idxRow, tmp)
'                curBfKesikn = SSSVal(tmp)
'
'
'                'ì¸ã‡çœäz(í˜ì˙å„)
'                Call .GetText(COL_AFKESIKN, idxRow, tmp)
'                curAfKesikn = SSSVal(tmp)
'
'
'                    'à»ëOÇ…è¡çûÇ≥ÇÍÇƒÇ¢ÇÈÇ‡ÇÃà»äOÇëŒè€Ç∆Ç∑ÇÈ
'                    If curBfKesikn + curAfKesikn = 0 Then
'
'
'                            ''éÛíçî‘çÜÇÊÇËéÛíçéÊà¯ãÊï™ÇéÊìæÇ∑ÇÈÅB
'                            strSql = " "
'                            strSql = strSql & " SELECT  JDNTRKB"
'                            strSql = strSql & "  FROM   JDNTHA"
'                            strSql = strSql & " WHERE   DATNO IN"
'                            strSql = strSql & " ("
'                            strSql = strSql & "  SELECT  MAX(DATNO)"
'                            strSql = strSql & "   FROM   JDNTHA"
'                            strSql = strSql & "  WHERE   DATKB = '1'"
'                            strSql = strSql & "    AND   JDNNO = '" & strJdnno & "'"
'                            strSql = strSql & " )"
'                            strSql = strSql & "    AND DATKB = '1'"
'
'
'                            'DBÉAÉNÉZÉX
'                            Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
'
'                            If CF_Ora_EOF(Usr_Ody) = False Then
'                                strJdntrkb = SSSVal(CF_Ora_GetDyn(Usr_Ody, "JDNTRKB", "")) 'éÛíçéÊà¯ãÊï™
'                            End If
'
'                            Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
'
'
'
'                            ''éÛíçî‘çÜÅEçsî‘çÜÇÊÇËîÑè„ã‡äzÇéÊìæÇ∑ÇÈ
'                            strSql = ""
'                            strSql = strSql & "SELECT SUM(URIKN) + SUM(UZEKN)   URIKN"
'                            strSql = strSql & "  FROM UDNTRA"
'                            strSql = strSql & " WHERE JDNNO     = '" & strJdnno & "'"
'
'                            'ÉZÉbÉgÉAÉbÉvÅEÉVÉXÉeÉÄà»äOÇÃéÛíçÇÕñæç◊çsëSëÃÇ≈ã‡äzÇÉTÉ}ÉäÇ∑ÇÈÅB
'                            If strJdntrkb = "11" Or strJdntrkb = "21" Then
'                            Else
'                                strSql = strSql & "   AND JDNLINNO  = '" & strJdnlinno & "'"
'                            End If
'
'                            strSql = strSql & "   AND IRISU     <> 9"
'                            strSql = strSql & "   AND DATKB     = '1'"
'
'
'                            'DBÉAÉNÉZÉX
'                            Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
'
'                            If CF_Ora_EOF(Usr_Ody) = False Then
'                                curUrikn = SSSVal(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")) 'îÑè„ã‡äz
'                            End If
'
'                            Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
'
'
'
'                            'éÛíçî‘çÜ + çsî‘çÜÇÅuëóÇËèÛáÇÅvÇ÷ïœçX
'                            'ÉZÉbÉgÉAÉbÉvÅEÉVÉXÉeÉÄÇÕÅAçsî‘çÜÇÅu001Åvå≈íË
'                            If strJdntrkb = "11" Or strJdntrkb = "21" Then
'                                strOkrjono = Trim$(strJdnno) & "001"
'                            Else
'                                strOkrjono = Trim$(strJdnno) & Trim$(strJdnlinno)
'                            End If
'
'
'
'                            ''ì¸ã‡ÉåÉRÅ[ÉhÇÊÇËì¸ã‡äzÇéÊìæÇ∑ÇÈÅB
'                            strSql = " "
'                            strSql = strSql & " SELECT  SUM(TRA.NYUKN) AS NYUKN"
'                            strSql = strSql & "  FROM    UDNTRA TRA ,"
'                            strSql = strSql & "          UDNTHA THA"
'                            strSql = strSql & " WHERE    TRA.DATNO = THA.DATNO"
'                            strSql = strSql & "  AND     TRA.DATKB = '1'"
'                            strSql = strSql & "  AND     TRA.DENKB = '8'"
'                            strSql = strSql & "  AND     THA.NYUCD = '2'"
'                            strSql = strSql & "  AND     THA.FRNKB = '0'"
'                            strSql = strSql & "  AND     TRA.OKRJONO = '" & strOkrjono & "'"
'
'
'
'                            'DBÉAÉNÉZÉX
'                            Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
'
'                            If CF_Ora_EOF(Usr_Ody) = False Then
'                                curNYUKN = SSSVal(CF_Ora_GetDyn(Usr_Ody, "NYUKN", "")) 'îÑè„ã‡äz
'                            End If
'
'                            Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
'
'
'                            'îÑè„ã‡äzÇ∆ì¸ã‡äzÇ™àÍívÇµÇƒÇ¢Ç»Ç¢èÍçáÅAÉGÉâÅ[
'                            If curUrikn <> curNYUKN Then
'                                If MsgBox("îÑè„ã‡äzÇ∆ì¸ã‡äzÇ™àŸÇ»ÇËÇ‹Ç∑ÅB" & vbCrLf & vbCrLf _
'                                            & "çsNo:" & vbTab & idxRow & vbCrLf _
'                                            & "éÛíçî‘çÜ: " & vbTab & strHyjdnno, vbOKOnly, "ëOéÛè[ìññﬂÇµèàóù") = vbOK Then
'                                    chkUrikn = False
'                                    GoTo END_chkUrikn
'                                End If
'                            End If
'
'                    End If
'            End If
'       Next idxRow
'    End With
'
'
'END_chkUrikn:
'    'ÉNÉçÅ[ÉY
'    Call CF_Ora_CloseDyn(Usr_Ody)
'    Exit Function
'
'ERR_chkUrikn:
'    GoTo END_chkUrikn
'
'
'End Function
'**** 2009/09/16 DEL E.N.D FKS)NAKATA

'**** 2009/09/16 DEL START FKS)NAKATA
'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
''   ñºèÃÅF Function chkJdntrkb
''   äTóvÅF ì`ï[íPà Ç≈ÇÃè[ìñÉ`ÉFÉbÉN
''   îıçlÅF
'' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'Private Function chkJdntrkb()
'
'    Dim tmp             As Variant
'    Dim idxRow          As Long
'    Dim intchk          As Integer
'
'    Dim i               As Integer
'    Dim Cnt             As Long
'
'    'ÉXÉvÉåÉbÉhäiî[ïœêî
'    Dim strJdnno        As String    'éÛíçî‘çÜ
'    Dim strJdnlinno     As String    'éÛíççsî‘çÜ
'    Dim strHyjdnno      As String    'ï\é¶ópéÛíçî‘çÜ
'    Dim curKomikn       As Currency  'îÑè„ã‡äzÅ{ê≈ã‡
'
'    'éÛíçéÊà¯ãÊï™
'    Dim strOkrjono      As String    'ëóÇËèÛáÇ
'    Dim strJdntrkb      As String    'éÛíçéÊà¯ãÊï™
'
'
'    'É`ÉFÉbÉNópïœêî
'    Dim wkIdx           As Integer
'    Dim wkJdnno         As String
'    Dim wkHyjdnno       As String
'    Dim wkKomikn        As Currency
'    Dim curUrikn        As Currency  'îÑè„ÉåÉRÅ[ÉhîÑè„ã‡äz + ê≈ã‡
'
'
'    Dim Usr_Ody         As U_Ody
'    Dim strSql          As String
'
'    On Error GoTo ERR_chkJdntrkb
'
'
'    chkJdntrkb = True
'
'
'    'îzóÒÇÃèâä˙âª
'    ReDim Preserve JDNTRKB_CHK(0)
'    Cnt = 0
'
'
'        With spd_body
'            For idxRow = 1 To intMaxRow
'
'                'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
'                .GetText COL_CHK, idxRow, tmp
'                intchk = SSSVal(tmp)
'
'
'                'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
'                If intchk = 1 Then
'
'
'                    'éÛíçî‘çÜÇéÊìæ
'                    Call .GetText(COL_JDNNO, idxRow, tmp)
'                    strJdnno = CStr(tmp)
'
'
'                    'éÛíççsî‘çÜÇéÊìæ
'                    Call .GetText(COL_JDNLINNO, idxRow, tmp)
'                    strJdnlinno = CStr(tmp)
'
'
'                    'ï\é¶ópéÛíçî‘çÜÇéÊìæ
'                    Call .GetText(COL_HYJDNNO, idxRow, tmp)
'                    strHyjdnno = CStr(tmp)
'
'
'                    'ê≈çûîÑè„ã‡äzÇéÊìæ
'                    Call .GetText(COL_KOMIKN, idxRow, tmp)
'                    curKomikn = CCur(tmp)
'
'
'                    'éÛíçî‘çÜÇÊÇËéÛíçéÊà¯ãÊï™ÇéÊìæÇ∑ÇÈÅB
'                    strSql = " "
'                    strSql = strSql & " SELECT  JDNTRKB"
'                    strSql = strSql & "  FROM   JDNTHA"
'                    strSql = strSql & " WHERE   DATNO IN"
'                    strSql = strSql & " ("
'                    strSql = strSql & "  SELECT  MAX(DATNO)"
'                    strSql = strSql & "   FROM   JDNTHA"
'                    strSql = strSql & "  WHERE   DATKB = '1'"
'                    strSql = strSql & "    AND   JDNNO = '" & strJdnno & "'"
'                    strSql = strSql & " )"
'                    strSql = strSql & "    AND DATKB = '1'"
'
'
'                    'DBÉAÉNÉZÉX
'                    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
'
'                    If CF_Ora_EOF(Usr_Ody) = False Then
'                        strJdntrkb = SSSVal(CF_Ora_GetDyn(Usr_Ody, "JDNTRKB", "")) 'éÛíçéÊà¯ãÊï™
'                    End If
'
'                    Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
'
'
'                    'éÛíçéÊà¯ãÊï™Ç™ÉZÉbÉgÉAÉbÉvÇ∆ÉVÉXÉeÉÄÇÃéûÇÃÇ›îzóÒÇ…äiî[Ç∑ÇÈ
'                    If strJdntrkb = "11" Or strJdntrkb = "21" Then
'
'                        ReDim Preserve JDNTRKB_CHK(Cnt)
'                        With JDNTRKB_CHK(Cnt)
'                            .idx = idxRow
'                            .JDNNO = strJdnno
'                            .HYJDNNO = strHyjdnno
'                            .KOMIKN = curKomikn
'                        End With
'
'                        Cnt = Cnt + 1
'
'                    End If
'
'                End If
'            Next idxRow
'        End With
'
'
'        'îzóÒ1î‘ñ⁄ÇÃéÛíçî‘çÜÇäJénì_Ç∆ÇµÇƒÉZÉbÉg
'        wkIdx = JDNTRKB_CHK(0).idx
'        wkJdnno = JDNTRKB_CHK(0).JDNNO
'        wkHyjdnno = JDNTRKB_CHK(0).HYJDNNO
'
'            For i = 0 To UBound(JDNTRKB_CHK)
'
'
'            If wkJdnno = JDNTRKB_CHK(i).JDNNO Then
'
'                'éÛíçî‘çÜÇ™ìØÇ∂èÍçáÇÕÅAê≈çûîÑè„ã‡äzÇâ¡éZÇ∑ÇÈÅB
'                wkIdx = JDNTRKB_CHK(i).idx
'                wkHyjdnno = JDNTRKB_CHK(i).HYJDNNO
'                wkKomikn = wkKomikn + JDNTRKB_CHK(i).KOMIKN
'
'            Else
'
'                ''éÛíçî‘çÜÅEçsî‘çÜÇÊÇËîÑè„ã‡äzÇéÊìæÇ∑ÇÈ
'                strSql = ""
'                strSql = strSql & "SELECT SUM(URIKN) + SUM(UZEKN)   URIKN"
'                strSql = strSql & "  FROM UDNTRA"
'                strSql = strSql & " WHERE JDNNO     = '" & wkJdnno & "'"
'                strSql = strSql & "   AND IRISU     <> 9"
'                strSql = strSql & "   AND DATKB     = '1'"
'
'
'                'DBÉAÉNÉZÉX
'                Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
'
'                If CF_Ora_EOF(Usr_Ody) = False Then
'                    curUrikn = SSSVal(CF_Ora_GetDyn(Usr_Ody, "URIKN", "")) 'îÑè„ã‡äz
'                End If
'
'                Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
'
'
'                'éÊìæÇµÇΩîÑè„ã‡äzÇ∆âÊñ Ç≈É`ÉFÉbÉNÇ≥ÇÍÇƒÇ¢ÇÈîÑè„ã‡äzÇî‰ärÇ∑ÇÈÅB
'                If wkKomikn <> curUrikn Then
'
'                    If MsgBox("ì`ï[íPà Ç≈è[ìñ/è[ìñâèúÇçsÇ¡ÇƒÇ≠ÇæÇ≥Ç¢ÅB" & vbCrLf & vbCrLf _
'                                & "çsNo:" & vbTab & wkIdx & vbCrLf _
'                                & "éÛíçî‘çÜ: " & vbTab & wkHyjdnno, vbOKOnly, "ëOéÛè[ìññﬂÇµèàóù") = vbOK Then
'                        chkJdntrkb = False
'                        GoTo END_chkJdntrkb
'                    End If
'
'                End If
'
'                'éÛíçî‘çÜÇÉZÉbÉg
'                wkIdx = JDNTRKB_CHK(i).idx
'                wkJdnno = JDNTRKB_CHK(i).JDNNO
'                wkKomikn = JDNTRKB_CHK(i).KOMIKN
'
'            End If
'        Next i
'
'
'
'END_chkJdntrkb:
'    'ÉNÉçÅ[ÉY
'    Call CF_Ora_CloseDyn(Usr_Ody)
'    Exit Function
'
'ERR_chkJdntrkb:
'    GoTo END_chkJdntrkb
'
'
'End Function
'**** 2009/09/16 DEL E.N.D FKS)NAKATA


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub ChkInputChange
    '   äTóvÅF  ñæç◊ÇÃì¸óÕì‡óeÇÃïœçXämîF
    '   à¯êîÅF  ñ≥Çµ
    '   ñﬂílÅFÅ@True:ïœçXóLÇË  False:ïœçXñ≥Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function ChkInputChange() As Boolean

    Dim i           As Integer
    Dim vnt_AFCHK   As Variant
    Dim vnt_BFCHK   As Variant
    
    ChkInputChange = False

    With spd_body
        For i = 1 To .MaxRows
            Call .GetText(COL_CHK, i, vnt_AFCHK)
            Call .GetText(COL_BFCHECK, i, vnt_BFCHK)
            If SSSVal(vnt_AFCHK) <> SSSVal(vnt_BFCHK) Then
                ChkInputChange = True
                Exit For
            End If
        Next i
    End With

End Function


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Get_NKSTRA_HAITA_INF
    '   äTóvÅF  ì¸ã‡è¡çûÉgÉâÉìÇÃîrëºèÓïÒéÊìæ
    '   à¯êîÅF  ñ≥Çµ
    '   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Get_NKSTRA_HAITA_INF() As Boolean
    
    Dim strSql      As Variant
    Dim Usr_Ody     As U_Ody
    Dim Usr_Ody_1   As U_Ody
    Dim i           As Long
    Dim Lng_Cnt     As Long
    
    Get_NKSTRA_HAITA_INF = False
    
    ReDim ARY_NKSTRA_HAITA(0)
    
    For i = 1 To UBound(ARY_UDNTRA_HAITA)
        strSql = ""
        strSql = strSql & "SELECT " & vbCrLf
        strSql = strSql & "       KDNNO  " & vbCrLf
        strSql = strSql & "      ,OPEID  " & vbCrLf
        strSql = strSql & "      ,CLTID  " & vbCrLf
        strSql = strSql & "      ,WRTDT  " & vbCrLf
        strSql = strSql & "      ,WRTTM  " & vbCrLf
        strSql = strSql & "      ,UOPEID " & vbCrLf
        strSql = strSql & "      ,UCLTID " & vbCrLf
        strSql = strSql & "      ,UWRTDT " & vbCrLf
        strSql = strSql & "      ,UWRTTM " & vbCrLf
        strSql = strSql & "FROM " & vbCrLf
        strSql = strSql & "       NKSTRA " & vbCrLf
        strSql = strSql & "WHERE " & vbCrLf
        strSql = strSql & "       UDNDATNO = '" & ARY_UDNTRA_HAITA(i).DATNO & "' " & vbCrLf
        strSql = strSql & "AND    UDNLINNO = '" & ARY_UDNTRA_HAITA(i).LINNO & "' " & vbCrLf
        strSql = strSql & "AND    DATKB    = '1' " & vbCrLf
    
        'DBÉAÉNÉZÉX
        Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

        Do While CF_Ora_EOF(Usr_Ody) = False
            
            'éÊè¡ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇ©ämîFÇµÅAÇ¢Ç»Ç¢èÍçáÇÕéÊÇËè¡ÇµÇ≥ÇÍÇƒÇ¢Ç»Ç¢ÇÃÇ≈ÅAéÊÇËè¡ÇµÉåÉRÅ[ÉhèàóùÇé¿é{Ç∑ÇÈ
            strSql = ""
            strSql = strSql & "SELECT " & vbCrLf
            strSql = strSql & "       KDNNO " & vbCrLf
            strSql = strSql & "FROM " & vbCrLf
            strSql = strSql & "       NKSTRA " & vbCrLf
            strSql = strSql & "WHERE " & vbCrLf
            strSql = strSql & "       MOTKDNNO = '" & CF_Ora_GetDyn(Usr_Ody, "KDNNO", "") & "' " & vbCrLf

            'DBÉAÉNÉZÉX
            Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody_1, strSql)
                
            If CF_Ora_EOF(Usr_Ody_1) Then
                Lng_Cnt = Lng_Cnt + 1
                ReDim Preserve ARY_NKSTRA_HAITA(Lng_Cnt)
                ARY_NKSTRA_HAITA(Lng_Cnt).KDNNO = CStr(CF_Ora_GetDyn(Usr_Ody, "KDNNO", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).OPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "OPEID", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).CLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "CLTID", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).WRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTDT", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).WRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTTM", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).UOPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "UOPEID", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).UCLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "UCLTID", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).UWRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "UWRTDT", ""))
                ARY_NKSTRA_HAITA(Lng_Cnt).UWRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "UWRTTM", ""))
            End If
            
            Call CF_Ora_CloseDyn(Usr_Ody_1)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
            Usr_Ody.Obj_Ody.MoveNext
        Loop
        Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
    Next i
        
    Get_NKSTRA_HAITA_INF = True

End Function

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Get_NKSTRA_TEGDT
    '   äTóvÅF  ì¸ã‡è¡çûÉgÉâÉìÇÃä˙ì˙êUçûì˙ÇÃéÊìæ
    '   à¯êîÅF  ñ≥Çµ
    '   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Get_NKSTRA_TEGDT(vnt_UDNDATNO As Variant, vnt_UDNLINNO As Variant) As String
    
    Dim strSql      As String
    Dim Usr_Ody     As U_Ody
    Dim Usr_Ody_1   As U_Ody
    Dim strTEGDT    As String
    Dim blnExist    As Boolean
        
    strTEGDT = ""
    
    blnExist = False
    

    strSql = ""
    strSql = strSql & "SELECT " & vbCrLf
    strSql = strSql & "       MAX(TEGDT) TEGDT " & vbCrLf
    strSql = strSql & "FROM " & vbCrLf
    strSql = strSql & "       NKSTRA " & vbCrLf
    strSql = strSql & "WHERE " & vbCrLf
    strSql = strSql & "       UDNDATNO = '" & vnt_UDNDATNO & "' " & vbCrLf
    strSql = strSql & "AND    UDNLINNO = '" & vnt_UDNLINNO & "' " & vbCrLf
    strSql = strSql & "AND    DATKB    = '1' " & vbCrLf
    strSql = strSql & "AND    AKAKROKB = '1' " & vbCrLf
    strSql = strSql & "AND    KDNNO NOT IN ( " & vbCrLf
    strSql = strSql & "       SELECT " & vbCrLf
    strSql = strSql & "              MOTKDNNO " & vbCrLf
    strSql = strSql & "       FROM " & vbCrLf
    strSql = strSql & "              NKSTRA " & vbCrLf
    strSql = strSql & "       WHERE " & vbCrLf
    strSql = strSql & "              UDNDATNO = '" & vnt_UDNDATNO & "' " & vbCrLf
    strSql = strSql & "       AND    UDNLINNO = '" & vnt_UDNLINNO & "' " & vbCrLf
    strSql = strSql & "       AND    TRIM(MOTKDNNO) IS NOT NULL " & vbCrLf
    strSql = strSql & "       ) " & vbCrLf
    
    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
        
    If Not CF_Ora_EOF(Usr_Ody) Then
        strTEGDT = CF_Ora_GetDyn(Usr_Ody, "TEGDT", "")
    End If
        
    Get_NKSTRA_TEGDT = strTEGDT

End Function
'*** 2009/09/03 ADD START FKS)NAKATA V1.03
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function Get_NYUKN_TEGDT
    '   äTóvÅF  îÑè„ÉgÉâÉì.ì¸ã‡ÉåÉRÅ[ÉhÇÃä˙ì˙êUçûì˙ÇÃéÊìæ
    '   à¯êîÅF  ñ≥Çµ
    '   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Get_NYUKN_TEGDT(vnt_JDNNO As String, vnt_JDNLINNO As String) As String
    
    Dim strSql      As String
    Dim Usr_Ody     As U_Ody
    Dim Usr_Ody_1   As U_Ody
    Dim strTEGDT    As String
    Dim strOkrjono  As String
    Dim blnExist    As Boolean
        
    strTEGDT = ""
    
    blnExist = False
    
    strOkrjono = getOKRJONO(vnt_JDNNO, vnt_JDNLINNO)


        strSql = " "
        strSql = strSql & " SELECT  " & vbCrLf
        strSql = strSql & "   MAX(TEGDT) AS TEGDT" & vbCrLf
        strSql = strSql & "  FROM  UDNTRA TRA" & vbCrLf
        strSql = strSql & " WHERE  TRA.DENKB     =   '8'" & vbCrLf
        strSql = strSql & "   AND  TRA.DATKB     =   '1'" & vbCrLf
        strSql = strSql & "   AND  TRA.AKAKROKB  =   '1'" & vbCrLf
        strSql = strSql & "   AND  TRA.KESIKB    =   '9'" & vbCrLf
        strSql = strSql & "   AND  TRA.OKRJONO   =   '" & strOkrjono & "'" & vbCrLf
        strSql = strSql & "   AND  TRA.DATNO IN" & vbCrLf
        strSql = strSql & "            ( SELECT MAX(DATNO)" & vbCrLf
        strSql = strSql & "                FROM  UDNTRA" & vbCrLf
        strSql = strSql & "               WHERE  DENKB    =  '8'" & vbCrLf
        strSql = strSql & "                 AND  DATKB    =  '1'" & vbCrLf
        strSql = strSql & "                 AND  DKBID   !=  '09'" & vbCrLf
        strSql = strSql & "                 AND  OKRJONO  =  '" & strOkrjono & "'" & vbCrLf
        strSql = strSql & "            )" & vbCrLf


    
    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
        
    If Not CF_Ora_EOF(Usr_Ody) Then
        strTEGDT = CF_Ora_GetDyn(Usr_Ody, "TEGDT", "")
    End If
        
    Get_NYUKN_TEGDT = strTEGDT

End Function
'*** 2009/09/03 ADD E.N.D FKS)NAKATA V1.03

' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkCondition
'   äTóvÅF  ÉwÉbÉ_ïîÇÃì¸óÕÉ`ÉFÉbÉN
'   à¯êîÅF  ñ≥Çµ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkCondition() As Boolean
    chkCondition = False
    
    'É`ÉFÉbÉNÅFè¡çûì˙
    With txt_kesidt
        If Trim(.Text) = "" Then
            'ïKê{ì¸óÕÉ`ÉFÉbÉN
            Call showMsg("0", "_HEADCOMPLETEC", "0")    'Åúå©èoñ¢ì¸óÕ¥◊∞MSG
            .ForeColor = vbRed
            .SetFocus
            Exit Function
        Else
            intChkKb = 1
            'É`ÉFÉbÉNèàóù
            If chkKesidt(True) = False Then 'É`ÉFÉbÉNèàóùÇã≠êßìIÇ…ëñÇÁÇπÇÈ
                'ÉGÉâÅ[
                Call .SetFocus
                Exit Function
            End If
        End If
    End With
    
    'É`ÉFÉbÉNÅFêøãÅêÊÉRÅ[Éh
    With txt_tokseicd
        If Trim(.Text) = "" Then
            'ïKê{ì¸óÕÉ`ÉFÉbÉN
            Call showMsg("0", "_HEADCOMPLETEC", "0")    'Åúå©èoñ¢ì¸óÕ¥◊∞MSG
            .ForeColor = vbRed
            .SetFocus
            Exit Function
        Else
            intChkKb = 1
            'É`ÉFÉbÉNèàóù
            If chkTokseicd(True) = False Then 'É`ÉFÉbÉNèàóùÇã≠êßìIÇ…ëñÇÁÇπÇÈ
                'ÉGÉâÅ[
                Call .SetFocus
                Exit Function
            End If
        End If
    End With
    
    'É`ÉFÉbÉNÅFîÑè„ì˙(äJén)
    With txt_kaidt_From
        If Trim(.Text) = "" Then
            If Trim(txt_kesikb.Text) = "9" Then
                'ïKê{ì¸óÕÉ`ÉFÉbÉN
                Call showMsg("0", "_HEADCOMPLETEC", "0")    'Åúå©èoñ¢ì¸óÕ¥◊∞MSG
                .ForeColor = vbRed
                .SetFocus
                Exit Function
            End If
        Else
            intChkKb = 1
            If chkKaidt_From(True) = False Then 'É`ÉFÉbÉNèàóùÇã≠êßìIÇ…ëñÇÁÇπÇÈ
                'ÉGÉâÅ[
                .SetFocus
                Exit Function
            End If
        End If
    End With
    
    'É`ÉFÉbÉNÅFîÑè„ì˙(èIóπ)
    With txt_kaidt_To
        If Trim(.Text) = "" Then
            'ïKê{ì¸óÕÉ`ÉFÉbÉN
            Call showMsg("0", "_HEADCOMPLETEC", "0")    'Åúå©èoñ¢ì¸óÕ¥◊∞MSG
            .ForeColor = vbRed
            .SetFocus
            Exit Function
        Else
            intChkKb = 1
            'É`ÉFÉbÉNèàóù
            If chkKaidt_To(True) = False Then 'É`ÉFÉbÉNèàóùÇã≠êßìIÇ…ëñÇÁÇπÇÈ
                'ÉGÉâÅ[
                .SetFocus
                Exit Function
            End If
        End If
    End With
    
    With txt_fridt
        If Trim(.Text) = "" Then
            If blnFriEnabled = True Then
                'ïKê{ì¸óÕÉ`ÉFÉbÉN
                Call showMsg("0", "_HEADCOMPLETEC", "0")    'Åúå©èoñ¢ì¸óÕ¥◊∞MSG

                .Enabled = True

                .ForeColor = vbRed
                .SetFocus
                Exit Function
            End If
        Else
            intChkKb = 1
            'É`ÉFÉbÉNèàóù
            If chkFridt(True) = False Then 'É`ÉFÉbÉNèàóùÇã≠êßìIÇ…ëñÇÁÇπÇÈ
                'ÉGÉâÅ[
                .SetFocus
                Exit Function
            End If
        End If
    End With
    
    chkCondition = True
End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkKesidt
'   äTóvÅF  è¡çûì˙ïtÇÃÉ`ÉFÉbÉN
'   à¯êîÅF  pin_blnChk : True=ã≠êßìIÇ…É`ÉFÉbÉNÇÇ∑Ç◊ÇƒëñÇÁÇπÇÈ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkKesidt(Optional ByVal pin_blnChk As Boolean = False) As Boolean
    Dim date1 As String
    Dim date2 As String
    Dim date3 As String

    chkKesidt = False

    With txt_kesidt
        If pin_blnChk = False Then
            'É`ÉFÉbÉNãÊï™Ç™1ÇÃÇ∆Ç´ÅAÇ†ÇÈÇ¢ÇÕïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉ`ÉFÉbÉNÇçsÇ§
            If intChkKb <> 1 Then
                chkKesidt = True
                GoTo END_STEP
            End If
            If .Text = CNV_DATE(gstrKesidt) Then
                chkKesidt = True
                GoTo END_STEP
            End If
        End If

        'ãÛîíì¸óÕéûÇÕÉ`ÉFÉbÉNÇµÇ»Ç¢ÅichkConditionÇ≈É`ÉFÉbÉNÅj
        If Trim(.Text) = "" Then
            chkKesidt = True
            Exit Function
        End If

        'ì˙ïtå`éÆÇÃÉ`ÉFÉbÉN
        If IsDate(.Text) = False Then
            Call showMsg("2", "DATE", 0)            'Åúì˙ïtåÎÇËÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If


'2009/09/03 ADD START RISE)MIYAJIMA
        'ì¸ã‡ì˙ÇÃÉ`ÉFÉbÉNéûÅAëOâÒåééüçXêVé¿çsì˙ÇæÇØÇ≈Ç»Ç≠ÅAëOâÒêøãÅí˜ì˙Ç∆ÇÃÉ`ÉFÉbÉNÇ‡ïKóv
        If Trim(txt_tokseicd) <> "" Then
            If DeCNV_DATE(.Text) <= DB_TOKMTA.TOKSMEDT Then
                Call showMsg("2", "URKET73_042", 0)     'ÅúêøãÅí˜ì˙à»ëOÇ≈Ç∑ÅBÇ±ÇÃì˙ïtÇ≈ÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒÅBMSG
                .ForeColor = vbRed
                GoTo END_STEP
            End If
        End If
'2009/09/03 ADD E.N.D RISE)MIYAJIMA


        'åoóùí˜ì˙à»ëOÇÃì˙ïtÇÃéûÇÕÉGÉâÅ[
        If DeCNV_DATE(.Text) <= DB_SYSTBA.SMAUPDDT Then
        'If DeCNV_DATE(.Text) <= DB_SYSTBA.MONUPDDT Then 'åééüñ{í˜ì˙ÇÃèåèìPîp
            Call showMsg("1", "URKET73_010", 0)     'Åúåoóùí˜ÇﬂçœÇ›ÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'â^ópì˙ÇÊÇËå„ì˙ïtÇÃéûÇÕÉGÉâÅ[
        If DeCNV_DATE(.Text) > gstrUnydt Then
            Call showMsg("2", "DATE_1", 3)          'Åúâ^ópì˙å„ì˙ïtÉGÉâÅ[
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'í˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕÉGÉâÅ[
        date1 = Format(CNV_DATE(Left(DB_SYSTBA.SMAUPDDT, 6) & "01"), "YYYY/MM/DD")
        date2 = DateAdd("m", 2, date1)
        date3 = DateAdd("d", -1, date2)
        If DeCNV_DATE(.Text) > DeCNV_DATE(date3) Then
            Call showMsg("1", "URKET73_038", 0)     'Åúí˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒ
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        .ForeColor = vbBlack
    End With

    chkKesidt = True

END_STEP:

    gstrKesidt = DeCNV_DATE(txt_kesidt.Text)
    intChkKb = 2            'ÅúäÓñ{ÇÕïœçXéûÇ…É`ÉFÉbÉN
End Function

' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkTokseicd
'   äTóvÅF  êøãÅêÊ∫∞ƒﬁÇÃÉ`ÉFÉbÉN
'   à¯êîÅF  pin_blnChk : True=ã≠êßìIÇ…É`ÉFÉbÉNÇÇ∑Ç◊ÇƒëñÇÁÇπÇÈ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkTokseicd(Optional ByVal pin_blnChk As Boolean = False) As Boolean


'2009/09/07 ADD START FKS)NAKATA
    Dim strTANCLAKB         As String
'2009/09/07 ADD E.N.D FKS)NAKATA


    chkTokseicd = False

    With txt_tokseicd
        If pin_blnChk = False Then
            'É`ÉFÉbÉNãÊï™Ç™1ÇÃÇ∆Ç´ÅAÇ†ÇÈÇ¢ÇÕïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉ`ÉFÉbÉNÇçsÇ§
            If intChkKb <> 1 Then
                chkTokseicd = True
                GoTo END_STEP
            End If
            If .Text = gstrTokseicd Then
                chkTokseicd = True
                GoTo END_STEP
            End If
        End If

        'ïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁçÄñ⁄ÉNÉäÉA
        If .Text <> gstrTokseicd Then
            txt_tokseinma.Text = ""
            txt_fridt.Text = Space(8)
            txt_fridt.Enabled = False
            
            lbl_shakbnm(1).Caption = ""
            lbl_hytokkesdd(1).Caption = ""
            gstrFridt = Space(8)
        End If

        'ãÛîíì¸óÕéûÇÕÉ`ÉFÉbÉNÇµÇ»Ç¢ÅichkConditionÇ≈É`ÉFÉbÉNÅj
        If Trim(.Text) = "" Then
            chkTokseicd = True
            Exit Function
        End If

        blnFriEnabled = False

        'ìæà”êÊœΩ¿Ç©ÇÁêøãÅêÊñºèÃÇéÊìæ
        Select Case getTokseinm(DeCNV_DATE(txt_kesidt.Text), .Text)
            'çëì‡êøãÅêÊÇÃÇ∆Ç´
            Case 0:
                .ForeColor = vbBlack
                txt_tokseinma.Text = DB_TOKMTA.TOKRN
                lbl_shakbnm(1).Caption = DB_TOKMTA.SHAKBNM
                lbl_hytokkesdd(1).Caption = DB_TOKMTA.HYTOKKESDD
                

'2009/09/07 ADD START FKS)NAKATA V1.04
                'ì¸ã‡ì˙ÇÃÉ`ÉFÉbÉNéûÅAëOâÒåééüçXêVé¿çsì˙ÇæÇØÇ≈Ç»Ç≠ÅAëOâÒêøãÅí˜ì˙Ç∆ÇÃÉ`ÉFÉbÉNÇ‡ïKóv
                If DeCNV_DATE(txt_kesidt.Text) <= DB_TOKMTA.TOKSMEDT Then
                    Call showMsg("2", "URKET73_042", 0)     'ÅúêøãÅí˜ì˙à»ëOÇ≈Ç∑ÅBÇ±ÇÃì˙ïtÇ≈ÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒÅBMSG
                    txt_kesidt.ForeColor = vbRed
                    txt_kesidt.SetFocus
                    GoTo END_STEP
                End If
'2009/09/07 ADD E.N.D FKS)NAKATA
'2009/09/07 ADD START FKS)NAKATA V1.04
                Call F_Util_GET_TANMTA_TANCLAKB(DB_TOKMTA.TANCD, strTANCLAKB)
                If strTANCLAKB <> "1" Then
                    Call showMsg("2", "URKET73_043", 0)     'ÅúêøãÅêÊíSìñé“Ç™âcã∆Ç≈Ç†ÇËÇ‹ÇπÇÒÅB
                    .ForeColor = vbRed
                    GoTo END_STEP
                End If
'2009/09/07 ADD E.N.D FKS)NAKATA



'*** 2009/09/03 CHG START FKS)NAKATA V1.03
'êUçûä˙ì˙ÇÕÅAè¡çûÉgÉâÉìñîÇÕîÑè„ÉgÉâÉì.ì¸ã‡ÉåÉRÅ[ÉhÇÊÇËéÊìæÇ∑ÇÈÇΩÇﬂ
''                Call getInputHYFRIDT(DB_TOKMTA.TOKSEICD _
''                                    , Get_Acedt(DeCNV_DATE(txt_kesidt.Text)) _
''                                    , DB_TOKMTA.SHAKB)
''
''                txt_fridt.Enabled = blnFriEnabled
                blnFriEnabled = False
'*** 2009/09/03 CHG E.N.D FKS)NAKATA V1.03
                
                chkTokseicd = True

            'äCäOêøãÅêÊÇÃÇ∆Ç´
            Case 1:
                Call showMsg("1", "URKET73_013", 0)     'Åúçëì‡ÇÃìæà”êÊÇ≈ÇÕÇ†ÇËÇ‹ÇπÇÒÅB
                .ForeColor = vbRed
                GoTo END_STEP

            'êøãÅêÊÇ≈Ç»Ç¢ìæà”êÊÇÃÇ∆Ç´
            Case 8:
                Call showMsg("2", "DONTSELECT", "2")    'ÅúêøãÅêÊÇ≈ÇÕÇ»Ç¢
                .ForeColor = vbRed
                GoTo END_STEP

            'êøãÅêÊÇ™ë∂ç›ÇµÇ»Ç¢éû
            Case 9:
                Call showMsg("2", "RNOTFOUND", "0")    'ÅúäYìñÉfÅ[É^Ç»Çµ
                .ForeColor = vbRed
                GoTo END_STEP
        End Select

        .ForeColor = vbBlack
    End With

    chkTokseicd = True

END_STEP:

    gstrTokseicd = txt_tokseicd.Text
    intChkKb = 2            'ÅúäÓñ{ÇÕïœçXéûÇ…É`ÉFÉbÉN
End Function

' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkKaidt_From
'   äTóvÅF  âÒé˚ó\íËì˙ïtÅiäJénÅjÇÃÉ`ÉFÉbÉN
'   à¯êîÅF  pin_blnChk : True=ã≠êßìIÇ…É`ÉFÉbÉNÇÇ∑Ç◊ÇƒëñÇÁÇπÇÈ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkKaidt_From(Optional ByVal pin_blnChk As Boolean = False) As Boolean
    Dim date1 As String
    Dim date2 As String
    Dim date3 As String

    chkKaidt_From = False

    With txt_kaidt_From
        If pin_blnChk = False Then
            'É`ÉFÉbÉNãÊï™Ç™1ÇÃÇ∆Ç´ÅAÇ†ÇÈÇ¢ÇÕïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉ`ÉFÉbÉNÇçsÇ§
            If intChkKb <> 1 Then
                chkKaidt_From = True
                GoTo END_STEP
            End If
            If .Text = CNV_DATE(gstrKaidt_Fr) Then
                chkKaidt_From = True
                GoTo END_STEP
            End If
        End If

        'ãÛîíì¸óÕéûÇÕÉ`ÉFÉbÉNÇµÇ»Ç¢ÅichkConditionÇ≈É`ÉFÉbÉNÅj
        If Trim(.Text) = "" Then
            gstrKaidt_Fr = ""
            chkKaidt_From = True
            Exit Function
        End If

        'ì˙ïtå`éÆÇÃÉ`ÉFÉbÉN
        If IsDate(.Text) = False Then
            Call showMsg("2", "DATE", 0)                'Åúì˙ïtåÎÇËÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'í˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕÉGÉâÅ[
        date1 = Format(CNV_DATE(Left(DB_SYSTBA.SMAUPDDT, 6) & "01"), "YYYY/MM/DD")
        date2 = DateAdd("m", 2, date1)
        date3 = DateAdd("d", -1, date2)
        If DeCNV_DATE(.Text) > DeCNV_DATE(date3) Then
            Call showMsg("1", "URKET73_038", 0)     'Åúí˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒ
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'ì¸ã‡è¡çûâÊñ Ç≈éÛíçì˙(îÑè„ì˙)ÅÑì¸ã‡è¡çûì˙ÇÕÉGÉâÅ[
        If IsDate(.Text) And IsDate(txt_kesidt.Text) Then
            If Format(.Text, "0000/00/00") > Format(txt_kesidt.Text, "0000/00/00") Then
                Call showMsg("2", "DATE", 0)            'Åúì˙ïtåÎÇËÇÃMSG
                .ForeColor = vbRed
                GoTo END_STEP
            End If
        End If

        .ForeColor = vbBlack
    End With

    chkKaidt_From = True

END_STEP:

    gstrKaidt_Fr = DeCNV_DATE(txt_kaidt_From.Text)
    intChkKb = 2            'ÅúäÓñ{ÇÕïœçXéûÇ…É`ÉFÉbÉN
End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkKaidt_To
'   äTóvÅF  âÒé˚ó\íËì˙ïtÅièIóπÅjÇÃÉ`ÉFÉbÉN
'   à¯êîÅF  pin_blnChk : True=ã≠êßìIÇ…É`ÉFÉbÉNÇÇ∑Ç◊ÇƒëñÇÁÇπÇÈ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkKaidt_To(Optional ByVal pin_blnChk As Boolean = False) As Boolean
    Dim date1 As String
    Dim date2 As String
    Dim date3 As String

    chkKaidt_To = False

    With txt_kaidt_To
        If pin_blnChk = False Then
            'É`ÉFÉbÉNãÊï™Ç™1ÇÃÇ∆Ç´ÅAÇ†ÇÈÇ¢ÇÕïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉ`ÉFÉbÉNÇçsÇ§
            If intChkKb <> 1 Then
                chkKaidt_To = True
                GoTo END_STEP
            End If
            If .Text = CNV_DATE(gstrKaidt_To) Then
                chkKaidt_To = True
                GoTo END_STEP
            End If
        End If

        'ãÛîíì¸óÕéûÇÕÉ`ÉFÉbÉNÇµÇ»Ç¢ÅichkConditionÇ≈É`ÉFÉbÉNÅj
        If Trim(.Text) = "" Then
            chkKaidt_To = True
            Exit Function
        End If

        'ì˙ïtå`éÆÇÃÉ`ÉFÉbÉN
        If IsDate(.Text) = False Then
            Call showMsg("2", "DATE", 0)            'Åúì˙ïtåÎÇËÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'í˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕÉGÉâÅ[
        date1 = Format(CNV_DATE(Left(DB_SYSTBA.SMAUPDDT, 6) & "01"), "YYYY/MM/DD")
        date2 = DateAdd("m", 2, date1)
        date3 = DateAdd("d", -1, date2)
        If DeCNV_DATE(.Text) > DeCNV_DATE(date3) Then
            Call showMsg("1", "URKET73_038", 0)     'Åúí˜ÇﬂÇå◊Ç¢Ç≈ÇÃì˙ïtÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒ
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'ì¸ã‡è¡çûâÊñ Ç≈éÛíçì˙(îÑè„ì˙)ÅÑì¸ã‡è¡çûì˙ÇÕÉGÉâÅ[
        If IsDate(.Text) And IsDate(txt_kesidt.Text) Then
            If Format(.Text, "0000/00/00") > Format(txt_kesidt.Text, "0000/00/00") Then
                Call showMsg("2", "DATE", 0)            'Åúì˙ïtåÎÇËÇÃMSG
                .ForeColor = vbRed
                GoTo END_STEP
            End If
        End If

        'ì˙ïtÇÃëÂè¨î‰är
        If IsDate(txt_kaidt_From.Text) And IsDate(.Text) Then
            If Format(txt_kaidt_From.Text, "0000/00/00") > Format(.Text, "0000/00/00") Then
                Call showMsg("2", "DATE", 0)     'Åúì˙ïtåÎÇËÇÃMSG
                .ForeColor = vbRed
                txt_kaidt_From.ForeColor = vbRed
                GoTo END_STEP
            Else
                'É`ÉFÉbÉNÉGÉâÅ[Ç»Çµ
                txt_kaidt_From.ForeColor = vbBlack
            End If
        End If

        .ForeColor = vbBlack
    End With

    chkKaidt_To = True

END_STEP:

    gstrKaidt_To = DeCNV_DATE(txt_kaidt_To.Text)
    intChkKb = 2            'ÅúäÓñ{ÇÕïœçXéûÇ…É`ÉFÉbÉN
End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function chkFridt
'   äTóvÅF  êUçûä˙ì˙ÇÃÉ`ÉFÉbÉN
'   à¯êîÅF  pin_blnChk : True=ã≠êßìIÇ…É`ÉFÉbÉNÇÇ∑Ç◊ÇƒëñÇÁÇπÇÈ
'   ñﬂílÅFÅ@True:ê≥èÌ  False:àŸèÌ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkFridt(Optional ByVal pin_blnChk As Boolean = False) As Boolean
    chkFridt = False

    With txt_fridt
        If pin_blnChk = False Then
            'É`ÉFÉbÉNãÊï™Ç™1ÇÃÇ∆Ç´ÅAÇ†ÇÈÇ¢ÇÕïœçXÇ≥ÇÍÇƒÇ¢ÇΩÇÁÉ`ÉFÉbÉNÇçsÇ§
            If intChkKb <> 1 Then
                chkFridt = True
                GoTo END_STEP
            End If
            If .Text = CNV_DATE(gstrFridt) Then
                chkFridt = True
                GoTo END_STEP
            End If
        End If

        'ãÛîíì¸óÕéûÇÕÉ`ÉFÉbÉNÇµÇ»Ç¢ÅichkConditionÇ≈É`ÉFÉbÉNÅj
        If Trim(.Text) = "" Then
            chkFridt = True
            Exit Function
        End If

        'ì˙ïtå`éÆÇÃÉ`ÉFÉbÉN
        If IsDate(.Text) = False Then
            Call showMsg("2", "DATE", 0)            'Åúì˙ïtåÎÇËÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        'åoóùí˜ì˙à»ëOÇÃì˙ïtÇÃéûÇÕÉGÉâÅ[
        If DeCNV_DATE(.Text) <= DB_SYSTBA.SMAUPDDT Then
        'If DeCNV_DATE(.Text) <= DB_SYSTBA.MONUPDDT Then 'åééüñ{í˜ì˙ÇÃèåèìPîp
            Call showMsg("1", "URKET73_010", 0)     'Åúåoóùí˜ÇﬂçœÇ›ÇÃMSG
            .ForeColor = vbRed
            GoTo END_STEP
        End If

        .ForeColor = vbBlack
    End With

    chkFridt = True

END_STEP:

    gstrFridt = DeCNV_DATE(txt_fridt.Text)
    intChkKb = 2            'ÅúäÓñ{ÇÕïœçXéûÇ…É`ÉFÉbÉN
End Function
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub Ctl_DTItem_Change
    '   äTóvÅF  ì˙ïtçÄñ⁄ì˙ïtïœä∑
    '   à¯êîÅF  pm_objDt      : ì˙ïtçÄñ⁄µÃﬁºﬁ™∏ƒ
    '   ñﬂílÅFÅ@ñ≥Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub Ctl_DTItem_Change(pm_objDt As Object)
    
    With pm_objDt
        'ÉXÉâÉbÉVÉÖÇ™ë∂ç›ÇµÇƒÇ¢ÇÈÇ∆Ç´ÇÕÅAÉXÉâÉbÉVÉÖÇîÚÇŒÇµÇƒéüÇÃçÄñ⁄Ç÷
        If Mid(.Text, .SelStart + 1, 1) = "/" Then
            .SelStart = .SelStart + 1
        End If
        .SelLength = 1
        
        'ì¸óÕÇ≥ÇÍÇΩílÇ™ÇWåÖÇ…ìûíBÇµÇΩÇÃÇ≈ÉXÉâÉbÉVÉÖï“èWÇ∑ÇÈ
        If Len(Trim(.Text)) = 8 Then
            .Text = Format(.Text, "0000/00/00")
            'ì˙ïtÇÃì˙ÇÃïîï™ÇëIëèÛë‘Ç…Ç∑ÇÈ
            .SelStart = 8
            .SelLength = 1
        End If
    End With

End Sub
    

    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub Ctl_DTItem_GotFocus
    '   äTóvÅF  ì˙ïtçÄñ⁄ÇÃÉJÅ[É\Éãà íuïtÇØ
    '   à¯êîÅF  pm_objDt      : ì˙ïtçÄñ⁄µÃﬁºﬁ™∏ƒ
    '   ñﬂílÅFÅ@ñ≥Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Sub Ctl_DTItem_GotFocus(pm_objDt As Object)
    
    With pm_objDt
        If Trim(.Text) = "" Or pm_objDt.ForeColor = vbRed Then
            'Ç»Ç…Ç‡ì¸Ç¡ÇƒÇ¢Ç»Ç¢Ç‹ÇΩÇÕÉGÉâÅ[ÇÃéûÇ…êÊì™Ç÷à íuÇ√ÇØ
            .SelStart = 0
            .SelLength = 1
        Else
            'Ç»Ç…Ç©ì¸Ç¡ÇƒÇ¢ÇΩÇÁì˙ïtÇÃè\ÇÃà ÇëIëèÛë‘Ç…Ç∑ÇÈ
            .SelStart = 8
            .SelLength = 1
        End If
        'îwåiêFÇâ©êFÇ…Ç∑ÇÈ
        .BackColor = vbYellow
    End With

End Sub


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub Ctl_DTItem_KeyDown
    '   äTóvÅF  êøãÅêÊ∫∞ƒﬁÉLÅ[ì¸óÕêßå‰
    '   à¯êîÅF  pm_KeyCode    : ÉLÅ[ÉRÅ[Éh
    '           pm_Shift      : ÉVÉtÉgâüâ∫èÛë‘
    '           pm_objDt      : êøãÅêÊ∫∞ƒﬁµÃﬁºﬁ™∏ƒ
    '   ñﬂílÅFÅ@0:à⁄ìÆñ≥Çµ 1:éüçÄñ⁄ 2:ëOçÄñ⁄
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_tokseicd_KeyDown( _
                                pm_KeyCode As Integer, _
                                pm_Shift As Integer, _
                                pm_objCD As Object) As Integer

    Ctl_tokseicd_KeyDown = 0
    
    With pm_objCD
    
        Select Case pm_KeyCode
        
            'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫éû
            Case vbKeyF1 To vbKeyF12
                'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã§í èàóù
                Call CF_FuncKey_Execute(pm_KeyCode, pm_Shift)
    
            'âEñÓàÛâüâ∫éû
            Case vbKeyRight
                If .SelStart < 4 Then
                    .SelStart = .SelStart + 1
                    .SelLength = 1
                Else
                    intChkKb = 2                            'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›Åj
                    Ctl_tokseicd_KeyDown = 1
                End If
            
            'Backspace or ç∂ñÓàÛâüâ∫éû
            Case vbKeyBack, vbKeyLeft
                If .SelStart > 0 Then
                    .SelStart = .SelStart - 1
                    .SelLength = 1
                Else
                    'BackspaceÇÃéûÇÕÅAì¸óÕílÇ™ãÛîíÇÃéûÅAëOçÄñ⁄Ç÷à⁄ìÆ
                    If Trim(.Text) <> "" And pm_KeyCode = vbKeyBack Then
                        Exit Function
                    End If
                    intChkKb = 2                            'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›Åj
                    Ctl_tokseicd_KeyDown = 2
                End If
        
                'è„ñÓàÛâüâ∫éû
             Case vbKeyUp
                intChkKb = 2                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›Åj
                Ctl_tokseicd_KeyDown = 2
    
            'â∫ñÓàÛâüâ∫éû
            Case vbKeyDown
                intChkKb = 2                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›Åj
                Ctl_tokseicd_KeyDown = 1
    
            'Enterâüâ∫éû
            Case vbKeyReturn
                intChkKb = 1                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉN
                Ctl_tokseicd_KeyDown = 1
    
            'Deleteâüâ∫éû
            Case vbKeyDelete
                Exit Function
    
            'TABâü
            Case vbKeyF16
                intChkKb = 1                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉN
                Ctl_tokseicd_KeyDown = 1
        
            'SHIFT+TABâü
            Case vbKeyF15
                intChkKb = 2                                'ÅöêøãÅêÊ∫∞ƒﬁÇÃì¸óÕÉ`ÉFÉbÉN
                Ctl_tokseicd_KeyDown = 2
                
            Case Else
                Exit Function
        
        End Select
        
    End With

End Function
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Sub Ctl_DTItem_KeyDown
    '   äTóvÅF  ì˙ïtçÄñ⁄ÉLÅ[ì¸óÕêßå‰
    '   à¯êîÅF  pm_KeyCode    : ÉLÅ[ÉRÅ[Éh
    '           pm_Shift      : ÉVÉtÉgâüâ∫èÛë‘
    '           pm_objDt      : ì˙ïtçÄñ⁄µÃﬁºﬁ™∏ƒ
    '   ñﬂílÅFÅ@0:à⁄ìÆñ≥Çµ 1:éüçÄñ⁄ 2:ëOçÄñ⁄
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function Ctl_DTItem_KeyDown( _
                                pm_KeyCode As Integer, _
                                pm_Shift As Integer, _
                                pm_objDt As Object) As Integer

    Ctl_DTItem_KeyDown = 0
    
    With pm_objDt
    
        Select Case pm_KeyCode
    
            'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫éû
            Case vbKeyF1 To vbKeyF12
                'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã§í èàóù
                Call CF_FuncKey_Execute(pm_KeyCode, pm_Shift)
    
            'âEñÓàÛ or Spaceâüâ∫éû
            Case vbKeyRight, vbKeySpace
                
                If .SelStart < 9 Then
                    .SelStart = .SelStart + 1
                    'ÉXÉâÉbÉVÉÖÇ…ÉJÅ[É\ÉãÇ™Ç´ÇΩÇÁéüÇÃï∂éöÇ…ÉJÅ[É\ÉãÇà⁄ìÆ
                    If .SelStart = 4 And Mid(.Text, .SelStart + 1, 1) = "/" Or .SelStart = 7 And Mid(.Text, .SelStart + 1, 1) = "/" Then
                        .SelStart = .SelStart + 1
                    End If
                'ÉJÅ[É\ÉãÇ™âEí[Ç…óàÇΩÇÁéüÇÃçÄñ⁄Ç÷à⁄ìÆ
                Else
                    intChkKb = 2                        'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›)
                    Ctl_DTItem_KeyDown = 1
                End If
                .SelLength = 1
            
            'Backspace or ç∂ñÓàÛâüâ∫éû
            Case vbKeyBack, vbKeyLeft
            
                If .SelStart > 0 Then
                    .SelStart = .SelStart - 1
                    'ÉXÉâÉbÉVÉÖÇ…ÉJÅ[É\ÉãÇ™Ç´ÇΩÇÁëOÇÃï∂éöÇ…ÉJÅ[É\ÉãÇà⁄ìÆ
                    If .SelStart = 4 And Mid(.Text, .SelStart + 1, 1) = "/" Or .SelStart = 7 And Mid(.Text, .SelStart + 1, 1) = "/" Then
                        .SelStart = .SelStart - 1
                    End If
        
                'ÉJÅ[É\ÉãÇ™ç∂í[Ç…óàÇΩÇÁëOÇÃçÄñ⁄Ç÷à⁄ìÆ
                Else
                    intChkKb = 2                        'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›)
                    Ctl_DTItem_KeyDown = 2
                End If
                .SelLength = 1
            
            'è„ñÓàÛâüâ∫éû
            Case vbKeyUp
                intChkKb = 2                            'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›)
                Ctl_DTItem_KeyDown = 2
            
            'â∫ñÓàÛâüâ∫éû
            Case vbKeyDown
                intChkKb = 2                            'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›)
                Ctl_DTItem_KeyDown = 1

            'Enterâüâ∫éû
            Case vbKeyReturn
                intChkKb = 1                            'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
                Ctl_DTItem_KeyDown = 1
        
            'TABâü
            Case vbKeyF16
                intChkKb = 1                            'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉN
                Ctl_DTItem_KeyDown = 1
    
            'Shift+TABâü
            Case vbKeyF15
                intChkKb = 2                            'Åöì˙ïtÇÃì¸óÕÉ`ÉFÉbÉNÅiïœçXéûÇÃÇ›)
                Ctl_DTItem_KeyDown = 2

            'Shift+DELETEâü
            Case vbKeyDelete And pm_Shift = 1
                Dim str As String
                str = .Text
                If Len(str) > 0 And .SelStart < Len(str) Then
                    str = Mid$(str, 1, .SelStart) & Mid$(str, .SelStart + 2)
                    str = Replace(str, "/", "")
                    .SelStart = 0
                    If Len(str) > 0 Then
                        .SelLength = 1
                    End If
                End If
                .Text = str

        End Select

    End With

End Function


'=======================================================âÒé˚ó\íËì˙(äJén)=======================================================

'âÒé˚ó\íËì˙ÉNÉäÉbÉNéû
Private Sub txt_kaidt_From_Click()
    
    txt_kaidt_From.SelStart = 0
    txt_kaidt_From.SelLength = 1

End Sub

'âÒé˚ó\íËì˙çÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_kaidt_From_Change()
    
    'ì˙ïtïœä∑èàóù
    Call Ctl_DTItem_Change(txt_kaidt_From)

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kaidt_From_GotFocus()
    
    'ÉJÅ[É\Éãà íuïtÇØ
    Call Ctl_DTItem_GotFocus(txt_kaidt_From)
    
    'åüçıèàóùÇé¿çsâ¬î\Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = True

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kaidt_From_KeyDown(KeyCode As Integer, Shift As Integer)
    
    'ÉLÅ[ì¸óÕêßå‰
    Select Case Ctl_DTItem_KeyDown(KeyCode, Shift, txt_kaidt_From)
        Case 0
            'âΩÇ‡ÇµÇ»Ç¢
        Case 1
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKaidt_From = True Then
                'éüçÄñ⁄
                txt_kaidt_To.SetFocus
            End If
        Case 2
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKaidt_From = True Then
                'ëOçÄñ⁄
                txt_tokseicd.SetFocus
            End If
    End Select
    
    KeyCode = 0

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kaidt_From_KeyPress(KeyAscii As Integer)
    
    'êîílÇÃÇ›ì¸óÕâ¬Ç∆Ç∑ÇÈ
    If Not Chr(KeyAscii) Like "[0-9]" Then
        KeyAscii = 0
    End If

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kaidt_From_LostFocus()
    
    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_kaidt_From.BackColor = vbWhite

End Sub

'=======================================================âÒé˚ó\íËì˙(èIóπ)=======================================================

'âÒé˚ó\íËì˙ÉNÉäÉbÉNéû
Private Sub txt_kaidt_To_Click()
    
    txt_kaidt_To.SelStart = 0
    txt_kaidt_To.SelLength = 1

End Sub

'âÒé˚ó\íËì˙çÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_kaidt_To_Change()
    
    'ì˙ïtïœä∑èàóù
    Call Ctl_DTItem_Change(txt_kaidt_To)

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kaidt_To_GotFocus()
    
    'ÉJÅ[É\Éãà íuïtÇØ
    Call Ctl_DTItem_GotFocus(txt_kaidt_To)
    
    'åüçıèàóùÇé¿çsâ¬î\Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = True

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kaidt_To_KeyDown(KeyCode As Integer, Shift As Integer)
    
    'ÉLÅ[ì¸óÕêßå‰
    Select Case Ctl_DTItem_KeyDown(KeyCode, Shift, txt_kaidt_To)
        Case 0
            'âΩÇ‡ÇµÇ»Ç¢
        Case 1
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKaidt_To = True Then
                'éüçÄñ⁄
                txt_kesikb.SetFocus
            End If
        Case 2
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKaidt_To = True Then
                'ëOçÄñ⁄
                txt_kaidt_From.SetFocus
            End If
    End Select
    
    KeyCode = 0

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kaidt_To_KeyPress(KeyAscii As Integer)
    
    'êîílÇÃÇ›ì¸óÕâ¬Ç∆Ç∑ÇÈ
    If Not Chr(KeyAscii) Like "[0-9]" Then
        KeyAscii = 0
    End If

End Sub

'âÒé˚ó\íËì˙çÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kaidt_To_LostFocus()
    
    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_kaidt_To.BackColor = vbWhite

End Sub

'=======================================================è¡çûì˙=======================================================

'è¡çûì˙çÄñ⁄ÉNÉäÉbÉNéû
Private Sub txt_kesidt_Click()
    
    txt_kesidt.SelStart = 0
    txt_kesidt.SelLength = 1

End Sub

'è¡çûì˙çÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_kesidt_Change()
    
    'ì˙ïtïœä∑èàóù
    Call Ctl_DTItem_Change(txt_kesidt)

End Sub

'è¡çûì˙çÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kesidt_GotFocus()
    
    intInputMode = 1
    
    'ÉJÅ[É\Éãà íuïtÇØ
    Call Ctl_DTItem_GotFocus(txt_kesidt)
    
    'åüçıèàóùÇé¿çsâ¬î\Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = True

End Sub

'è¡çûì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kesidt_KeyDown(KeyCode As Integer, Shift As Integer)
    
    intChkKb = 0
    
    'ÉLÅ[ì¸óÕêßå‰
    Select Case Ctl_DTItem_KeyDown(KeyCode, Shift, txt_kesidt)
        Case 0
            'âΩÇ‡ÇµÇ»Ç¢
        Case 1
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKesidt = True Then
                'éüçÄñ⁄
                txt_tokseicd.SetFocus
            End If
        Case 2
            'ì¸óÕÉ`ÉFÉbÉN
            If chkKesidt = True Then
                'ëOçÄñ⁄
                txt_kesidt.SetFocus
            End If
    End Select
    
    KeyCode = 0

End Sub

'è¡çûì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_kesidt_KeyPress(KeyAscii As Integer)
    
    'êîílÇÃÇ›ì¸óÕâ¬Ç∆Ç∑ÇÈ
    If Not Chr(KeyAscii) Like "[0-9]" Then
        KeyAscii = 0
    End If

End Sub

'è¡çûì˙çÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_kesidt_LostFocus()
    
    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_kesidt.BackColor = vbWhite

End Sub

'=======================================================êUçûä˙ì˙=======================================================

'êUçûä˙ì˙çÄñ⁄ÇïœçXÇµÇΩéû
Private Sub txt_fridt_Change()
    
    'Ã◊∏ﬁÇ™ÇΩÇ¡ÇƒÇ¢Ç»Ç¢éûÇÕ≤Õﬁ›ƒÇé¿çsÇ≥ÇπÇ»Ç¢
    If blnUsableEvent = False Then
        Exit Sub
    End If

    'ì˙ïtïœä∑èàóù
    Call Ctl_DTItem_Change(txt_fridt)

    blnUsableEvent = True

End Sub

'êUçûä˙ì˙çÄñ⁄Ç…ÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_fridt_GotFocus()
    
    'ÉJÅ[É\Éãà íuïtÇØ
    Call Ctl_DTItem_GotFocus(txt_fridt)
    
    'åüçıèàóùÇé¿çsâ¬î\Ç∆Ç∑ÇÈ
    mnu_showwnd.Enabled = True

End Sub

'êUçûä˙ì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_fridt_KeyDown(KeyCode As Integer, Shift As Integer)

    'ÉLÅ[ì¸óÕêßå‰
    Select Case Ctl_DTItem_KeyDown(KeyCode, Shift, txt_fridt)
        Case 0
            'âΩÇ‡ÇµÇ»Ç¢
        Case 1
            'ì¸óÕÉ`ÉFÉbÉN
            If chkFridt = True Then
                'éüçÄñ⁄
                spd_body.SetFocus
            End If
        Case 2
            'ì¸óÕÉ`ÉFÉbÉN
            If chkFridt = True Then
                'ëOçÄñ⁄
                txt_kesikb.SetFocus
            End If
    End Select
    
    KeyCode = 0

End Sub

'êUçûä˙ì˙çÄñ⁄Ç≈ÉLÅ[ÇâüÇµÇΩéû
Private Sub txt_fridt_KeyPress(KeyAscii As Integer)
    
    'êîílÇÃÇ›ì¸óÕâ¬Ç∆Ç∑ÇÈ
    If Not Chr(KeyAscii) Like "[0-9]" Then
        KeyAscii = 0
    End If

End Sub

'êUçûä˙ì˙çÄñ⁄Ç©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄Ç¡ÇΩéû
Private Sub txt_fridt_LostFocus()

    'îwåiêFÇîíÇ…ñﬂÇ∑
    txt_fridt.BackColor = vbWhite

End Sub


    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function CF_FuncKey_Execute
    '   äTóvÅF  ÉVÉXÉeÉÄã§í èàóù
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function CF_FuncKey_Execute(ByVal pm_KeyCode As Integer, ByVal pm_Shift As Integer) As Integer

    CF_FuncKey_Execute = 0
   
    Select Case True
        'F1ÉLÅ[âüâ∫
        Case pm_KeyCode = vbKeyF1 And pm_Shift = 0
            SendKeys "%1"
            
        'F2ÉLÅ[âüâ∫
        Case pm_KeyCode = vbKeyF2 And pm_Shift = 0
            SendKeys "%2"
        
        'F3ÉLÅ[âüâ∫
        Case pm_KeyCode = vbKeyF3 And pm_Shift = 0
            SendKeys "%3"
   End Select
   
End Function
    
    
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
    '   ñºèÃÅF  Function CF_System_Process
    '   äTóvÅF  ÉVÉXÉeÉÄã§í èàóù
    '   à¯êîÅFÅ@Ç»Çµ
    '   ñﬂílÅFÅ@Ç»Çµ
    '   îıçlÅF
    ' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function CF_System_Process(pm_Form As Form) As Integer
    

   'ÉpÉbÉPÅ[ÉWì‡ÇÃÇcÇkÇkÇ…Çƒ
   '¢ÇsÇ`Ça£Åï¢ÇsÇ`ÇaÅ{ÇrÇgÇhÇeÇs£ÇÇªÇÍÇºÇÍ¢ÇeÇPÇU£Åï¢ÇeÇPÇT£Ç…äÑìñ
   ReleaseTabCapture 0
   SetTabCapture pm_Form.hwnd

End Function


' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF Sub chkFurikomiDT
'   äTóvÅF TOKMTA.SHAKBÅiéxï•èåèÅjÇ…éËå`Ç™ì¸Ç¡ÇƒÇ¢ÇÈèÍçáÇÕêUçûä˙ì˙Ç™ïKê{
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function chkFurikomiDT() As Boolean

    Dim idxRow          As Long
    Dim tmp             As Variant
    Dim intchk          As Integer
    Dim strHYFRIDT      As String
    
    chkFurikomiDT = False
    
    If blnFriEnabled = False Then
        chkFurikomiDT = True
        Exit Function
    End If
    
    'ï‘ïiÇåüçı
    With spd_body
        For idxRow = 1 To intMaxRow
            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©ÇämîF
            .GetText COL_CHK, idxRow, tmp
            intchk = SSSVal(tmp)
            
            'É`ÉFÉbÉNÇ™ì¸Ç¡ÇƒÇ¢ÇÈèÍçá
            If intchk = 1 Then
                'îÑè„ì˙ÇÃéÊìæ
                Call .GetText(COL_HYFRIDT, idxRow, tmp)
                strHYFRIDT = CStr(tmp)
                
                If Trim(strHYFRIDT) = "" Then
                    Call showMsg("0", "_COMPLETEC", 0)     'Åúì¸óÕÇ≥ÇÍÇƒÇ¢Ç»Ç¢çÄñ⁄Ç™Ç†ÇËÇ‹Ç∑ÅBì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB
                    Exit Function
                End If
            End If
       Next idxRow
    End With

    chkFurikomiDT = True

End Function

' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF Function chk_HENPIN
'   äTóvÅF ñ¢óàÇ…ï‘ïiÇ™î≠ê∂ÇµÇƒÇ¢ÇÈÇ©É`ÉFÉbÉNÇ∑ÇÈ
'   à¯êîÅF strJdnNo   : éÛíçì`ï[î‘çÜ
'   Å@Å@ÅF strJdnlinNo: éÛíçì`ï[çsî‘çÜ
'       :  strUrikn   : îÑè„ã‡äz
'   ñﬂílÅF É`ÉFÉbÉNåãâ 
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Function chkHenpin2(ByVal strJdnno As String, ByVal strJdnlinno As String, ByVal strUDNDT As String) As Boolean

    Dim Usr_Ody         As U_Ody
    Dim strSql          As String
    
    On Error GoTo ERR_chkHENPIN2

    '//ï\é¶ÇµÇ‹Ç∑
    chkHenpin2 = True
    
    If Trim$(gstrKaidt_Fr) = "" Then
        '//ï\é¶ÇµÇ‹Ç∑
        GoTo END_chkHENPIN2
    End If
    
    '//ñ¢óàÇ…ï‘ïiÉfÅ[É^Ç™ë∂ç›ÇµÇƒÇ¢ÇÈÇ©ämîFÇ∑ÇÈ
    strSql = " "
    strSql = " SELECT *"
    strSql = strSql & " FROM    UDNTRA"
    strSql = strSql & " WHERE   JDNNO    =  '" & strJdnno & "'"
    strSql = strSql & " AND     JDNLINNO =  '" & strJdnlinno & "'"
    strSql = strSql & " AND     DATKB =  '1'"
    strSql = strSql & " AND     AKAKROKB =  '9'"
    strSql = strSql & " AND     DKBID    =  '02'"
    strSql = strSql & " AND     UDNDT    >= '" & gstrKaidt_Fr & "'"
    strSql = strSql & " AND     UDNDT    <= '" & gstrKaidt_To & "'"

    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

    'ÉfÅ[É^Ç™ë∂ç›ÇµÇΩèÍçá
    If CF_Ora_EOF(Usr_Ody) = False Then
        
        Select Case txt_kesikb.Text
            Case 1
                'è¡çûÇ≥ÇÍÇƒÇ¢Ç»Ç¢èÍçáÅAèàóùÇçsÇ§
                If Trim$(CF_Ora_GetDyn(Usr_Ody, "KESIKB", "")) = "9" Then
                    '//ï\é¶ÇµÇ‹Ç∑
                    GoTo END_chkHENPIN2
                Else
                    '//ï\é¶ÇµÇ‹ÇπÇÒ
                    chkHenpin2 = False
                    GoTo END_chkHENPIN2
                End If
            Case 9
                'è¡çûÇ≥ÇÍÇƒÇ¢Ç»Ç¢èÍçáÅAèàóùÇçsÇ§
                If Trim$(CF_Ora_GetDyn(Usr_Ody, "KESIKB", "")) = "1" Then
                    '//ï\é¶ÇµÇ‹Ç∑
                    GoTo END_chkHENPIN2
                Else
                    '//ï\é¶ÇµÇ‹ÇπÇÒ
                    chkHenpin2 = False
                    GoTo END_chkHENPIN2
                End If
        End Select
        
        '//ï\é¶ÇµÇ‹Ç∑
        GoTo END_chkHENPIN2
    
    End If
    
    'ÉfÅ[É^Ç™ë∂ç›ÇµÇ»Ç©Ç¡ÇΩèÍçá
    If Trim$(strUDNDT) < Trim$(gstrKaidt_Fr) Then
        '//ï\é¶ÇµÇ‹ÇπÇÒ
        chkHenpin2 = False
        GoTo END_chkHENPIN2
    End If
    
END_chkHENPIN2:
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody)

    Exit Function

ERR_chkHENPIN2:
    GoTo END_chkHENPIN2

End Function


'êUçûä˙ì˙ÇÃì¸óÕâ¬î\îªíf
Private Sub getInputHYFRIDT(ByVal pin_strTOKCD As String _
                          , ByVal pin_strSMADT As String _
                          , ByVal pin_strSHAKB As String)
    
    Dim strSql      As Variant
    Dim Usr_Ody     As U_Ody
    
    Dim curNYUKIN1  As Integer
    Dim curNYUKIN2  As Integer

    'è¡çûì˙åéìxÇÃè¡çûèÛë‘ÇéÊìæ
    strSql = ""
    strSql = strSql & " SELECT * "
    strSql = strSql & "   FROM NKSSMB "
    strSql = strSql & "  WHERE TOKCD = '" & CF_Ora_Sgl(pin_strTOKCD) & "' "
    strSql = strSql & "    AND SMADT = '" & CF_Ora_Sgl(DeCNV_DATE(pin_strSMADT)) & "' "

    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

    'êUçûä˙ì˙Çì¸óÕÇ≈Ç´ÇÈÇ©Ç«Ç§Ç©ÇÃÉtÉâÉOÇê›íËÇ∑ÇÈ
    blnFriEnabled = False
    
    If CF_Ora_EOF(Usr_Ody) = False Then
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKZANKN02", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "SSANYUKN02", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKNYKKN02", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKZANKN07", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "SSANYUKN07", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
        If SSSVal(CF_Ora_GetDyn(Usr_Ody, "KSKNYKKN07", "")) <> 0 Then
            blnFriEnabled = True
            GoTo END_getInputHYFRIDT
        End If
    End If

    Call CF_Ora_CloseDyn(Usr_Ody)

    
END_getInputHYFRIDT:
    
    Call CF_Ora_CloseDyn(Usr_Ody)

End Sub

'îÑè„ÉgÉâÉìÅEì¸ã‡ÉåÉRÅ[Éh(DENKB=8)ÇÃîrëºópÉfÅ[É^éÊìæ
Private Sub getUdntraNyukn(ByVal strJdnno As String, ByVal strJdnlinno As String)


    Dim Usr_Ody         As U_Ody
    Dim strSql          As String
    
    Dim intCnt          As Integer
    
    Dim strJdntrkb      As String
    Dim strOkrjono      As String 'ëóÇËèÛáÇ
    
'*** 2009/08/26 ADD START FKS)NAKATA v1.02
    Dim i               As Integer
    Dim BlnFlg          As Boolean '2ìxì«Ç›ópÉtÉâÉO
'*** 2009/08/26 ADD E.N.D FKS)NAKATA v1.02

    
    On Error GoTo ERR_UdntraNyukn
            
            
            'ìÒìxì«Ç›ópÉtÉâÉOèâä˙âª
            BlnFlg = False
            
            
            ''éÛíçî‘çÜÇÊÇËëóÇËèÛáÇÇéÊìæÇ∑ÇÈÅB
            strOkrjono = getOKRJONO(strJdnno, strJdnlinno)


            'îÑè„ÉgÉâÉìÇÃç≈êVÇÃì¸ã‡ÉåÉRÅ[ÉhÇéÊìæ
            strSql = " "
            strSql = strSql & " SELECT   DATNO"
            strSql = strSql & "         ,LINNO"
            strSql = strSql & "         ,UDNNO"
            strSql = strSql & "         ,OKRJONO"
            strSql = strSql & "         ,NYUKN"
            strSql = strSql & "         ,DKBID"
            strSql = strSql & "         ,UPDID"
            strSql = strSql & "         ,OPEID"
            strSql = strSql & "         ,OPEID"
            strSql = strSql & "         ,CLTID"
            strSql = strSql & "         ,WRTDT"
            strSql = strSql & "         ,WRTTM"
            strSql = strSql & "         ,UOPEID"
            strSql = strSql & "         ,UCLTID"
            strSql = strSql & "         ,UWRTDT"
            strSql = strSql & "         ,UWRTTM"
            strSql = strSql & " FROM UDNTRA"
            strSql = strSql & "  WHERE (DATNO , UDNNO , UPDID) IN"
            strSql = strSql & " (   SELECT  MAX(DATNO)"
            strSql = strSql & "             ,UDNNO"
            strSql = strSql & "             ,UPDID"
            strSql = strSql & "      FROM   UDNTRA"
            strSql = strSql & "      WHERE  DATKB = '1'"
            strSql = strSql & "       AND   DENKB = '8'"
            strSql = strSql & "       AND   OKRJONO = '" & strOkrjono & "'"
            strSql = strSql & "      GROUP BY UDNNO, UPDID"
            strSql = strSql & " )"
            strSql = strSql & "   AND   DATKB   =   '1'"
            strSql = strSql & "   AND   AKAKROKB =   '1'"
            strSql = strSql & "   AND   DENKB = '8'"
            strSql = strSql & "   AND   OKRJONO = '" & strOkrjono & "'"
    
    
            '√ﬁ∞¿éÊìæ
            Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
    
            Do While CF_Ora_EOF(Usr_Ody) = False
                
                ReDim Preserve ARY_UDNTRA_NYU_HAITA(ARY_UDNTRA_NYU_CNT)
                
                    With ARY_UDNTRA_NYU_HAITA(ARY_UDNTRA_NYU_CNT)
                    
                        .DATNO = CStr(CF_Ora_GetDyn(Usr_Ody, "DATNO", ""))
                        .LINNO = CStr(CF_Ora_GetDyn(Usr_Ody, "LINNO", ""))
                        .UDNNO = CStr(CF_Ora_GetDyn(Usr_Ody, "UDNNO", ""))
                        .OKRJONO = CStr(CF_Ora_GetDyn(Usr_Ody, "OKRJONO", ""))
                        .OPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "OPEID", ""))
                        .CLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "CLTID", ""))
                        .WRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTDT", ""))
                        .WRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "WRTTM", ""))
                        .UOPEID = CStr(CF_Ora_GetDyn(Usr_Ody, "UOPEID", ""))
                        .UCLTID = CStr(CF_Ora_GetDyn(Usr_Ody, "UCLTID", ""))
                        .UWRTDT = CStr(CF_Ora_GetDyn(Usr_Ody, "UWRTDT", ""))
                        .UWRTTM = CStr(CF_Ora_GetDyn(Usr_Ody, "UWRTTM", ""))

                    End With

                ARY_UDNTRA_NYU_CNT = ARY_UDNTRA_NYU_CNT + 1

                Usr_Ody.Obj_Ody.MoveNext

            Loop
            Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
            
            
            
            For i = 0 To UBound(ARY_NYUKN_KS)
                'ìÒìxì«Ç›âÒîïœêîÇ∆ëóÇËèÛáÇÇ™ìØÇ∂èÍçáÇÕÅAÉfÅ[É^ÇÃéÊìæÇçsÇÌÇ»Ç¢ÅB
                If strOkrjono = ARY_NYUKN_KS(i).OKRJONO Then
                        BlnFlg = True
                        Exit For
                End If
            Next i

            If BlnFlg = False Then
        

                'ì¸ã‡è¡çûÉgÉâÉìÅEîÑè„ÉgÉâÉìÅDì¸ã‡ÉåÉRÅ[ÉhÇÊÇËÅAì¸ã‡äzÇÃécäzÇéÊìæÇ∑ÇÈÅB
                
                strSql = " " & vbCrLf
                strSql = strSql & " SELECT UDN.SEQ  AS SEQ" & vbCrLf
                strSql = strSql & "      , UDN.NYUKN - NVL(NKS.JKESIKN,0) AS ZANKN" & vbCrLf
                strSql = strSql & "      , UDN.DKBID AS DKBID" & vbCrLf
                strSql = strSql & "      , UDN.UPDID AS UPDID" & vbCrLf
                strSql = strSql & "      , UDN.NYUKB AS NYUKB" & vbCrLf
            '*** 2009/10/09 ADD START FKS)NAKATA
                strSql = strSql & "      , UDN.UDNDT AS UDNDT" & vbCrLf
            '*** 2009/10/09 ADD E.N.D FKS)NAKATA
                strSql = strSql & " FROM" & vbCrLf
                strSql = strSql & "    (" & vbCrLf
                strSql = strSql & "         SELECT  SUM(JKESIKN) AS JKESIKN" & vbCrLf
                strSql = strSql & "             ,   DKBID AS DKBID" & vbCrLf
                strSql = strSql & "             ,   UPDID AS UPDID" & vbCrLf
                strSql = strSql & "           FROM   NKSTRA" & vbCrLf
                strSql = strSql & "          WHERE   DATKB     = '1'" & vbCrLf
                strSql = strSql & "            AND   AKAKROKB  = '1'" & vbCrLf
                strSql = strSql & "            AND   JDNNO     = '" & Trim$(strJdnno) & "'" & vbCrLf
                strSql = strSql & "            AND   JDNLINNO  = '" & Trim$(strJdnlinno) & "'" & vbCrLf
                strSql = strSql & "            AND KDNNO NOT IN" & vbCrLf
                strSql = strSql & "                (" & vbCrLf
                strSql = strSql & "                 SELECT  MOTKDNNO" & vbCrLf
                strSql = strSql & "                   FROM  NKSTRA" & vbCrLf
                strSql = strSql & "                  WHERE  JDNNO     = '" & Trim$(strJdnno) & "'" & vbCrLf
                strSql = strSql & "                    AND  JDNLINNO  = '" & Trim$(strJdnlinno) & "'" & vbCrLf
                strSql = strSql & "                    AND  TRIM(MOTKDNNO) IS NOT NULL" & vbCrLf
                strSql = strSql & "                 )" & vbCrLf
                strSql = strSql & "         GROUP BY DKBID , UPDID" & vbCrLf
                strSql = strSql & "    ) NKS" & vbCrLf
                strSql = strSql & "    ," & vbCrLf
                strSql = strSql & "    (" & vbCrLf
                strSql = strSql & "          SELECT  SUM(NYUKN) AS NYUKN" & vbCrLf
                strSql = strSql & "          ,   CASE    WHEN   DKBID = '01' THEN  '4'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '02' THEN  '5'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '03' THEN  '6'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '04' THEN  '1'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '05' THEN  '8'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '06' THEN  '3'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '07' THEN  '9'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '08' THEN  '7'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '09' THEN  '-1'" & vbCrLf
                strSql = strSql & "                      WHEN   DKBID = '99' THEN  '2'" & vbCrLf
                strSql = strSql & "              END AS SEQ" & vbCrLf
                strSql = strSql & "          ,   DKBID" & vbCrLf
                strSql = strSql & "          ,   UPDID" & vbCrLf
                strSql = strSql & "          ,   MAX(TEGDT) AS TEGDT" & vbCrLf
                strSql = strSql & "          ,   NYUKB" & vbCrLf
              '*** 2009/10/09 ADD START FKS)NAKATA
                strSql = strSql & "          ,   MAX(TRA.UDNDT) AS UDNDT" & vbCrLf
              '*** 2009/10/09 ADD E.N.D FKS)NAKATA
                strSql = strSql & "        FROM  UDNTRA TRA" & vbCrLf
                strSql = strSql & "             ,UDNTHA THA" & vbCrLf
                strSql = strSql & "       WHERE  TRA.DENKB    =   '8'" & vbCrLf
                strSql = strSql & "         AND  TRA.DATKB    =   '1'" & vbCrLf
                strSql = strSql & "         AND  TRA.AKAKROKB =   '1'" & vbCrLf
                strSql = strSql & "         AND  TRA.KESIKB   =   '9'" & vbCrLf
                strSql = strSql & "         AND  TRA.DKBID   !=  '09'" & vbCrLf
                strSql = strSql & "         AND  TRA.OKRJONO  =   '" & strOkrjono & "'" & vbCrLf
                strSql = strSql & "         AND  TRA.DATNO    =   THA.DATNO" & vbCrLf
                strSql = strSql & "         AND  THA.NYUCD    = '2'" & vbCrLf
                strSql = strSql & "         AND  THA.FRNKB    = '0'" & vbCrLf
                strSql = strSql & "         AND  TRA.DATNO IN" & vbCrLf
                strSql = strSql & "            ( SELECT MAX(DATNO)" & vbCrLf
                strSql = strSql & "                FROM  UDNTRA" & vbCrLf
                strSql = strSql & "               WHERE  DENKB    =  '8'" & vbCrLf
                strSql = strSql & "                 AND  DATKB    =  '1'" & vbCrLf
                strSql = strSql & "                 AND  DKBID   !=  '09'" & vbCrLf
                strSql = strSql & "                 AND  OKRJONO  =  '" & strOkrjono & "'" & vbCrLf
                strSql = strSql & "            )" & vbCrLf
                strSql = strSql & "       GROUP BY DKBID ,UPDID ,TEGDT ,NYUKB" & vbCrLf
                strSql = strSql & "       ORDER BY SEQ" & vbCrLf
                strSql = strSql & "    )UDN" & vbCrLf
                strSql = strSql & " WHERE  NKS.UPDID(+) = UDN.UPDID" & vbCrLf
                strSql = strSql & "   AND    NKS.DKBID(+) = UDN.DKBID" & vbCrLf
                strSql = strSql & " ORDER BY UDN.SEQ"


                '√ﬁ∞¿éÊìæ
                Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)
        
                Do While CF_Ora_EOF(Usr_Ody) = False
                    
                    
                    ReDim Preserve ARY_NYUKN_KS(ARY_NYUKN_KS_CNT)
                    
                        With ARY_NYUKN_KS(ARY_NYUKN_KS_CNT)
                        
                            .SEQ = SSSVal(CF_Ora_GetDyn(Usr_Ody, "SEQ", ""))
                            .ZANKN = SSSVal(CF_Ora_GetDyn(Usr_Ody, "ZANKN", ""))
                            .DKBID = Format(CStr(CF_Ora_GetDyn(Usr_Ody, "DKBID", "")), "00")
                            .UPDID = Format(CStr(CF_Ora_GetDyn(Usr_Ody, "UPDID", "")), "00")
                        '**** 2009/09/16 ADD START FKS)NAKATA
                        'ì¸ã‡ãÊï™
                            .NYUKB = CF_Ora_GetDyn(Usr_Ody, "NYUKB", "")
                        '**** 2009/09/16 ADD E.N.D FKS)NAKATA
                        '**** 2009/10/09 ADD START FKS)NAKATA
                        'îÑè„ì˙(ì¸ã‡ì˙)
                            .UDNDT = CF_Ora_GetDyn(Usr_Ody, "UDNDT", "")
                        '**** 2009/10/09 ADD E.N.D FKS)NAKATA
                            .OKRJONO = strOkrjono
                            
                        End With

                    ARY_NYUKN_KS_CNT = ARY_NYUKN_KS_CNT + 1
    
                    Usr_Ody.Obj_Ody.MoveNext
    
                Loop
                Call CF_Ora_CloseDyn(Usr_Ody)   '√ﬁ∞¿æØƒ∏€∞Ωﬁ
                        
            End If
            

END_UdntraNyukn:
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody)

    Exit Sub

ERR_UdntraNyukn:
    Call SSSWIN_LOGWRT("getUdntraNyukn_ERROR")
    GoTo END_UdntraNyukn

End Sub

'2009/09/07 ADD START FKS)NAKATA
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
'   ñºèÃÅF  Function F_Util_GET_TANMTA_TANCLAKB
'   äTóvÅF  âcã∆íSìñÉtÉâÉOÇéÊìæ
'   à¯êîÅFÅ@pot_strTANCD       : íSìñé“ÉRÅ[Éh
'       ÅFÅ@pot_strKEIBMNCD    : âcã∆íSìñÉtÉâÉO
'   ñﬂílÅFÅ@0:ê≥èÌèIóπ 9:àŸèÌèIóπ
'   îıçlÅF
' ======+=======+=======+=======+=======+=======+=======+=======+=======+=======+
Private Function F_Util_GET_TANMTA_TANCLAKB(ByRef pot_strTANCD As String, _
                                           ByRef pot_strTANCLAKB As String) As Integer

    Dim Usr_Ody         As U_Ody
    Dim strSql          As String

On Error GoTo ERR_F_Util_GET_TANMTA_TANCLAKB
    
    F_Util_GET_TANMTA_TANCLAKB = 9
    
    pot_strTANCLAKB = ""
    
    'íSìñé“Çl
    strSql = ""
    strSql = strSql & " SELECT TANCLAKB "
    strSql = strSql & " FROM TANMTA "
    strSql = strSql & " WHERE TANCD = '" & pot_strTANCD & "' "

    'DBÉAÉNÉZÉX
    Call CF_Ora_CreateDyn(gv_Odb_USR1, Usr_Ody, strSql)

    If CF_Ora_EOF(Usr_Ody) = False Then
        pot_strTANCLAKB = CF_Ora_GetDyn(Usr_Ody, "TANCLAKB", "")
    Else
        GoTo END_F_Util_GET_TANMTA_TANCLAKB:
    End If

    F_Util_GET_TANMTA_TANCLAKB = 0
    
END_F_Util_GET_TANMTA_TANCLAKB:
    'ÉNÉçÅ[ÉY
    Call CF_Ora_CloseDyn(Usr_Ody)

    Exit Function

ERR_F_Util_GET_TANMTA_TANCLAKB:
    GoTo END_F_Util_GET_TANMTA_TANCLAKB
    
End Function
'2009/09/07 ADD E.N.D FKS)NAKATA
